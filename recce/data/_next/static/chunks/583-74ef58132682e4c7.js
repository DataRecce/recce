(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[583],{6935:(e,n,t)=>{"use strict";t.d(n,{h:()=>s});var l=t(75842),r=t(7206),i=t(77721);async function a(){return(await i.g.get("/api/instance-info")).data}let s=()=>(0,l.I)({queryKey:r.X.instanceInfo(),queryFn:a})},7206:(e,n,t)=>{"use strict";t.d(n,{X:()=>l});let l={rowCount:e=>["row_count",e],lineage:()=>["lineage"],checks:()=>["checks","list"],check:e=>["checks",e],runs:()=>["runs"],run:e=>["runs",e],runsAggregated:()=>["runs_aggregated"],flag:()=>["flag"],instanceInfo:()=>["instance_info"]}},12877:(e,n,t)=>{"use strict";t.d(n,{l:()=>o,p:()=>s});var l=t(79367),r=t(5007),i=t(41757);let a=(0,r.createContext)(void 0);function s(e){let{children:n}=e,[t,s]=(0,r.useState)(),[o,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(),h=async()=>{c(!0),u(void 0),s(void 0);try{let e=await (0,i.x)();if("success"!==e.status)return void u(e.message);s(e.share_url)}catch(e){u(e.message)}finally{c(!1)}};return(0,l.jsx)(a.Provider,{value:{shareUrl:t,isLoading:o,error:d,handleShareClick:h},children:n})}let o=()=>{let e=(0,r.useContext)(a);if(!e)throw Error("useRecceShareStateContext must be used within a RecceShareStateContextProvider");return e}},13900:(e,n,t)=>{"use strict";function l(e,n){if(e<n){let t=(n-e)/e*100;return"+".concat(t>=.1?t.toFixed(1):" <0.1 ","%")}if(!(e>n))return"0 %";{let t=(e-n)/e*100;return"-".concat(t>=.1?t.toFixed(1):" <0.1 ","%")}}t.d(n,{Q:()=>l})},25035:(e,n,t)=>{"use strict";t.d(n,{X:()=>c,l:()=>d});var l=t(79367),r=t(20695),i=t(53379),a=t(29094),s=t(63845),o=t(58971);let c=(0,r.j)({placement:"bottom-end",pauseOnPageIdle:!0}),d=()=>(0,l.jsx)(i.Z,{children:(0,l.jsx)(a.l$,{toaster:c,insetInline:{mdDown:"4"},children:e=>(0,l.jsxs)(a.mk,{width:{md:"sm"},children:["loading"===e.type?(0,l.jsx)(s.y,{size:"sm",color:"blue.solid"}):(0,l.jsx)(a.Lv,{}),(0,l.jsxs)(o.B,{gap:"1",flex:"1",maxWidth:"100%",children:[e.title&&(0,l.jsx)(a.Sb,{children:e.title}),e.description&&(0,l.jsx)(a.aD,{children:e.description})]}),e.action&&(0,l.jsx)(a.gC,{children:e.action.label}),e.closable&&(0,l.jsx)(a.k1,{})]})})})},26901:(e,n,t)=>{"use strict";t.d(n,{J:()=>s,d:()=>a});var l=t(79367),r=t(5007);let i=(0,r.createContext)({latestSelectedCheckId:"",setLatestSelectedCheckId:()=>{}});function a(e){let{children:n}=e,[t,a]=r.useState("");return(0,l.jsx)(i.Provider,{value:{setLatestSelectedCheckId:a,latestSelectedCheckId:t},children:n})}let s=()=>(0,r.useContext)(i)},28623:(e,n,t)=>{"use strict";t.d(n,{In:()=>o,Ly:()=>c,QS:()=>u,TL:()=>d,XJ:()=>h,iZ:()=>s,o$:()=>f,uH:()=>x,uz:()=>i,vD:()=>m,vM:()=>p,yk:()=>a});var l=t(91637),r=t(33285);function i(){let e=function(e){let n=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return n?n.pop():""}("recce_user_id"),n=r.env.AMPLITUDE_API_KEY;if(e&&n)try{(0,l.Yi)(n,{analytics:{userId:e,autocapture:!0},sr:{sampleRate:1}})}catch(e){console.error(e)}}function a(e){(0,l.u4)("[Web] multi_nodes_action",e)}function s(e){(0,l.u4)("[Web] history_action",e)}function o(e){(0,l.u4)("[Experiment] preview_change",e)}function c(e){(0,l.u4)("[Experiment] preview_change",e)}function d(e){(0,l.u4)("[Experiment] single_environment",e)}function u(e){(0,l.u4)("[Experiment] recommend_preset_check",e)}function h(){return!1}function m(e){(0,l.u4)("Column level lineage",e)}function f(e){(0,l.u4)("share_state",e)}function p(e){(0,l.u4)("state_action",e)}function x(e){(0,l.u4)("[Click] copy_to_clipboard",e)}},31796:(e,n,t)=>{"use strict";t.d(n,{mA:()=>a,y8:()=>i});var l=t(77721);async function r(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await axiosClient.get("/api/lineage?base=".concat(e))).data}async function i(){return(await l.g.get("/api/info")).data}async function a(e){return(await l.g.get("/api/model/".concat(e))).data}},36956:(e,n,t)=>{"use strict";function l(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,l=new Set,r={},i=(e,t)=>{if(!(t<0)&&(null==r[e]||!(r[e]>=t))){for(let l of(r[e]=t,n(e)))i(l,t-1);l.add(e)}};for(let n of e)i(n,t);return l}function r(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let l=new Set;return n.forEach(e=>{e.forEach(e=>{l.add(e)})}),l}t.d(n,{KC:()=>r,zY:()=>l})},40484:(e,n,t)=>{"use strict";t.d(n,{V:()=>i});var l=t(33285);let r=l.env.NEXT_PUBLIC_API_URL;null!=r||(r=window.location.origin);let i=r,a=l.env.NEXT_PUBLIC_CLOUD_WEB_URL;null!=a||(a="https://cloud.datarecce.io")},41757:(e,n,t)=>{"use strict";t.d(n,{$k:()=>c,$w:()=>a,N_:()=>o,Uh:()=>i,Z3:()=>d,sp:()=>s,x:()=>u});var l=t(80028),r=t(77721);async function i(e){return(await r.g.post("/api/save-as",e)).data}async function a(e){return(await r.g.post("/api/rename",e)).data}async function s(){return(await r.g.post("/api/export")).data}async function o(e,n){let t=new FormData;return t.append("file",e),t.append("checks_only",(!!n).toString()),(await r.g.post("/api/import",t)).data}async function c(){return 208===(await r.g.get("/api/sync")).status}async function d(e){try{let n=await r.g.post("/api/sync",e);if(202===n.status)return{status:"accepted"};if(208===n.status)return{status:"syncing"}}catch(e){if((0,l.F0)(e)&&e.response&&409===e.response.status)return{status:"conflict"}}throw Error("Failed to sync state")}async function u(){return(await r.g.post("/api/share")).data}},41946:(e,n,t)=>{"use strict";t.d(n,{m:()=>a});var l=t(79367),r=t(82556),i=t(53379);let a=t(5007).forwardRef(function(e,n){let{showArrow:t,children:a,disabled:s,portalled:o=!0,content:c,contentProps:d,portalRef:u,...h}=e;return s?a:(0,l.jsxs)(r.sb,{...h,children:[(0,l.jsx)(r.k$,{asChild:!0,children:a}),(0,l.jsx)(i.Z,{disabled:!o,container:u,children:(0,l.jsx)(r.ol,{children:(0,l.jsxs)(r.ZI,{ref:n,...d,children:[t&&(0,l.jsx)(r.PR,{children:(0,l.jsx)(r.Mo,{})}),c]})})})]})})},43094:(e,n,t)=>{"use strict";t.d(n,{R:()=>o,c:()=>c});var l=t(79367),r=t(5007),i=t(6935);let a={mode:null,disableSaveToFile:!1,disableExportStateFile:!1,disableImportStateFile:!1,disableUpdateChecklist:!1,disableDatabaseQuery:!1,disableViewActionDropdown:!1,disableNodeActionDropdown:!1,disableShare:!1},s=(0,r.createContext)({singleEnv:!1,authed:!1,lifetimeExpiredAt:void 0,featureToggles:a});function o(e){let{children:n}=e,{data:t,isLoading:o}=(0,i.h)(),[c,d]=(0,r.useState)(a),[u,h]=(0,r.useState)(!1),[m,f]=(0,r.useState)(!1),[p,x]=(0,r.useState)();return(0,r.useEffect)(()=>{!o&&t&&(h(t.single_env),f(t.authed),t.lifetime_expired_at&&(x(new Date(t.lifetime_expired_at)),console.log("lifetime expired at",t.lifetime_expired_at)),"read-only"===t.server_mode?(a.mode="read only",a.disableSaveToFile=!0,a.disableExportStateFile=!0,a.disableImportStateFile=!0,a.disableUpdateChecklist=!0,a.disableDatabaseQuery=!0,a.disableViewActionDropdown=!0,a.disableNodeActionDropdown=!0,a.disableShare=!0):"preview"===t.server_mode&&(a.mode="preview mode",a.disableSaveToFile=!0,a.disableExportStateFile=!0,a.disableImportStateFile=!0,a.disableUpdateChecklist=!1,a.disableDatabaseQuery=!0,a.disableViewActionDropdown=!1,a.disableNodeActionDropdown=!1,a.disableShare=!0),t.single_env&&(a.disableUpdateChecklist=!0,a.disableShare=!0),d(a))},[t,o]),(0,l.jsx)(s.Provider,{value:{featureToggles:c,singleEnv:u,authed:m,lifetimeExpiredAt:p},children:n})}let c=()=>(0,r.useContext)(s)},44957:(e,n,t)=>{"use strict";t.d(n,{kL:()=>O,cE:()=>T,JL:()=>I});var l=t(79367),r=t(94805),i=t(13903),a=t(75842),s=t(5007),o=t(7206),c=t(31796),d=t(95127),u=t(33674),h=t(53379),m=t(5055),f=t(74523),p=t(64144),x=t(40484),g=t(11935),v=t.n(g),y=t(52810),j=t(74562),C=t(48288),b=t(28623),w=t(6935),_=t(28698),k=t.n(_);function S(e){let{connect:n}=e;return(0,l.jsxs)(u.Cf,{children:[(0,l.jsx)(u.c7,{children:(0,l.jsx)(u.L3,{children:"Server Disconnected"})}),(0,l.jsx)(u.R4,{children:(0,l.jsx)(m.E,{children:"The server connection has been lost. Please restart the Recce server and try again."})}),(0,l.jsx)(u.Es,{children:(0,l.jsx)(f.$,{colorPalette:"cyan",onClick:()=>{n()},children:"Retry"})}),(0,l.jsx)(u.tK,{asChild:!0,children:(0,l.jsx)(p.J,{size:"sm"})})]})}function E(e){let{shareUrl:n}=e;return(0,l.jsxs)(u.Cf,{children:[(0,l.jsx)(u.c7,{children:(0,l.jsx)(u.L3,{children:"Share Instance Expired"})}),(0,l.jsx)(u.R4,{children:(0,l.jsx)(m.E,{children:"This Share Instance has expired. Please restart the share instance."})}),(0,l.jsx)(u.Es,{children:(0,l.jsx)(k(),{href:n,passHref:!0,children:(0,l.jsx)(f.$,{colorPalette:"blue",children:"Restart"})})})]})}var R=t(25035);let M=(0,s.createContext)({isActionAvailable:()=>!0});function O(e){var n,t;let{children:g}=e,_=(0,a.I)({queryKey:o.X.lineage(),queryFn:c.y8}),k=(0,a.I)({queryKey:o.X.runsAggregated(),queryFn:y.a1}),O=(0,s.useMemo)(()=>{var e;let n=null==(e=_.data)?void 0:e.lineage;if((null==n?void 0:n.base)&&n.current)return(0,r.yc)(n.base,n.current,n.diff)},[_.data]),T=null==(n=_.error)?void 0:n.message,{state_metadata:I,lineage:A,sqlmesh:N,demo:L,review_mode:F,cloud_mode:V,file_mode:z,filename:H,adapter_type:P,git:D,pull_request:K,support_tasks:B}=null!=(t=_.data)?t:{},W=null==A?void 0:A.base.manifest_metadata,X=null==A?void 0:A.current.manifest_metadata,{connectionStatus:Z,connect:U,envStatus:Q}=function(){let[e,n]=(0,s.useState)(void 0),t=(0,s.useRef)({ws:void 0,status:"pending"}),[l,r]=(0,s.useState)("pending"),[a,c]=(0,s.useState)(void 0);t.current.status=l;let d=(0,i.jE)(),u=()=>{d.invalidateQueries({queryKey:o.X.lineage()}),d.invalidateQueries({queryKey:o.X.checks()}),d.invalidateQueries({queryKey:o.X.runs()})},h=()=>{let l=new WebSocket("".concat(x.V.replace(/(http)(s)?:\/\//,"ws$2://"),"/api/ws"));t.current.ws=l,l.onopen=()=>{l.send("ping")},l.onmessage=l=>{if("pong"===l.data){"disconnected"===t.current.status&&u(),r("connected");return}try{let t=JSON.parse(l.data);if("refresh"===t.command){let{eventType:l,srcPath:r}=t.event,[i,a]=r.split("/").slice(-2),s=v().parse(a).name,o="".concat(i,"-").concat(s,"-").concat(l);null==e&&n(R.X.create({id:o,description:"Detected ".concat(i," ").concat(s," ").concat(l),type:"info",duration:5e3,closable:!0})),u()}else if("relaunch"===t.command)c("relaunch");else{let{id:e,title:l,description:r,status:i,position:a,duration:s}=t.event;n(R.X.create({id:e||"broadcast",title:l,description:r,type:null!=i?i:"info",duration:null!=s?s:5e3,closable:!0}))}}catch(e){console.error(e)}},l.onerror=e=>{console.error(e)},l.onclose=()=>{r(e=>"connected"===e?"disconnected":e),t.current.ws=void 0}};return(0,s.useEffect)(()=>{let e=t.current;return h(),()=>{e.ws&&e.ws.close()}},[]),{connectionStatus:l,connect:h,envStatus:a}}(),{data:q,isLoading:J}=(0,C.T)(),{data:Y}=(0,w.h)(),{onClose:$}=(0,d.j)(),[G,ee]=(0,s.useState)(!1),en=(0,i.jE)(),et=(0,s.useCallback)(e=>{if(B){var n;return null==(n=B[e])||n}return!0},[B]);(0,s.useEffect)(()=>{J||("relaunch"===Q&&(null==q?void 0:q.single_env_onboarding)&&q.show_relaunch_hint?(ee(!0),(0,b.TL)({action:"target_base_added"})):ee(!1))},[q,Q,J]);let{share_url:el}=null!=Y?Y:{};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(M.Provider,{value:{lineageGraph:O,retchLineageGraph:()=>{k.refetch()},envInfo:{stateMetadata:I,adapterType:P,git:D,pullRequest:K,dbt:{base:W,current:X},sqlmesh:N},reviewMode:F,cloudMode:V,fileMode:z,fileName:H,isDemoSite:L,error:T,supportTasks:B,isActionAvailable:et,isLoading:_.isLoading,runsAggregated:k.data,refetchRunsAggregated:()=>{k.refetch()}},children:g}),(0,l.jsx)(u.Dz,{open:"disconnected"===Z,onOpenChange:()=>{},placement:"center",children:(0,l.jsxs)(h.Z,{children:[(0,l.jsx)(u.Xi,{}),(0,l.jsx)(u.f5,{children:el?(0,l.jsx)(E,{shareUrl:el}):(0,l.jsx)(S,{connect:U})})]})}),(null==q?void 0:q.single_env_onboarding)&&(0,l.jsx)(u.Dz,{open:G,onOpenChange:()=>{$(),(0,j.YH)(),en.invalidateQueries({queryKey:o.X.flag()})},placement:"center",children:(0,l.jsxs)(h.Z,{children:[(0,l.jsx)(u.Xi,{}),(0,l.jsx)(u.f5,{children:(0,l.jsxs)(u.Cf,{children:[(0,l.jsx)(u.c7,{children:(0,l.jsx)(u.L3,{children:"Target-base Added"})}),(0,l.jsx)(u.R4,{children:(0,l.jsx)(m.E,{children:"Please restart the Recce server."})}),(0,l.jsx)(u.Es,{children:(0,l.jsx)(f.$,{colorPalette:"blue",onClick:()=>{$(),(0,j.YH)(),en.invalidateQueries({queryKey:o.X.flag()})},children:"Got it!"})}),(0,l.jsx)(u.tK,{asChild:!0,children:(0,l.jsx)(p.J,{size:"sm"})})]})})]})})]})}let T=()=>(0,s.useContext)(M),I=()=>{let{runsAggregated:e,refetchRunsAggregated:n}=T();return[e,n]}},48288:(e,n,t)=>{"use strict";t.d(n,{T:()=>a});var l=t(75842),r=t(74562),i=t(7206);let a=()=>(0,l.I)({queryKey:i.X.flag(),queryFn:r.oM})},50323:(e,n,t)=>{"use strict";t.d(n,{Ay:()=>c});var l=t(5007),r=t(31796),i=t(44957),a=t(17090),s=t.n(a);function o(e,n){let t=[];return e.forEach(e=>{t.some(n=>n.name===e.name)||t.push(e)}),n.forEach(e=>{t.some(n=>n.name===e.name)||t.push(e)}),t}let c=e=>{var n;let{lineageGraph:t}=(0,i.cE)(),[a,c]=(0,l.useState)([]),[d,u]=(0,l.useState)(),[h,m]=(0,l.useState)(!0),[f,p]=(0,l.useState)(null),x=s().find(null==t?void 0:t.nodes,{name:e}),g=(0,l.useMemo)(()=>x?function(e){function n(e){return(null==e?void 0:e.columns)?Object.values(e.columns):[]}return o(n(e.data.base),n(e.data.current))}(x):[],[x]),v=x?null==(n=x.data.current)?void 0:n.primary_key:void 0,y=(0,l.useCallback)(async()=>{try{let e=(await (0,r.mA)(null==x?void 0:x.id)).model;if(!e.base.columns||!e.current.columns)return void c([]);u(e.current.primary_key);let n=Object.values(e.base.columns),t=Object.values(e.current.columns);c(o(n,t))}catch(e){p(e)}},[null==x?void 0:x.id]);return(0,l.useEffect)(()=>{g.length>0?(c(g),u(v)):(null==x?void 0:x.id)===void 0?c([]):y().catch(e=>{}),m(!1)},[y,null==x?void 0:x.id,g,v]),{columns:a,primaryKey:d,isLoading:h,error:f}}},52810:(e,n,t)=>{"use strict";t.d(n,{AU:()=>i,Su:()=>s,Zc:()=>a,a1:()=>u,gM:()=>o,v:()=>d,xz:()=>c});var l=t(77721),r=t(28623);async function i(e,n,t){let i=(null==t?void 0:t.trackProps)?{...t.trackProps}:{};return(0,r.XJ)()&&(i.breaking_change_analysis=!0),(await l.g.post("/api/runs",{type:e,params:n,nowait:null==t?void 0:t.nowait,track_props:i})).data}async function a(e,n){return(await l.g.get("/api/runs/".concat(e,"/wait"),{params:{timeout:n}})).data}async function s(e){return await l.g.post("/api/runs/".concat(e,"/cancel"))}async function o(e,n){return(await l.g.post("/api/checks/".concat(e,"/run"),{nowait:null==n?void 0:n.nowait})).data}async function c(e,n,t){return(await l.g.post("/api/runs/search",{type:e,params:n,limit:t})).data}async function d(){return(await l.g.get("/api/runs")).data}async function u(){return(await l.g.post("/api/runs/aggregate",{})).data}},56536:(e,n,t)=>{"use strict";t.d(n,{a:()=>o,z:()=>s});var l=t(79367);t(88930);var r=t(47903),i=t(70029),a=t(5055);let s=(0,t(5007).forwardRef)((e,n)=>{let{...t}=e;return(0,l.jsx)(r.zh,{ref:n,className:t.className?t.className+"no-track-pii-safe":"no-track-pii-safe",rowClass:()=>"no-track-pii-safe",...t})});function o(e){let{emptyMessage:n}=e;return(0,l.jsx)(i.s,{h:"35px",alignItems:"center",justifyContent:"center",bg:"gray.100",style:{textAlign:"center",gridColumn:"1/-1"},children:(0,l.jsxs)(a.E,{fontWeight:"600",children:[" ",null!=n?n:"No rows"]})})}},60077:()=>{},67774:(e,n,t)=>{"use strict";t.d(n,{c:()=>u,y:()=>h});var l=t(79367),r=t(781),i=t(97188),a=t(69118),s=t(50323);function o(e){let n=e.trim().toUpperCase();return!!["CHAR","VARCHAR","TINYTEXT","TEXT","MEDIUMTEXT","LONGTEXT","NCHAR","NVARCHAR","VARCHAR2","NVARCHAR2","CLOB","NCLOB","VARCHAR(MAX)","XML","JSON"].includes(n)||/^(VARCHAR|NVARCHAR|VARCHAR2|NVARCHAR2|CHAR|NCHAR)\(\d+\)$/.test(n)}function c(e){return["BOOLEAN","TINYINT(1)","BIT","NUMBER(1)","BOOL"].includes(e.toUpperCase())}function d(e){return["DATE","DATETIME","TIMESTAMP","TIME","YEAR","DATETIME2","SMALLDATETIME","DATETIMEOFFSET","INTERVAL","TIMESTAMPTZ","TIMETZ","TIMESTAMP WITH TIME ZONE","TIMESTAMP WITH LOCAL TIME ZONE","TIMESTAMP_LTZ","TIMESTAMP_NTZ","TIMESTAMP_TZ"].includes(e.toUpperCase())}function u(e){return!o(e)&&!c(e)&&!d(e)}function h(e){let{params:n,onParamsChanged:t,setIsReadyToExecute:u}=e,{columns:h,isLoading:m,error:f}=(0,s.Ay)(n.model),p=h.filter(e=>!o(e.type)&&!c(e.type)&&!d(e.type));return m?(0,l.jsx)(r.a,{children:"Loading..."}):0===h.length||f?(0,l.jsx)(r.a,{children:"Error: Please provide the 'catalog.json' to list column candidates"}):(0,l.jsx)(r.a,{m:"16px",children:(0,l.jsxs)(i.XO,{children:[(0,l.jsx)(i.dh,{children:"Pick a column to show Histogram Diff"}),(0,l.jsxs)(a.MQ,{disabled:0===p.length,children:[(0,l.jsx)(a.uT,{value:n.column_name,onChange:e=>{var l,r;let i=e.target.value;u(!!i);let a=null!=(r=null==(l=p.find(e=>e.name===i))?void 0:l.type)?r:"";t({...n,column_name:i,column_type:a})},placeholder:0!==p.length?"Select column":"No numeric column is available",children:p.map(e=>(0,l.jsxs)("option",{value:e.name,children:[e.name," : ",e.type]},e.name))}),(0,l.jsx)(a.Nv,{})]})]})})}},71407:(e,n,t)=>{"use strict";t.d(n,{FS:()=>s,GI:()=>o,G_:()=>c,Th:()=>a,gY:()=>i,nU:()=>r});var l=t(79367);let r=e=>(0,l.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,l.jsx)("g",{clipPath:"url(#clip0_1479_25070)",children:(0,l.jsx)("path",{d:"M15.625 0.25H14.759C14.5484 0.25 14.3791 0.423375 14.3841 0.633937L14.4575 3.71441C13.0691 1.62634 10.6955 0.25 8 0.25C4.21291 0.25 1.06041 2.96638 0.38425 6.557C0.340875 6.78728 0.518875 7 0.753219 7H1.64622C1.82353 7 1.97566 6.87556 2.013 6.70222C2.60753 3.9415 5.05991 1.875 8 1.875C10.4858 1.875 12.6232 3.35256 13.5836 5.47819L9.63394 5.38416C9.42341 5.37916 9.25 5.54844 9.25 5.75906V6.625C9.25 6.83209 9.41791 7 9.625 7H15.625C15.8321 7 16 6.83209 16 6.625V0.625C16 0.417906 15.8321 0.25 15.625 0.25ZM15.2468 9H14.3538C14.1765 9 14.0243 9.12444 13.987 9.29778C13.3925 12.0585 10.9401 14.125 8 14.125C5.51419 14.125 3.37681 12.6474 2.41637 10.5218L6.36606 10.6158C6.57659 10.6208 6.75 10.4516 6.75 10.2409V9.375C6.75 9.16791 6.58209 9 6.375 9H0.375C0.167906 9 0 9.16791 0 9.375V15.375C0 15.5821 0.167906 15.75 0.375 15.75H1.24097C1.45156 15.75 1.62088 15.5766 1.61588 15.3661L1.54253 12.2856C2.93087 14.3737 5.3045 15.75 8 15.75C11.7871 15.75 14.9396 13.0336 15.6158 9.443C15.6591 9.21272 15.4811 9 15.2468 9Z",fill:"currentColor"})}),(0,l.jsx)("defs",{children:(0,l.jsx)("clipPath",{id:"clip0_1479_25070",children:(0,l.jsx)("rect",{width:"16",height:"16",fill:"white"})})})]}),i=e=>(0,l.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,l.jsx)("g",{clipPath:"url(#clip0_1479_25102)",children:(0,l.jsx)("path",{d:"M-1.88399 8.72062L0.358816 6.46094C0.594752 6.22344 1.00006 6.39031 1.00006 6.725V8.2525H4.00005V4.12438C4.00005 3.7275 4.16161 3.34313 4.44286 3.06219L7.06441 0.440625C7.34566 0.159375 7.72691 0 8.12347 0H14.5003C15.3281 0.003125 16 0.675 16 1.50281V14.5003C16 15.3281 15.3281 16 14.5003 16H5.50223C4.67411 16 4.00005 15.3281 4.00005 14.5003V11.2522H5.50005V14.5003H14.5003V1.50281H9.50128V4.75219C9.50128 5.16781 9.1669 5.50187 8.75128 5.50187H5.50005V8.25219H10.625C10.8322 8.25219 11 8.42 11 8.62719V9.37719C11 9.58438 10.8322 9.75219 10.625 9.75219H1.00006V11.2797C1.00006 11.6144 0.594752 11.7813 0.358816 11.5438L-1.88399 9.28406C-2.03867 9.12813 -2.03867 8.87656 -1.88399 8.72062ZM8.0016 4.00219V1.62469L5.62379 4.00219H8.0016Z",fill:"currentColor"})}),(0,l.jsx)("g",{clipPath:"url(#clip1_1479_25102)",children:(0,l.jsx)("path",{d:"M0.103056 8.72062L2.09667 6.46094C2.30639 6.22344 2.66667 6.39031 2.66667 6.725V8.2525H5.33333V4.12438C5.33333 3.7275 5.47694 3.34313 5.72694 3.06219L8.05722 0.440625C8.30722 0.159375 8.64611 0 8.99861 0H14.6669C15.4028 0.003125 16 0.675 16 1.50281V14.5003C16 15.3281 15.4028 16 14.6669 16H6.66861C5.9325 16 5.33333 15.3281 5.33333 14.5003V11.2522H6.66667V14.5003H14.6669V1.50281H10.2233V4.75219C10.2233 5.16781 9.92611 5.50187 9.55667 5.50187H6.66667V8.25219H11.2222C11.4064 8.25219 11.5556 8.42 11.5556 8.62719V9.37719C11.5556 9.58438 11.4064 9.75219 11.2222 9.75219H2.66667V11.2797C2.66667 11.6144 2.30639 11.7813 2.09667 11.5438L0.103056 9.28406C-0.0344448 9.12813 -0.0344448 8.87656 0.103056 8.72062ZM8.89028 4.00219V1.62469L6.77666 4.00219H8.89028Z",fill:"currentColor"})}),(0,l.jsxs)("defs",{children:[(0,l.jsx)("clipPath",{id:"clip0_1479_25102",children:(0,l.jsx)("rect",{width:"13",height:"16",fill:"white",transform:"matrix(-1 0 0 1 16 0)"})}),(0,l.jsx)("clipPath",{id:"clip1_1479_25102",children:(0,l.jsx)("rect",{width:"3",height:"16",fill:"white"})})]})]}),a=e=>(0,l.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,l.jsx)("g",{clipPath:"url(#clip0_1426_8619)",children:(0,l.jsx)("path",{d:"M15.5572 3.06188L12.9356 0.440625C12.6544 0.159375 12.2731 0 11.8766 0H5.49969C4.67188 0.003125 4 0.675 4 1.50281V8.25219H0.375C0.167812 8.25219 0 8.42 0 8.62719V9.37719C0 9.58438 0.167812 9.75219 0.375 9.75219H9V11.2797C9 11.6144 9.40531 11.7812 9.64125 11.5437L11.8841 9.28406C12.0388 9.12813 12.0388 8.87656 11.8841 8.72062L9.64125 6.46094C9.40531 6.22344 9 6.39031 9 6.725V8.2525H5.49969V1.50281H10.4987V4.75219C10.4987 5.16781 10.8331 5.50187 11.2487 5.50187H14.5V14.5003H5.49969V11.2522H4V14.5003C4 15.3281 4.67188 16 5.49969 16H14.4978C15.3259 16 16 15.3281 16 14.5003V4.12406C16 3.7275 15.8384 3.34313 15.5572 3.06188ZM11.9984 4.00219V1.62469L14.3763 4.00219H11.9984Z",fill:"black"})}),(0,l.jsx)("defs",{children:(0,l.jsx)("clipPath",{id:"clip0_1426_8619",children:(0,l.jsx)("rect",{width:"16",height:"16",fill:"white"})})})]}),s=e=>(0,l.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,l.jsx)("path",{d:"M14.5607 4.06066L11.9393 1.43934C11.658 1.15804 11.2765 1 10.8787 1H2.5C1.67156 1 1 1.67156 1 2.5V13.5C1 14.3284 1.67156 15 2.5 15H13.5C14.3284 15 15 14.3284 15 13.5V5.12131C15 4.72349 14.842 4.34196 14.5607 4.06066ZM9.5 2.5V5H5.5V2.5H9.5ZM13.3125 13.5H2.6875C2.63777 13.5 2.59008 13.4802 2.55492 13.4451C2.51975 13.4099 2.5 13.3622 2.5 13.3125V2.6875C2.5 2.63777 2.51975 2.59008 2.55492 2.55492C2.59008 2.51975 2.63777 2.5 2.6875 2.5H4V5.75C4 6.16422 4.33578 6.5 4.75 6.5H10.25C10.6642 6.5 11 6.16422 11 5.75V2.62131L13.4451 5.06641C13.4625 5.08382 13.4763 5.10449 13.4857 5.12724C13.4952 5.14999 13.5 5.17438 13.5 5.199V13.3125C13.5 13.3622 13.4802 13.4099 13.4451 13.4451C13.4099 13.4802 13.3622 13.5 13.3125 13.5ZM8 7.25C6.48366 7.25 5.25 8.48366 5.25 10C5.25 11.5163 6.48366 12.75 8 12.75C9.51634 12.75 10.75 11.5163 10.75 10C10.75 8.48366 9.51634 7.25 8 7.25ZM8 11.25C7.31075 11.25 6.75 10.6892 6.75 10C6.75 9.31075 7.31075 8.75 8 8.75C8.68925 8.75 9.25 9.31075 9.25 10C9.25 10.6892 8.68925 11.25 8 11.25Z",fill:"currentColor"})}),o=e=>(0,l.jsx)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,l.jsx)("path",{d:"M15.9143 1.75812L14.7422 0.585938C14.3515 0.195312 13.8397 0 13.3278 0C12.8159 0 12.304 0.195312 11.9137 0.585625L9.58593 2.91344L8.5 3.99938L0.901592 11.5975L0.504719 15.1669C0.454719 15.6163 0.80878 16 1.24847 16C1.27628 16 1.3044 15.9984 1.33253 15.9953L4.89939 15.6012L12.5006 8L13.5862 6.91437L15.914 4.58656C16.6953 3.80531 16.6953 2.53906 15.9143 1.75812ZM4.21095 14.1684L2.09909 14.4016L2.3344 12.2863L9.56062 5.06L10.53 4.09062L12.4094 5.97L11.44 6.93937L4.21095 14.1684ZM14.8534 3.52562L13.4697 4.90938L11.5906 3.03L12.9744 1.64625C13.1019 1.51875 13.2506 1.49969 13.3278 1.49969C13.405 1.49969 13.554 1.51875 13.6812 1.64625L14.8534 2.81844C15.0484 3.01375 15.0484 3.33094 14.8534 3.52562Z",fill:"currentColor"})}),c=e=>(0,l.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,l.jsx)("path",{d:"M7.26326 6.5462H8.71794V12.3642H7.26326V6.5462ZM7.9906 3.1102C7.43278 3.1102 6.97888 3.5641 6.97888 4.12192C6.97888 4.67974 7.43278 5.13364 7.9906 5.13364C8.54842 5.13364 9.00232 4.67974 9.00232 4.12192C9.00232 3.5641 8.54842 3.1102 7.9906 3.1102ZM16 8C16 12.411 12.411 16 8 16C3.589 16 0 12.411 0 8C0 3.589 3.589 0 8 0C12.411 0 16 3.589 16 8ZM14.5453 8C14.5453 4.3906 11.6093 1.4546 7.99992 1.4546C4.39052 1.4546 1.45452 4.3914 1.45452 8.0006C1.45452 11.6098 4.39052 14.546 7.99992 14.546C11.6093 14.546 14.5453 11.6092 14.5453 8.0006V8Z",fill:"currentColor"})})},74562:(e,n,t)=>{"use strict";t.d(n,{YH:()=>i,oM:()=>r});var l=t(77721);async function r(){return(await l.g.get("/api/flag")).data}async function i(){try{await l.g.post("/api/relaunch-hint/completed")}catch(e){}}},77498:(e,n,t)=>{"use strict";t.d(n,{q:()=>i});var l=t(90181),r=t(73483);let i=(0,l.m)(r.sb,{preflight:{scope:".chakra-style-reset"},theme:{tokens:{colors:{brand:{50:{value:"#FFDED5"},100:{value:"#FFC1B0"},200:{value:"#FFA58C"},300:{value:"#FF8967"},400:{value:"#FF6E42"},DEFAULT:{value:"#FD541E"},500:{value:"#FD541E"},600:{value:"#F04104"},700:{value:"#C93A06"},800:{value:"#A23206"},900:{value:"#7C2906"},950:{value:"#571E05"}}}},semanticTokens:{colors:{brand:{solid:{value:"{colors.brand.500}"},contrast:{value:"{colors.white}"},fg:{value:"{colors.brand.700}"},muted:{value:"{colors.brand.100}"},subtle:{value:"{colors.brand.200}"},emphasized:{value:"{colors.brand.300}"},focusRing:{value:"{colors.brand.500}"}}}}}})},77721:(e,n,t)=>{"use strict";t.d(n,{g:()=>a,x:()=>s});var l=t(92587),r=t(40484),i=t(83569);let a=l.A.create({baseURL:r.V}),s=new i.E},90271:(e,n,t)=>{"use strict";function l(e,n){let t=[...e],l=[...n],r=[];for(;t.length>0&&l.length>0;)if(r.includes(t[0]))t.shift();else if(r.includes(l[0]))l.shift();else if(t[0]===l[0])r.push(t[0]),t.shift(),l.shift();else if(l.includes(t[0])){let e=l.indexOf(t[0]);for(let n=0;n<e;n++)r.includes(l[n])||r.push(l[n]);r.push(t[0]),t.shift(),l.splice(0,e+1)}else r.push(t[0]),t.shift();return t.forEach(e=>{r.includes(e)||r.push(e)}),l.forEach(e=>{r.includes(e)||r.push(e)}),r}function r(e,n){let t=l(e,n),r={};for(let l of t)e.includes(l)?n.includes(l)?r[l]=void 0:r[l]="removed":r[l]="added";let i={};e.forEach((e,n)=>{i[e]=n});let a=-1;for(let e of t){let n=i[e];null!=n&&(n>a?a=n:r[e]="reordered")}return r}t.d(n,{Z:()=>l,l:()=>r})},93569:(e,n,t)=>{"use strict";t.d(n,{$U:()=>d,F7:()=>s,I:()=>i,vr:()=>o});var l=t(79367),r=t(5007);let i='select * from {{ ref("mymodel") }}',a=(0,r.createContext)({sqlQuery:i,setSqlQuery:()=>{},primaryKeys:void 0,setPrimaryKeys:()=>{},isCustomQueries:!1,setCustomQueries:()=>{},baseSqlQuery:i,setBaseSqlQuery:()=>{}});function s(e){let{children:n}=e,[t,s]=r.useState(i),[o,c]=r.useState(i),[d,u]=r.useState(!1),[h,m]=r.useState();return(0,l.jsx)(a.Provider,{value:{setSqlQuery:s,sqlQuery:t,setPrimaryKeys:m,primaryKeys:h,isCustomQueries:d,setCustomQueries:u,baseSqlQuery:o,setBaseSqlQuery:c},children:n})}let o=()=>(0,r.useContext)(a),c=(0,r.createContext)({isNodesFetching:[],setIsNodesFetching:()=>{}});function d(e){let{children:n}=e,[t,i]=r.useState([]);return(0,l.jsx)(c.Provider,{value:{isNodesFetching:t,setIsNodesFetching:i},children:n})}},94805:(e,n,t)=>{"use strict";t.d(n,{$M:()=>s,Qf:()=>c,Ve:()=>d,X2:()=>u,Zp:()=>h,yc:()=>o});var l=t(15456),r=t(36956),i=t(92095),a=t.n(i);let s=20;function o(e,n,t){var l,r,i,a,s,o,c,d;let u={},h={},m=(e,n)=>({id:e,name:e,data:{},from:n,parents:{},children:{}});for(let[n,t]of Object.entries(e.nodes))u[n]=m(n,"base"),t&&(u[n].data.base=t,u[n].name=t.name,u[n].resourceType=t.resource_type,u[n].packageName=t.package_name);for(let[e,t]of Object.entries(n.nodes))u[e]?u[e].from="both":u[e]=m(e,"current"),t&&(u[e].data.current=n.nodes[e],u[e].name=t.name,u[e].resourceType=t.resource_type,u[e].packageName=t.package_name);for(let[n,t]of Object.entries(e.parent_map))for(let e of t){let t=u[n],l=u[e],r="".concat(e,"_").concat(n);if(!t||!l)continue;h[r]={id:r,from:"base",parent:l,child:t};let i=h[r];t.parents[e]=i,l.children[n]=i}for(let[e,t]of Object.entries(n.parent_map))for(let n of t){let t=u[e],l=u[n],r="".concat(n,"_").concat(e);if(!t||!l)continue;h[r]?h[r].from="both":h[r]={id:r,from:"current",parent:l,child:t};let i=h[r];t.parents[n]=i,l.children[e]=i}let f=[];for(let[e,n]of Object.entries(u)){let s=null==t?void 0:t[e];if(s)n.changeStatus=s.change_status,s.change&&(n.change={category:s.change.category,columns:s.change.columns}),f.push(e);else if("base"===n.from)n.changeStatus="removed",f.push(n.id);else if("current"===n.from)n.changeStatus="added",f.push(n.id);else{let e=null==(r=n.data.base)||null==(l=r.checksum)?void 0:l.checksum,t=null==(a=n.data.current)||null==(i=a.checksum)?void 0:i.checksum;e&&t&&e!==t&&(n.changeStatus="modified",f.push(n.id))}}for(let[e,n]of Object.entries(h))"base"===n.from?n.changeStatus="removed":"current"===n.from&&(n.changeStatus="added");return{nodes:u,edges:h,modifiedSet:f,manifestMetadata:{base:null!=(s=e.manifest_metadata)?s:void 0,current:null!=(o=n.manifest_metadata)?o:void 0},catalogMetadata:{base:null!=(c=e.catalog_metadata)?c:void 0,current:null!=(d=n.catalog_metadata)?d:void 0}}}function c(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return(0,r.zY)(n,n=>void 0===e.nodes[n]?[]:Object.keys(e.nodes[n].parents),t)}function d(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return(0,r.zY)(n,n=>void 0===e.nodes[n]?[]:Object.keys(e.nodes[n].children),t)}function u(e,n){let t=[],r=[],{selectedNodes:i,cll:a}=null!=n?n:{},o={};function c(e){return"base"===e?0:"current"===e?2:1}function d(e,n){let t=c(e.from),l=c(n.from);return t<l?-1:+(t>l)}let u=void 0!==i?new Set(i):void 0;for(let n of Object.values(e.nodes).sort(d)){if(u&&!u.has(n.id))continue;let e=new Set,i=0;if(a){var m,f,p,x,g,v,y;for(let e of null!=(p=null==a||null==(m=a.current)?void 0:m.parent_map[n.id])?p:new Set){let t=n.id;r.push({id:"m2c_".concat(e,"_").concat(t),source:e,target:t,style:{zIndex:9999}})}for(let o of Object.keys(null!=(x=null==(f=n.data.current)?void 0:f.columns)?x:{})){let c="".concat(n.id,"_").concat(o),d=null==a||null==(g=a.current)?void 0:g.columns[c],u=null!=(y=null==a||null==(v=a.current)?void 0:v.parent_map[c])?y:new Set;if(null!=d){for(let e of(t.push({id:c,position:{x:10,y:70+i*s},parentId:n.id,extent:"parent",draggable:!1,className:"no-track-pii-safe",data:{node:n,column:d.name,type:d.type,transformationType:d.transformation_type,changeStatus:d.change_status},style:{zIndex:9999},type:"customColumnNode",targetPosition:l.yX.Left,sourcePosition:l.yX.Right}),u))r.push({id:"".concat(e,"_").concat(c),source:e,target:c,style:{zIndex:9999}});i++,e.add(d.name)}}}o[n.id]=e;let c=60;i>0&&(c+=20+i*s),t.push({id:n.id,position:{x:0,y:0},width:300,height:c,className:"no-track-pii-safe",data:{...n},type:"customNode",targetPosition:l.yX.Left,sourcePosition:l.yX.Right})}for(let n of Object.values(e.edges).sort(d))(!u||u.has(n.parent.id)&&u.has(n.child.id))&&r.push({id:n.id,type:"customEdge",source:n.parent.id,target:n.child.id,data:n});return h(t,r),[t,r,o]}let h=function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"LR",l=new(a()).graphlib.Graph;l.setDefaultEdgeLabel(()=>({})),l.setGraph({rankdir:t,ranksep:50,nodesep:30}),e.forEach(e=>{"customNode"===e.type&&l.setNode(e.id,{width:e.width,height:e.height})}),n.forEach(e=>{l.setEdge(e.source,e.target)}),a().layout(l),e.forEach(e=>{var n,t;if("customNode"!==e.type)return;let r=null!=(n=e.width)?n:300,i=null!=(t=e.height)?t:60,a=l.node(e.id);return e.position={x:a.x-r/2,y:a.y-i/2},e})}},97887:(e,n,t)=>{"use strict";t.d(n,{dZ:()=>E,tr:()=>R});var l=t(79367),r=t(5007),i=t(33674),a=t(53379),s=t(89851),o=t(25809),c=t(26917),d=t(57483),u=t(64144),h=t(781),m=t(70029),f=t(74523),p=t(71407);let x=e=>({value_diff:"https://docs.datarecce.io/features/lineage/#value-diff",profile_diff:"https://docs.datarecce.io/features/lineage/#profile-diff",histogram_diff:"https://docs.datarecce.io/features/lineage/#histogram-diff",top_k_diff:"https://docs.datarecce.io/features/lineage/#top-k-diff"})[e]||null,g=e=>{let{isOpen:n,onClose:t,onExecute:g,type:v,title:y,params:j,RunForm:C}=e,[b,w]=(0,r.useState)(j),[_,k]=(0,r.useState)(!1),[S,E]=(0,r.useState)(!1),R=x(v);return(0,l.jsx)(i.Dz,{open:n,onOpenChange:t,size:"xl",scrollBehavior:"inside",children:(0,l.jsxs)(a.Z,{children:[(0,l.jsx)(i.Xi,{}),(0,l.jsx)(i.f5,{children:(0,l.jsxs)(i.Cf,{overflowY:"auto",height:"75%",minHeight:"400px",children:[(0,l.jsxs)(i.c7,{children:[(0,l.jsxs)(i.L3,{display:"flex",alignItems:"center",children:[y," ",R&&(0,l.jsxs)(s.yt,{positioning:{placement:"bottom-end"},open:_,onFocusOutside:()=>{k(!1)},children:[(0,l.jsx)(s.Wv,{asChild:!0,children:(0,l.jsx)(o.K,{display:"flex",size:"sm",variant:"plain","aria-label":"Click this button to learn more about the SQL behind",onMouseEnter:()=>{k(!0)},onClick:()=>window.open(R,"_blank"),onFocus:e=>{e.preventDefault()},children:(0,l.jsx)(c.I,{verticalAlign:"middle",as:p.G_,boxSize:"16px"})})}),(0,l.jsx)(s.Ug,{children:(0,l.jsx)(s.hl,{bg:"black",color:"white",children:(0,l.jsxs)(s.ej,{fontSize:"sm",p:2,children:["Click"," ",(0,l.jsx)(d.N,{href:R,target:"_blank",textDecoration:"underline",color:"white",_hover:{color:"blue.300"},children:"here"})," ","to learn more about the SQL behind"]})})})]})]}),(0,l.jsx)(i.tK,{asChild:!0,children:(0,l.jsx)(u.J,{size:"sm"})})]}),(0,l.jsx)(i.R4,{p:"0px",h:"100%",overflow:"auto",borderY:"1px solid lightgray",children:(0,l.jsx)(h.a,{style:{contain:"layout"},children:C&&(0,l.jsx)(C,{params:b,onParamsChanged:w,setIsReadyToExecute:E})})}),(0,l.jsx)(i.Es,{children:(0,l.jsx)(m.s,{gap:"10px",children:(0,l.jsx)(f.$,{disabled:!S,colorPalette:"blue",onClick:()=>{g(v,b)},children:"Execute"})})})]})})]})})};var v=t(95127),y=t(82633),j=t(52810),C=t(99634),b=t(13903),w=t(7206),_=t(25035);let k=(0,r.createContext)({runAction:()=>{},showRunId:e=>{},isRunResultOpen:!1,closeRunResult:()=>{},isHistoryOpen:!1,closeHistory:()=>{},showHistory:()=>{},clearRunResult:()=>{}}),S=e=>{let[n]=(0,y.zy)();(0,r.useEffect)(()=>{e()},[e,n])};function E(e){var n;let{children:t}=e,[i,a]=(0,r.useState)(),{open:s,onOpen:o,onClose:c}=(0,v.j)(),{open:d,onOpen:u,onClose:h}=(0,v.j)(),{open:m,onOpen:f,onClose:p}=(0,v.j)(),[x,E]=(0,r.useState)(),[R,M]=(0,y.zy)(),O=(0,b.jE)(),T=(0,r.useCallback)(async(e,n)=>{E(e),u(),!1!==n&&await O.invalidateQueries({queryKey:w.X.runs()})},[E,u,O]),I=(0,r.useCallback)(()=>{E(void 0),h()},[h,E]),A=(0,r.useCallback)(async(e,n,t)=>{try{let l,r=new Date().getTime().toString();if(null==t?void 0:t.showLast){let t=await (0,j.xz)(e,n,1);1===t.length&&(l=t[0])}let i=(0,C.C)(e);if(void 0===i)throw Error("Unknown run type: ".concat(e));let{title:s,RunResultView:c,RunForm:d}=i;if(void 0===c)throw Error("Run type ".concat(e," does not have a result view"));if(void 0!=d&&(null==t?void 0:t.showForm))a({session:r,title:s,type:e,params:n,lastRun:l,options:t,RunForm:d}),o();else{let{run_id:l}=await (0,j.AU)(e,n,{nowait:!0,trackProps:null==t?void 0:t.trackProps});await T(l),await O.invalidateQueries({queryKey:w.X.runs()}),R.startsWith("/lineage")&&M("/lineage")}}catch(e){_.X.create({title:"Failed to submit a run",description:e instanceof Error?e.message:void 0,type:"error",duration:5e3,closable:!0})}},[a,o,T,R,M,O]);S(c);let N=async(e,n)=>{try{var t;c();let{run_id:l}=await (0,j.AU)(e,n,{nowait:!0,trackProps:null==i||null==(t=i.options)?void 0:t.trackProps});await T(l)}catch(e){_.X.create({title:"Failed to submit a run",description:e instanceof Error?e.message:void 0,type:"error",duration:5e3,closable:!0})}};return(0,l.jsxs)(k.Provider,{value:{runAction:A,runId:x,showRunId:T,isRunResultOpen:d,closeRunResult:h,isHistoryOpen:m,closeHistory:p,showHistory:f,clearRunResult:I},children:[i&&(0,l.jsx)(g,{isOpen:s,onClose:c,onExecute:N,title:i.title,type:i.type,params:i.params,initialRun:i.lastRun,RunForm:(null==(n=i.options)?void 0:n.showForm)&&i.RunForm?i.RunForm:void 0},i.session),t]})}let R=()=>(0,r.useContext)(k)},99634:(e,n,t)=>{"use strict";t.d(n,{C:()=>eB});var l=t(81721),r=t(67774),i=t(79367),a=t(70029),s=t(13944),o=t(37659),c=t(781),d=t(41592),u=t(99223);function h(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",t=arguments.length>2?arguments[2]:void 0;return"number"!=typeof e?e:new Intl.NumberFormat(n,t).format(e)}function m(e){let n=e>0&&e<=.001,t=e<1&&e>=.999,l=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;return h(n,"en-US",{style:"percent",minimumFractionDigits:1})};if(n){let e=l(.001);return"<".concat(e)}if(t){let e=l(.999);return">".concat(e)}return l()}function f(e){if("number"!=typeof e)return e;{let n=Math.abs(e),t=n>=.01,l=n>=1e6,r=n>=1e9,i=n>=1e15;if(i||n>=1e12)return new Intl.NumberFormat("en-US",{style:"unit",unit:"liter",unitDisplay:"narrow",maximumFractionDigits:2*!i}).format(e/1e12).replace("L","T");if(r||l||n>=1e3){let n={base:r?1e9:l?1e6:1e3,unit:r?"B":l?"M":"K"};return new Intl.NumberFormat("en-US",{style:"unit",unit:"liter",unitDisplay:"narrow",maximumFractionDigits:1}).format(e/n.base).replace("L",n.unit)}if(n>=1)return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(e);else return new Intl.NumberFormat("en-US",{maximumFractionDigits:t?3:2,notation:t||0===n?"standard":"scientific"}).format(e)}}let p="#63B3ED",x="#F6AD55",g="".concat(p,"A5"),v="".concat(x,"A5");function y(e){let{color:n}=e;return(0,i.jsx)(c.a,{display:"inline-block",w:"10px",h:"10px",bgColor:n,mr:"2",borderRadius:"sm"})}function j(e){let{data:n,hideAxis:t=!1,animation:l=!1}=e;d.t1.register(d.E8,d.iw,d.kc,d.PP,d.hE,d.s$,d.m_);let r=function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{...t}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{title:l,datasets:r,type:i,samples:a=0,binEdges:s}=e,[o,c]=r,d="datetime"===i;return{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{reverse:!0},title:{display:!0,text:l,font:{size:20}},tooltip:{mode:"index",intersect:!1,callbacks:{title(e){let[{dataIndex:n,datasetIndex:t}]=e,l=b(s,n);return"".concat(d?"Date Range":"string"===i?"Text Length":"Value Range","\n").concat(l)},label(e){let{datasetIndex:n,dataIndex:t,dataset:{label:l}}=e,r=0===n?c.counts:o.counts,i=m(r[t]/a),s=r[t];return"".concat(l,": ").concat(s," (").concat(i,")")}}}},scales:function(e){let{datasets:n,min:t=0,max:l=0,type:r,binEdges:i}=e,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],[s,o]=n,c=Math.max(...o.counts,...s.counts),d=i.map((e,n)=>b(i,n)).slice(0,-1);return{x:"datetime"===r?{display:!a,type:"timeseries",min:t,max:l,adapters:{date:{}},time:{minUnit:"day"},grid:{display:!1},ticks:{minRotation:30,maxRotation:30,maxTicksLimit:8}}:{display:!a,type:"category",grid:{display:!1},ticks:{callback:(e,n)=>d[n]},stacked:!0},y:{display:!a,type:"linear",max:c,border:{dash:[2,2]},grid:{color:"lightgray"},ticks:{maxTicksLimit:8,callback:function(e,n){return f(e)}},beginAtZero:!0}}}(e,n),...t}}(n,t,{animation:l}),a=function(e){let{datasets:n,type:t,binEdges:l}=e,[r,i]=n,a=C(t,l,"Current",g,i),s=C(t,l,"Base",v,r);return{labels:l.map((e,n)=>b(l,n)).slice(0,-1),datasets:[a,s]}}(n);return(0,i.jsx)(u.t1,{type:"bar",options:r,data:a,plugins:[]})}function C(e,n,t,l,r){let{counts:i=[]}=r;return{label:t,data:"datetime"===e?i.map((e,t)=>({x:n[t],y:e})):i,backgroundColor:l,borderColor:l,hoverBackgroundColor:l,borderWidth:0,categoryPercentage:1,barPercentage:1,xAxisID:"x"}}function b(e,n){let t=e[n],l=e[n+1],r=f(t),i=f(l);return"".concat(r," - ").concat(i)}var w=t(5007);let _=(0,w.forwardRef)((e,n)=>{let{backgroundColor:t="white",blockSize:l,children:r,...a}=e;return(0,i.jsx)(c.a,{ref:n,...a,overflowY:"auto",overflowX:"hidden",children:(0,i.jsx)(c.a,{backgroundColor:t,height:"100%",blockSize:l,children:r})})}),k=(0,w.forwardRef)(function(e,n){var t,l,r,d,u,h,m;let{run:f}=e,p=f.params,x=null==(t=f.result)?void 0:t.base,g=null==(l=f.result)?void 0:l.current,v=null==(r=f.result)?void 0:r.min,y=null==(d=f.result)?void 0:d.max,C=null==(u=f.result)?void 0:u.bin_edges;return x&&g?(0,i.jsx)(a.s,{direction:"column",height:"100%",children:(0,i.jsx)(_,{ref:n,height:"100%",children:(0,i.jsxs)(s.z,{children:[(0,i.jsx)(o.h,{}),(0,i.jsx)(c.a,{w:"80%",h:"35vh",m:"4",children:(0,i.jsx)(j,{data:{title:"Model ".concat(p.model,".").concat(p.column_name),type:null!=(m=null==(h=f.params)?void 0:h.column_type)?m:"",datasets:[x,g],min:v,max:y,samples:x.total,binEdges:C}})}),(0,i.jsx)(o.h,{})]})})}):(0,i.jsx)("div",{children:"Loading..."})});var S=t(36357),E=t(56536),R=t(47903),M=t(17090),O=t.n(M);t(60077);var T=t(26917),I=t(73793),A=t(25809),N=t(53379),L=t(5055),F=t(31633),V=t(90271),z=t(42125),H=t(48358);let P=e=>{let{value:n,colorPalette:t,grayOut:l,noCopy:r,fontSize:s}=e,[o,d]=(0,z.Cj)(),u=!!o,[h,m]=(0,w.useState)(!1);return(0,i.jsxs)(a.s,{p:"2px 5px",minWidth:"30px",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",color:"".concat(t,".800"),backgroundColor:"".concat(t,".100"),alignItems:"center",gap:"2px",rounded:"md",fontSize:s,flexShrink:r?"0":"inherit",onMouseEnter:()=>{m(!0)},onMouseLeave:()=>{m(!1)},children:[(0,i.jsx)(c.a,{overflow:"hidden",textOverflow:"ellipsis",color:l?"gray":"inherit",children:n}),(0,i.jsx)(()=>r||l?(0,i.jsx)(i.Fragment,{}):u?(0,i.jsx)(i.Fragment,{children:"Copied"}):h?(0,i.jsx)(A.K,{"aria-label":"Copy",size:"xs",minW:"10px",h:"10px",variant:"plain",onClick:()=>d(n),display:"flex",alignItems:"center",justifyContent:"center",children:(0,i.jsx)(H.hX7,{size:"10px"})}):(0,i.jsx)(i.Fragment,{}),{})]})};function D(e,n){return[{value:"Show raw value",onClick:()=>{n({[e]:"raw"})}},{value:"Show 2 decimal points",onClick:()=>{n({[e]:2})}},{value:"Show 4 decimal points",onClick:()=>{n({[e]:4})}},{value:"Show 6 decimal points",onClick:()=>{n({[e]:6})}},{value:"Show as percentage",onClick:()=>{n({[e]:"percent"})}}]}function K(e,n){let t=[];for(let l of n){let n=e.findIndex(e=>e.name===l);if(n<0)throw Error("Column ".concat(l," not found"));t.push(n)}return t}function B(e,n,t){let l={};if(0===n.length)return JSON.stringify({_index:t._index});for(let r of n)l[e[r].name]=t[r];return JSON.stringify(l)}function W(e){var n,t;let{name:l,columnStatus:r,onPrimaryKeyChange:s,onPinnedColumnsChange:o,columnType:d,onColumnsRenderModeChanged:u,...h}=e,m=null!=(n=h.primaryKeys)?n:[],f=null!=(t=h.pinnedColumns)?t:[],p=m.includes(l),x=f.includes(l),g=[];return(u&&(g=D(l,u)),"index"===l)?(0,i.jsx)(i.Fragment,{}):(0,i.jsxs)(a.s,{alignItems:"center",gap:"10px",className:"grid-header",children:[p&&(0,i.jsx)(T.I,{as:F.IuQ}),(0,i.jsx)(c.a,{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:l}),"added"!==r&&"removed"!==r&&s&&(0,i.jsx)(T.I,{className:p?"close-icon":"key-icon",display:p?"block":"none",cursor:"pointer",as:p?F.RQJ:F.IuQ,onClick:p?()=>{let e=m.filter(e=>e!==l);s&&s(e)}:()=>{let e=[...m.filter(e=>"index"!==e),l];s&&s(e)}}),!p&&o&&(0,i.jsx)(T.I,{className:x?"unpin-icon":"pin-icon",display:x?"block":"none",cursor:"pointer",as:x?F.FUl:F.woV,onClick:x?()=>{let e=f.filter(e=>e!==l);o&&o(e)}:()=>{let e=[...f,l];o&&o(e)}}),!p&&"number"===d&&(0,i.jsxs)(I.il,{children:[(0,i.jsx)(I.cQ,{asChild:!0,children:(0,i.jsx)(A.K,{"aria-label":"Options",variant:"plain",className:"!size-4 !min-w-4",children:(0,i.jsx)(F.EUt,{})})}),(0,i.jsx)(N.Z,{children:(0,i.jsx)(I.y3,{children:(0,i.jsx)(I.rm,{children:g.map(e=>(0,i.jsx)(I.Dr,{value:e.value,onClick:e.onClick,children:e.value},e.value))})})})]})]})}let X=function(e,n,t){let l,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"raw";if(!Object.hasOwn(e,n))return["-",!0];let i=e[n],a=!1;return"boolean"==typeof i?l=i.toString():""===i?(l="(empty)",a=!0):null==i?(l="(null)",a=!0):l="number"==typeof i?String(i):t&&"number"===t?function(e,n){let t,l="en-US";return null!=(t="number"==typeof n?h(e,l,{maximumFractionDigits:n,minimumFractionDigits:n}):"percent"===n?h(e,l,{style:"percent",maximumFractionDigits:2}):String(e))?t:""}(parseFloat(i),r):String(i),[l,a]},Z=e=>{let{row:n,column:t}=e,{columnType:l,columnRenderMode:r}=t,[a,s]=X(n,t.key,l,r);return(0,i.jsx)(L.E,{style:{color:s?"gray":"inherit"},children:a})},U=e=>{let{row:n,column:t}=e,{columnType:l,columnRenderMode:r}=t,s="base__".concat(t.key),o="current__".concat(t.key);if(!Object.hasOwn(n,s)&&!Object.hasOwn(n,o))return"-";let c=Object.hasOwn(n,s),d=Object.hasOwn(n,o),[u,h]=X(n,"base__".concat(t.key),l,r),[m,f]=X(n,"current__".concat(t.key),l,r);return n[s]===n[o]?(0,i.jsx)(L.E,{style:{color:f?"gray":"inherit"},children:m}):(0,i.jsxs)(a.s,{gap:"5px",alignItems:"center",lineHeight:"normal",height:"100%",children:[c&&(0,i.jsx)(P,{value:u,colorPalette:"red",grayOut:h}),d&&(0,i.jsx)(P,{value:m,colorPalette:"green",grayOut:f})]})};function Q(e,n,t){var l,r,a,s,o;let c=null!=e?e:{columns:[],data:[]},d=null!=n?n:{columns:[],data:[]},u=null!=(l=null==t?void 0:t.primaryKeys)?l:[],h=null!=(r=null==t?void 0:t.pinnedColumns)?r:[],m=null!=(a=null==t?void 0:t.changedOnly)&&a,f=null!=(s=null==t?void 0:t.displayMode)?s:"side_by_side",p=null!=(o=null==t?void 0:t.columnsRenderMode)?o:{},x=[],g=function(e,n){let t={};return Object.entries((0,V.l)(e.columns.map(e=>e.name),n.columns.map(e=>e.name))).map(l=>{var r,i;let[a,s]=l;t[a]={status:s,baseColumnIndex:e.columns.findIndex(e=>e.name===a),currentColumnIndex:n.columns.findIndex(e=>e.name===a),colType:null!=(i=null==(r=e.columns.find(e=>e.name===a))?void 0:r.type)?i:"unknown"}}),t}(c,d),v={},y={},j=!1,C=!1;if(0===u.length)c.data.forEach((e,n)=>{e._index=n+1,v[JSON.stringify({_index:n+1})]=e}),d.data.forEach((e,n)=>{e._index=n+1,y[JSON.stringify({_index:n+1})]=e});else{let e=K(c.columns,u);c.data.forEach((n,t)=>{let l=B(c.columns,e,n);l in v&&(j=!0),v[l]=n}),e=K(d.columns,u),d.data.forEach((n,t)=>{let l=B(d.columns,e,n);l in y&&(C=!0),y[l]=n})}let b=(0,V.l)(Object.keys(v),Object.keys(y)),w={added:0,removed:0,modified:0},_=Object.entries(b).map(e=>{let[n,t]=e,l=v[n],r=y[n],i=JSON.parse(n);if(l&&c.columns.forEach((e,n)=>{u.includes(e.name)||(i["base__".concat(e.name)]=l[n])}),r&&d.columns.forEach((e,n)=>{u.includes(e.name)||(i["current__".concat(e.name)]=r[n])}),l)if(r){for(let[e,n]of Object.entries(g))!("index"===e||u.includes(e))&&(n.baseColumnIndex<0||n.currentColumnIndex<0||O().isEqual(l[n.baseColumnIndex],r[n.currentColumnIndex])||(i.__status="modified",n.status="modified"));"modified"===i.__status&&w.modified++}else i.__status="removed",w.removed++;else i.__status="added",w.added++;return i});m&&(_=_.filter(e=>"added"===e.__status||"removed"===e.__status||"modified"===e.__status));let k=function(e,n,l){var r,a;let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"raw",o="added"===n?"diff-header-added":"removed"===n?"diff-header-removed":void 0;return"inline"===f?{headerCellClass:o,name:(0,i.jsx)(W,{name:e,columnStatus:n,columnType:l,...t}),key:e,renderCell:U,columnType:l,columnRenderMode:s}:{headerCellClass:o,name:(0,i.jsx)(W,{name:e,columnStatus:n,columnType:l,...t}),children:[{key:"base__".concat(e),name:null!=(r=null==t?void 0:t.baseTitle)?r:"Base",renderEditCell:R.jE,headerCellClass:o,cellClass:t=>{let l=t.__status;if("removed"===l)return"diff-cell-removed";if("added"===l)return"diff-cell-added";if("added"===n);else if("removed"===n);else if(!O().isEqual(t["base__".concat(e)],t["current__".concat(e)]))return"diff-cell-removed"},renderCell:Z,columnType:l,columnRenderMode:s},{key:"current__".concat(e),name:null!=(a=null==t?void 0:t.currentTitle)?a:"Current",renderEditCell:R.jE,headerCellClass:o,cellClass:t=>{let l=t.__status;if("removed"===l)return"diff-cell-removed";if("added"===l)return"diff-cell-added";if("added"===n);else if("removed"===n);else if(!O().isEqual(t["base__".concat(e)],t["current__".concat(e)]))return"diff-cell-added"},renderCell:Z,columnType:l,columnRenderMode:s}]}};return 0===u.length?x.push({key:"_index",width:50,maxWidth:100,name:"",cellClass:"index-column"}):u.forEach(e=>{var n;let l=null!=(n=g[e].status)?n:"",r=g[e].colType;x.push({key:e,name:(0,i.jsx)(W,{name:e,columnStatus:l,columnType:r,...t}),frozen:!0,cellClass:e=>{if(e.__status)return"diff-header-".concat(e.__status)},renderCell:Z,columnType:r,columnRenderMode:p[e]})}),h.forEach(e=>{var n;let t=null!=(n=g[e].status)?n:"",l=g[e].colType;"index"!==e&&(u.includes(e)||x.push(k(e,t,l,p[e])))}),Object.entries(g).forEach(e=>{var n;let[t,l]=e,r=null!=(n=l.status)?n:"",i=g[t].colType;!("index"===t||u.includes(t)||h.includes(t))&&(m&&w.modified>0&&"added"!==r&&"removed"!==r&&"modified"!==r||x.push(k(t,r,i,p[t])))}),{columns:x,rows:_,invalidPKeyBase:j,invalidPKeyCurrent:C}}var q=t(37018);let J=e=>{let{warnings:n,children:t}=e;return(0,i.jsxs)(a.s,{borderBottom:"1px solid lightgray",justifyContent:"flex-end",gap:"5px",alignItems:"center",px:"10px",bg:n&&n.length>0?"orange.100":"inherit",children:[(0,i.jsx)(q.T,{alignItems:"flex-start",gap:0,children:null==n?void 0:n.map((e,n)=>(0,i.jsxs)(c.a,{children:[(0,i.jsx)(H.e5t,{color:"orange.600"})," ",e]},n))}),(0,i.jsx)(o.h,{minHeight:"32px"}),t]})};var Y=t(8193),$=t(74523);let G=e=>{let{value:n,onChange:t,textOn:l,textOff:r}=e;return(0,i.jsxs)(Y.e,{attached:!0,variant:"outline",borderRadius:"full",size:"xs",children:[(0,i.jsx)($.$,{onClick:()=>{t(!1)},color:n?"gray.400":"black",bg:n?"gray.50":"white",children:null!=r?r:"Off"}),(0,i.jsx)($.$,{onClick:()=>{t(!0)},color:n?"black":"gray.400",bg:n?"white":"gray.50",children:null!=l?l:"On"})]})},ee=e=>{let{displayMode:n,onDisplayModeChanged:t}=e;return(0,i.jsxs)(i.Fragment,{children:["inline"===n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(P,{value:"Base",colorPalette:"red",grayOut:!1,fontSize:"10pt",noCopy:!0}),(0,i.jsx)(P,{value:"Current",colorPalette:"green",grayOut:!1,fontSize:"10pt",noCopy:!0})]}),(0,i.jsx)(G,{value:"side_by_side"===n,onChange:e=>{t(e?"side_by_side":"inline")},textOff:"Inline",textOn:"Side by side"})]})};function en(e){let{name:n,pinnedColumns:t=[],onPinnedColumnsChange:l=()=>{},columnType:r,onColumnsRenderModeChanged:s}=e,o=[];s&&(o=D(n,s));let d=t.includes(n);return(0,i.jsxs)(a.s,{className:"grid-header",alignItems:"center",children:[(0,i.jsx)(c.a,{flex:1,children:n}),(0,i.jsx)(T.I,{className:d?"unpin-icon":"pin-icon",display:d?"block":"none",cursor:"pointer",as:d?F.FUl:F.woV,onClick:d?()=>{l(t.filter(e=>e!==n))}:()=>{l([...t,n])}}),"number"===r&&(0,i.jsxs)(I.il,{children:[(0,i.jsx)(I.cQ,{asChild:!0,children:(0,i.jsx)(A.K,{"aria-label":"Options",variant:"plain",className:"!size-4 !min-w-4",children:(0,i.jsx)(H.Q7K,{})})}),(0,i.jsx)(N.Z,{children:(0,i.jsx)(I.y3,{children:(0,i.jsx)(I.rm,{children:o.map(e=>(0,i.jsx)(I.Dr,{value:e.value,onClick:e.onClick,children:e.value},e.value))})})})]})]})}function et(e,n){var t,l,r;let a=[],s=null!=(t=n.primaryKeys)?t:[],o=null!=(l=n.pinnedColumns)?l:[],c=null!=(r=n.columnsRenderMode)?r:{},d={};e.columns.forEach(e=>{d[e.name]={colType:e.type}});let u=function(e,t,l){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"raw";return{key:String(e),name:(0,i.jsx)(en,{name:t,...n,columnType:l}),width:"auto",renderCell:Z,columnType:l,columnRenderMode:r}},h=function(e,t,l){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"raw";return{key:String(e),name:(0,i.jsx)(W,{name:t,columnStatus:"",columnType:l,...n}),width:"auto",frozen:!0,renderCell:Z,columnType:l,columnRenderMode:r}};return s.length>0?s.forEach(n=>{let t=O().findIndex(e.columns,e=>e.name===n),l=d[n].colType;a.push(h(t,n,l,c[n]))}):a.push({key:"_index",name:"",width:50,cellClass:"index-column"}),o.forEach(n=>{let t=d[n].colType,l=O().findIndex(e.columns,e=>e.name===n);l<0||a.push(u(l,n,t,c[n]))}),e.columns.forEach((e,n)=>{let{name:t}=e;if(s.includes(t)||o.includes(t))return;let l=d[t].colType;a.push(u(n,t,l,c[t]))}),e.data.forEach((e,n)=>{e._index=n+1}),{columns:a,rows:e.data}}t(88930);let el=(0,w.forwardRef)((e,n)=>{var t;let{run:l,viewOptions:r,onViewOptionsChanged:s,onAddToChecklist:d}=e,u=(0,w.useMemo)(()=>{var e;return null!=(e=null==r?void 0:r.pinned_columns)?e:[]},[r]),h=(0,w.useMemo)(()=>{var e;return null!=(e=null==r?void 0:r.columnsRenderMode)?e:{}},[r]),m=l.result,f=(0,w.useMemo)(()=>m?et(m,{pinnedColumns:u,onPinnedColumnsChange:e=>{s&&s({...r,pinned_columns:e})},columnsRenderMode:h,onColumnsRenderModeChanged:e=>{var n;let t={...null!=(n=null==r?void 0:r.columnsRenderMode)?n:{},...e};s&&s({...r,columnsRenderMode:t})}}):{rows:[],columns:[]},[m,u,r,s,h]);if(0===f.columns.length)return(0,i.jsx)(S.o,{height:"100%",children:"No data"});let p=m&&null!=(t=m.limit)?t:0,x=p>0&&(null==m?void 0:m.more)?"Warning: Displayed results are limited to ".concat(p.toLocaleString()," records. To ensure complete data retrieval, consider applying a LIMIT or WHERE clause to constrain the result set."):null,g=null!=d?d:x;return(0,i.jsxs)(a.s,{direction:"column",backgroundColor:"rgb(249, 249, 249)",height:"100%",children:[g&&(0,i.jsxs)(a.s,{borderBottom:"1px solid lightgray",alignItems:"center",gap:"5px",px:"10px",bg:x?"orange.100":"inherit",children:[x&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(H.e5t,{color:"orange.600",className:"self-center"})," ",(0,i.jsx)(c.a,{children:x})]}),(0,i.jsx)(o.h,{minHeight:"32px"}),d&&(0,i.jsx)($.$,{marginBlock:"5px",size:"xs",colorPalette:"cyan",onClick:()=>{d(l)},children:"Add to Checklist"})]}),(0,i.jsx)(E.z,{ref:n,style:{blockSize:"auto",maxHeight:"100%",overflow:"auto"},columns:f.columns,rows:f.rows,renderers:{noRowsFallback:(0,i.jsx)(E.a,{})},defaultColumnOptions:{resizable:!0,maxWidth:800,minWidth:35},className:"rdg-light"})]})}),er=(0,w.forwardRef)((e,n)=>{var t,l,r;let{run:s,viewOptions:o,onViewOptionsChanged:c}=e,d=s.result,u=(0,w.useMemo)(()=>{var e;return null!=(e=null==o?void 0:o.pinned_columns)?e:[]},[o]),h=(0,w.useMemo)(()=>{var e;return null!=(e=null==o?void 0:o.display_mode)?e:"inline"},[o]),m=(0,w.useMemo)(()=>{var e;return null!=(e=null==o?void 0:o.columnsRenderMode)?e:{}},[o]),f=(null!=(l=null==d||null==(t=d.current)?void 0:t.columns)?l:[]).find(e=>"column_name"===e.name.toLowerCase()),p=null!=(r=null==f?void 0:f.name)?r:"column_name",x=(0,w.useMemo)(()=>Q(null==d?void 0:d.base,null==d?void 0:d.current,{primaryKeys:[p],pinnedColumns:u,onPinnedColumnsChange:e=>{c&&c({...o,pinned_columns:e})},displayMode:h,columnsRenderMode:m,onColumnsRenderModeChanged:e=>{var n;let t={...null!=(n=null==o?void 0:o.columnsRenderMode)?n:{},...e};c&&c({...o,columnsRenderMode:t})}}),[d,p,u,h,o,c,m]);return 0===x.columns.length?(0,i.jsx)(S.o,{height:"100%",children:"No data"}):(0,i.jsxs)(a.s,{direction:"column",backgroundColor:"rgb(249, 249, 249)",height:"100%",children:[(0,i.jsx)(J,{run:s,children:(0,i.jsx)(ee,{displayMode:h,onDisplayModeChanged:e=>{c&&c({...o,display_mode:e})}})}),(0,i.jsx)(E.z,{ref:n,style:{blockSize:"auto",maxHeight:"100%",overflow:"auto"},columns:x.columns,rows:x.rows,defaultColumnOptions:{resizable:!0,maxWidth:800,minWidth:35},className:"rdg-light"})]})}),ei=(0,w.forwardRef)((e,n)=>{var t,l,r;let{run:s,viewOptions:o,onViewOptionsChanged:c}=e,d=s.result,u=null==d?void 0:d.current,h=(0,w.useMemo)(()=>{var e;return null!=(e=null==o?void 0:o.pinned_columns)?e:[]},[o]),m=(0,w.useMemo)(()=>{var e;return null!=(e=null==o?void 0:o.columnsRenderMode)?e:{}},[o]),f=(null!=(l=null==d||null==(t=d.current)?void 0:t.columns)?l:[]).find(e=>"column_name"===e.name.toLowerCase()),p=null!=(r=null==f?void 0:f.name)?r:"column_name",x=(0,w.useMemo)(()=>u?et(u,{primaryKeys:[p],pinnedColumns:h,onPinnedColumnsChange:e=>{c&&c({...o,pinned_columns:e})},columnsRenderMode:m,onColumnsRenderModeChanged:e=>{var n;let t={...null!=(n=null==o?void 0:o.columnsRenderMode)?n:{},...e};c&&c({...o,columnsRenderMode:t})}}):{columns:[],rows:[]},[u,h,p,o,c,m]);return 0===x.columns.length?(0,i.jsx)(S.o,{height:"100%",children:"No data"}):(0,i.jsx)(a.s,{direction:"column",backgroundColor:"rgb(249, 249, 249)",height:"100%",children:(0,i.jsx)(E.z,{ref:n,style:{blockSize:"auto",maxHeight:"100%",overflow:"auto"},columns:x.columns,rows:x.rows,defaultColumnOptions:{resizable:!0,maxWidth:800,minWidth:35},className:"rdg-light"})})});function ea(e){var n,t;let{name:l,columnStatus:r,onPrimaryKeyChange:s,onPinnedColumnsChange:o,columnType:d,onColumnsRenderModeChanged:u,...h}=e,m=null!=(n=h.primaryKeys)?n:[],f=null!=(t=h.pinnedColumns)?t:[],p=m.includes(l),x=f.includes(l),g=[];return(u&&(g=D(l,u)),"index"===l)?(0,i.jsx)(i.Fragment,{}):(0,i.jsxs)(a.s,{alignItems:"center",gap:"10px",className:"grid-header",children:[p&&(0,i.jsx)(T.I,{as:F.IuQ}),(0,i.jsx)(c.a,{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:l}),!p&&o&&(0,i.jsx)(T.I,{className:x?"unpin-icon":"pin-icon",display:x?"block":"none",cursor:"pointer",as:x?F.FUl:F.woV,onClick:x?()=>{let e=f.filter(e=>e!==l);o&&o(e)}:()=>{let e=[...f,l];o&&o(e)}}),!p&&"number"===d&&(0,i.jsxs)(I.il,{children:[(0,i.jsx)(I.cQ,{asChild:!0,children:(0,i.jsx)(A.K,{"aria-label":"Options",variant:"plain",className:"!size-4 !min-w-4",children:(0,i.jsx)(F.EUt,{})})}),(0,i.jsx)(N.Z,{children:(0,i.jsx)(I.y3,{children:(0,i.jsx)(I.rm,{children:g.map(e=>(0,i.jsx)(I.Dr,{value:e.value,onClick:e.onClick,children:e.value},e.value))})})})]})]})}function es(e,n,t){var l,r,a,s;let o=null!=(l=null==t?void 0:t.pinnedColumns)?l:[],c=null!=(r=null==t?void 0:t.changedOnly)&&r,d=null!=(a=null==t?void 0:t.displayMode)?a:"inline",u=null!=(s=null==t?void 0:t.columnsRenderMode)?s:{},h=[],m=function(e){let n={};return e.columns.map((e,t)=>{n[e.name]={index:t,colType:e.type}}),n}(e),f={},p={};if(0===n.length)throw Error("Primary keys are required");let x=function(e,n){let t=[];for(let l of n){let n=e.findIndex(e=>e.name===l);if(n<0)throw Error("Column ".concat(l," not found"));t.push(n)}return t}(e.columns,n),g=(m.in_a||m.IN_A).index,v=(m.in_b||m.IN_B).index;e.data.forEach((n,t)=>{let l=function(e,n,t){let l={};if(0===n.length)return JSON.stringify({_index:t._index});for(let r of n)l[e[r].name]=t[r];return JSON.stringify(l)}(e.columns,x,n);n[g]&&(f[l]=n),n[v]&&(p[l]=n)});let y=(0,V.l)(Object.keys(f),Object.keys(p)),j={added:0,removed:0,modified:0},C=Object.entries(y).map(t=>{let[l,r]=t,i=f[l],a=p[l],s=JSON.parse(l);if(i&&e.columns.forEach((e,t)=>{n.includes(e.name)||(s["base__".concat(e.name)]=i[t])}),a&&e.columns.forEach((e,t)=>{n.includes(e.name)||(s["current__".concat(e.name)]=a[t])}),i)if(a)for(let[e,t]of Object.entries(m))"index"!==e&&!n.includes(e)&&(O().isEqual(i[t.index],a[t.index])||(s.__status="modified",t.status="modified"));else s.__status="removed",j.removed++;else s.__status="added",j.added++;return"modified"===s.__status&&j.modified++,s});c&&(C=C.filter(e=>"added"===e.__status||"removed"===e.__status||"modified"===e.__status));let b=function(e,l,r){var a,s;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"raw",c="added"===l?"diff-header-added":"removed"===l?"diff-header-removed":void 0;return"inline"===d?{headerCellClass:c,name:(0,i.jsx)(ea,{name:e,columnStatus:l,primaryKeys:n,columnType:r,...t}),key:e,renderCell:U,columnType:r,columnRenderMode:o}:{headerCellClass:c,name:(0,i.jsx)(ea,{name:e,columnStatus:l,primaryKeys:n,columnType:r,...t}),children:[{key:"base__".concat(e),name:null!=(a=null==t?void 0:t.baseTitle)?a:"Base",renderEditCell:R.jE,headerCellClass:c,cellClass:n=>{let t=n.__status;if("removed"===t)return"diff-cell-removed";if("added"===t)return"diff-cell-added";if("added"===l);else if("removed"===l);else if(!O().isEqual(n["base__".concat(e)],n["current__".concat(e)]))return"diff-cell-removed"},renderCell:Z,columnType:r,columnRenderMode:o},{key:"current__".concat(e),name:null!=(s=null==t?void 0:t.currentTitle)?s:"Current",renderEditCell:R.jE,headerCellClass:c,cellClass:n=>{let t=n.__status;if("removed"===t)return"diff-cell-removed";if("added"===t)return"diff-cell-added";if("added"===l);else if("removed"===l);else if(!O().isEqual(n["base__".concat(e)],n["current__".concat(e)]))return"diff-cell-added"},renderCell:Z,columnType:r,columnRenderMode:o}]}};return n.forEach(e=>{var l;let r=null!=(l=m[e].status)?l:"",a=m[e].colType;h.push({key:e,name:(0,i.jsx)(ea,{name:e,columnStatus:r,primaryKeys:n,columnType:"unknown",...t}),frozen:!0,cellClass:e=>{if(e.__status)return"diff-header-".concat(e.__status)},renderCell:Z,columnType:a,columnRenderMode:u[e]})}),o.forEach(e=>{var t;let l=null!=(t=m[e].status)?t:"",r=m[e].colType;n.includes(e)||h.push(b(e,l,r,u[e]))}),Object.entries(m).forEach(e=>{var t;let[l,r]=e,i=null!=(t=r.status)?t:"";!("in_a"===l||"in_b"===l||n.includes(l)||o.includes(l))&&(c&&j.modified>0&&"added"!==i&&"removed"!==i&&"modified"!==i||h.push(b(l,i,r.colType,u[l])))}),{columns:h,rows:C}}var eo=t(7273);let ec=e=>{let{changedOnly:n,onChange:t}=e;return(0,i.jsxs)(eo.y8,{size:"xs",checked:n,onCheckedChange:()=>{t()},children:[(0,i.jsx)(eo.Ks,{}),(0,i.jsx)(eo.v7,{}),(0,i.jsx)(eo.Sb,{children:"Changed only"})]})},ed=(e,n)=>{var t,l,r,s,o,c,d;let{run:u,onAddToChecklist:h,viewOptions:m,onViewOptionsChanged:f,baseTitle:p,currentTitle:x}=e,g=(0,w.useMemo)(()=>{var e;return null!=(e=null==m?void 0:m.primary_keys)?e:[]},[m]),v=(0,w.useMemo)(()=>{var e;return null!=(e=null==m?void 0:m.changed_only)&&e},[m]),y=(0,w.useMemo)(()=>{var e;return null!=(e=null==m?void 0:m.pinned_columns)?e:[]},[m]),j=(0,w.useMemo)(()=>{var e;return null!=(e=null==m?void 0:m.display_mode)?e:"inline"},[m]),C=(0,w.useMemo)(()=>{var e;return null!=(e=null==m?void 0:m.columnsRenderMode)?e:{}},[m]),b=(0,w.useMemo)(()=>{var e,n;return Q(null==(e=u.result)?void 0:e.base,null==(n=u.result)?void 0:n.current,{changedOnly:v,primaryKeys:g,onPrimaryKeyChange:e=>{f&&f({...m,primary_keys:e})},pinnedColumns:y,onPinnedColumnsChange:e=>{f&&f({...m,pinned_columns:e})},columnsRenderMode:C,onColumnsRenderModeChanged:e=>{var n;let t={...null!=(n=null==m?void 0:m.columnsRenderMode)?n:{},...e};f&&f({...m,columnsRenderMode:t})},baseTitle:p,currentTitle:x,displayMode:j})},[u,m,v,g,y,j,f,p,x,C]),_=(0,w.useMemo)(()=>{let e=g.join(", ");return b.invalidPKeyBase&&b.invalidPKeyCurrent?"Warning: The primary key '".concat(e,"' is not unique in the base and current environments"):b.invalidPKeyBase?"Warning: The primary key '".concat(e,"' is not unique in the base environment"):b.invalidPKeyCurrent?"Warning: The primary key '".concat(e,"' is not unique in the current environment"):void 0},[b.invalidPKeyBase,b.invalidPKeyCurrent,g]),k=null!=(d=null==(l=u.result)||null==(t=l.current)?void 0:t.limit)?d:0,R=k>0&&((null==(s=u.result)||null==(r=s.current)?void 0:r.more)||(null==(c=u.result)||null==(o=c.base)?void 0:o.more))?"Warning: Displayed results are limited to ".concat(k.toLocaleString()," records. To ensure complete data retrieval, consider applying a LIMIT or WHERE clause to constrain the result set."):null,M=[];return(_&&M.push(_),R&&M.push(R),0===b.columns.length)?(0,i.jsx)(S.o,{height:"100%",children:"No data"}):(0,i.jsxs)(a.s,{direction:"column",backgroundColor:"rgb(249, 249, 249)",height:"100%",children:[(0,i.jsxs)(J,{run:u,viewOptions:m,onViewOptionsChanged:f,warnings:M,children:[(0,i.jsx)(ee,{displayMode:j,onDisplayModeChanged:e=>{f&&f({...m,display_mode:e})}}),(0,i.jsx)(ec,{changedOnly:null==m?void 0:m.changed_only,onChange:()=>{let e=!(null==m?void 0:m.changed_only);f&&f({...m,changed_only:e})}})]}),(0,i.jsx)(E.z,{ref:n,style:{blockSize:"auto",maxHeight:"100%",overflow:"auto"},columns:b.columns,rows:b.rows,renderers:{noRowsFallback:(0,i.jsx)(E.a,{emptyMessage:"No mismatched rows"})},defaultColumnOptions:{resizable:!0,maxWidth:800,minWidth:35},className:"rdg-light"})]})},eu=(e,n)=>{var t,l,r,s,o;let{run:c,viewOptions:d,onViewOptionsChanged:u,baseTitle:h,currentTitle:m}=e,f=(0,w.useMemo)(()=>{var e;return null!=(e=null==d?void 0:d.changed_only)&&e},[d]),p=(0,w.useMemo)(()=>{var e;return null!=(e=null==d?void 0:d.pinned_columns)?e:[]},[d]),x=(0,w.useMemo)(()=>{var e;return null!=(e=null==d?void 0:d.display_mode)?e:"inline"},[d]),g=(0,w.useMemo)(()=>{var e;return null!=(e=null==d?void 0:d.columnsRenderMode)?e:{}},[d]),v=(0,w.useMemo)(()=>{var e,n;if(!(null==(e=c.result)?void 0:e.diff)||!(null==(n=c.params)?void 0:n.primary_keys))return{columns:[],rows:[]};let t=c.params.primary_keys;return es(c.result.diff,t,{changedOnly:f,pinnedColumns:p,onPinnedColumnsChange:e=>{u&&u({...d,pinned_columns:e})},baseTitle:h,currentTitle:m,displayMode:x,columnsRenderMode:g,onColumnsRenderModeChanged:e=>{var n;let t={...null!=(n=null==d?void 0:d.columnsRenderMode)?n:{},...e};u&&u({...d,columnsRenderMode:t})}})},[c,d,f,p,x,u,h,m,g]),y=null!=(o=null==(l=c.result)||null==(t=l.diff)?void 0:t.limit)?o:0,j=y>0&&(null==(s=c.result)||null==(r=s.diff)?void 0:r.more)?"Warning: Displayed results are limited to ".concat(y.toLocaleString()," records. To ensure complete data retrieval, consider applying a LIMIT or WHERE clause to constrain the result set."):null,C=[];return(j&&C.push(j),0===v.columns.length)?(0,i.jsx)(S.o,{height:"100%",children:"No data"}):f&&0===v.rows.length?(0,i.jsxs)(a.s,{direction:"column",backgroundColor:"rgb(249, 249, 249)",height:"100%",children:[(0,i.jsx)(J,{run:c,viewOptions:d,onViewOptionsChanged:u,warnings:C}),(0,i.jsx)(S.o,{height:"100%",children:"No change"})]}):(0,i.jsxs)(a.s,{direction:"column",backgroundColor:"rgb(249, 249, 249)",height:"100%",children:[(0,i.jsxs)(J,{run:c,viewOptions:d,onViewOptionsChanged:u,warnings:C,children:[(0,i.jsx)(ee,{displayMode:x,onDisplayModeChanged:e=>{u&&u({...d,display_mode:e})}}),(0,i.jsx)(ec,{changedOnly:null==d?void 0:d.changed_only,onChange:()=>{let e=!(null==d?void 0:d.changed_only);u&&u({...d,changed_only:e})}})]}),(0,i.jsx)(E.z,{ref:n,style:{blockSize:"auto",maxHeight:"100%",overflow:"auto"},columns:v.columns,rows:v.rows,renderers:{noRowsFallback:(0,i.jsx)(E.a,{emptyMessage:"No mismatched rows"})},defaultColumnOptions:{resizable:!0,maxWidth:800,minWidth:35},className:"rdg-light"})]})},eh=(0,w.forwardRef)((e,n)=>{var t;let l,r;if(e.run.params&&e.run.params.current_model&&(l="Original",r="Editor"),(null==(t=e.run.result)?void 0:t.diff)!=null){let t=(0,w.forwardRef)(eu);return(0,i.jsx)(t,{...e,ref:n,baseTitle:l,currentTitle:r})}{let t=(0,w.forwardRef)(ed);return(0,i.jsx)(t,{...e,ref:n,baseTitle:l,currentTitle:r})}});var em=t(13900),ef=t(29018),ep=t.n(ef);let ex=(0,w.forwardRef)(function(e,n){var t,l;let{run:r}=e;function s(e){if(e.base===e.current);else if(e.base<e.current||"N/A"===e.base)return"column-body-added";else if(e.base>e.current||"N/A"===e.current)return"column-body-removed";return"column-body-normal"}let o=null!=(t=r.result)?t:{},c=Object.keys(null!=(l=r.result)?l:{}).map(e=>{let n=o[e],t=ep()(n.base)?n.base:null,l=ep()(n.curr)?n.curr:null,r="=";return null!==t&&null!==l?r=t!==l?(0,em.Q)(t,l):"=":t===l?r="N/A":null===t?r="Added":null===l&&(r="Removed"),{name:e,base:null===t?"N/A":Number(t),current:null===l?"N/A":Number(l),delta:r}});return 0===c.length?(0,i.jsx)(S.o,{bg:"rgb(249,249,249)",height:"100%",children:"No nodes matched"}):(0,i.jsx)(a.s,{direction:"column",children:Object.keys(o).length>0&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(E.z,{ref:n,style:{blockSize:"auto",maxHeight:"100%",overflow:"auto",fontSize:"10pt",borderWidth:1},columns:[{key:"name",name:"Name",cellClass:s},{key:"base",name:"Base Rows",cellClass:s},{key:"current",name:"Current Rows",cellClass:s},{key:"delta",name:"Delta",cellClass:s}],rows:c,renderers:{noRowsFallback:(0,i.jsx)(E.a,{})},className:"rdg-light"})})})}),eg=(0,w.forwardRef)(function(e,n){var t,l;let{run:r}=e,s=null!=(t=r.result)?t:{},o=Object.keys(null!=(l=r.result)?l:{}).map(e=>{let n=s[e],t=ep()(n.curr)?n.curr:null;return{name:e,current:null===t?"N/A":Number(t)}});return 0===o.length?(0,i.jsx)(S.o,{bg:"rgb(249,249,249)",height:"100%",children:"No nodes matched"}):(0,i.jsx)(a.s,{direction:"column",children:Object.keys(s).length>0&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(E.z,{ref:n,style:{blockSize:"auto",maxHeight:"100%",overflow:"auto",fontSize:"10pt",borderWidth:1},columns:[{key:"name",name:"Name"},{key:"current",name:"Row Count"}],rows:o,renderers:{noRowsFallback:(0,i.jsx)(E.a,{})},className:"rdg-light"})})})});var ev=t(97188),ey=t(69118),ej=t(50323),eC=t(45470),eb=t(57483),ew=t(28701),e_=t(41946);let ek="#63B3ED";function eS(e,n){let t=n?10:e.counts.length,l=e.counts.slice(0,t),r=e.valids-l.reduce((e,n)=>e+n,0);return e.values.slice(0,t).concat([r]).map((n,t)=>{var i;let a,s=t===l.length,o=s?r:l[t],c=!1;return s?(a="(others)",c=!0):null==n?(a="(null)",c=!0):"string"==typeof n&&0===n.length?(a="(empty)",c=!0):a=String(n),{isLastItemOthers:s,isSpecialLabel:c,label:a,count:o,displayCount:f(o),displayRatio:null!=(i=m(o/e.valids))?i:"N/A"}})}function eE(e){let{base:n,current:t,children:l}=e;return(0,i.jsx)(e_.m,{content:(0,i.jsxs)(c.a,{children:[(0,i.jsxs)(L.E,{children:[(0,i.jsx)(y,{color:p}),"Current: ",t.count," (",t.displayRatio,")"]}),(0,i.jsxs)(L.E,{children:[(0,i.jsx)(y,{color:x}),"Base: ",n.count," (",n.displayRatio,")"]})]}),showArrow:!0,children:l})}function eR(e){let{topKDiff:n,isDisplayTopTen:t}=e,l=eS(n.current,t),r=eS(n.base,t);return(0,i.jsxs)(c.a,{w:"100%",px:20,py:4,children:[(0,i.jsxs)(a.s,{alignItems:"center",direction:"row",children:[(0,i.jsx)(o.h,{}),(0,i.jsxs)(L.E,{as:"h3",fontSize:"sm",p:"2",color:"gray",children:[(0,i.jsx)(y,{color:x})," Base"]}),(0,i.jsxs)(L.E,{as:"h3",fontSize:"sm",p:"2",color:"gray",children:[(0,i.jsx)(y,{color:p})," Current"]}),(0,i.jsx)(o.h,{})]}),l.map((e,t)=>{let l=r[t];return e.isLastItemOthers&&0===e.count&&0===l.count?(0,i.jsx)(i.Fragment,{}):(0,i.jsxs)(w.Fragment,{children:[(0,i.jsx)(eE,{base:l,current:e,children:(0,i.jsxs)(a.s,{alignItems:"center",width:"100%",_hover:{bg:"blackAlpha.300"},px:4,children:[(0,i.jsx)(L.E,{lineClamp:1,width:"10em",fontSize:"sm",color:e.isSpecialLabel?"gray.400":"inherit",children:e.label}),(0,i.jsxs)(a.s,{width:"70%",direction:"column",children:[(0,i.jsxs)(a.s,{height:"1em",children:[(0,i.jsx)(eM,{topkCount:e.count,topkLabel:e.label,valids:n.current.valids,color:p}),(0,i.jsx)(L.E,{ml:5,mr:2,fontSize:"sm",width:"6em",children:e.displayCount}),(0,i.jsx)(L.E,{color:"gray.400",fontSize:"sm",width:"4em",children:e.displayRatio})]}),(0,i.jsxs)(a.s,{height:"1em",children:[(0,i.jsx)(eM,{topkCount:l.count,topkLabel:l.label,valids:n.base.valids,color:x}),(0,i.jsx)(L.E,{ml:5,mr:2,fontSize:"sm",width:"6em",children:l.displayCount}),(0,i.jsx)(L.E,{color:"gray.400",fontSize:"sm",width:"4em",children:l.displayRatio})]})]})]})}),(0,i.jsx)(ew.w,{})]},t)})]})}function eM(e){let{topkCount:n,topkLabel:t,valids:l,animation:r=!1,color:a=ek}=e;d.t1.register(d.PP,d.E8,d.kc);let s=function(e,n){let{...t}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{responsive:!0,maintainAspectRatio:!1,indexAxis:"y",scales:{x:{display:!1,max:n,grid:{display:!1}},y:{display:!1}},plugins:{tooltip:{enabled:!1}},...t}}(n,l,{animation:r}),o=function(e){let{topkLabel:n,topkCount:t,color:l=ek}=e;return{labels:[n],datasets:[{indexAxis:"y",data:[t],backgroundColor:l,hoverBackgroundColor:l,borderWidth:0,borderColor:l,barPercentage:1,categoryPercentage:.6}]}}({topkCount:n,topkLabel:t,color:a});return(0,i.jsx)(u.yP,{data:o,options:s,plugins:[]})}let eO=(0,w.forwardRef)((e,n)=>{let{run:t}=e,[l,r]=(0,w.useState)(!0),c=t.result,d=t.params,u=c.base,h=c.current;return(0,i.jsxs)(a.s,{direction:"column",height:"100%",children:[(0,i.jsxs)(_,{ref:n,blockSize:"auto",children:[(0,i.jsxs)(eC.D,{as:"h1",size:"md",paddingTop:4,textAlign:"center",color:"gray.600",children:["Model ",d.model,".",d.column_name]}),(0,i.jsxs)(s.z,{children:[(0,i.jsx)(o.h,{}),(0,i.jsx)(eR,{topKDiff:c,valids:h.valids||0,isDisplayTopTen:l}),(0,i.jsx)(o.h,{})]})]}),(0,i.jsx)(o.h,{}),(u.values.length>10||h.values.length>10)&&(0,i.jsx)(a.s,{p:5,justify:"start",children:(0,i.jsx)(eb.N,{onClick:()=>{r(e=>!e)},colorPalette:"blue",children:l?"View More Items":"View Only Top-10"})})]})}),eT=(0,w.forwardRef)((e,n)=>{var t,l,r;let{run:s,onAddToChecklist:o,viewOptions:c,onViewOptionsChanged:d}=e,u=(0,w.useMemo)(()=>{var e;return null!=(e=null==c?void 0:c.changed_only)&&e},[c]),h=(0,w.useMemo)(()=>{var e;return null!=(e=null==c?void 0:c.pinned_columns)?e:[]},[c]),m=(0,w.useMemo)(()=>{var e;return null!=(e=null==c?void 0:c.display_mode)?e:"inline"},[c]),f=(0,w.useMemo)(()=>{var e;return null!=(e=null==c?void 0:c.columnsRenderMode)?e:{}},[c]),p=(0,w.useMemo)(()=>{var e;if(!s.result||!(null==(e=s.params)?void 0:e.primary_key))return{columns:[],rows:[]};let n=s.params.primary_key,t=Array.isArray(n)?n:[n];return es(s.result,t,{changedOnly:u,pinnedColumns:h,onPinnedColumnsChange:e=>{d&&d({...c,pinned_columns:e})},columnsRenderMode:f,onColumnsRenderModeChanged:e=>{var n;let t={...null!=(n=null==c?void 0:c.columnsRenderMode)?n:{},...e};d&&d({...c,columnsRenderMode:t})},displayMode:m})},[s,c,u,h,m,d,f]),x=null!=(r=null==(t=s.result)?void 0:t.limit)?r:0,g=x>0&&(null==(l=s.result)?void 0:l.more)?"Warning: Displayed results are limited to ".concat(x.toLocaleString()," records. To ensure complete data retrieval, consider applying a LIMIT or WHERE clause to constrain the result set."):null,v=[];return(g&&v.push(g),0===p.columns.length)?(0,i.jsx)(S.o,{height:"100%",children:"No data"}):u&&0===p.rows.length?(0,i.jsxs)(a.s,{direction:"column",backgroundColor:"rgb(249, 249, 249)",height:"100%",children:[(0,i.jsx)(J,{run:s,viewOptions:c,onViewOptionsChanged:d,warnings:v}),(0,i.jsx)(S.o,{height:"100%",children:"No change"}),";"]}):(0,i.jsxs)(a.s,{direction:"column",backgroundColor:"rgb(249, 249, 249)",height:"100%",children:[(0,i.jsxs)(J,{run:s,viewOptions:c,onViewOptionsChanged:d,warnings:v,children:[(0,i.jsx)(ee,{displayMode:m,onDisplayModeChanged:e=>{d&&d({...c,display_mode:e})}}),(0,i.jsx)(ec,{changedOnly:null==c?void 0:c.changed_only,onChange:()=>{let e=!(null==c?void 0:c.changed_only);d&&d({...c,changed_only:e})}})]}),(0,i.jsx)(E.z,{ref:n,style:{blockSize:"auto",maxHeight:"100%",overflow:"auto"},columns:p.columns,rows:p.rows,renderers:{noRowsFallback:(0,i.jsx)(E.a,{emptyMessage:"No mismatched rows"})},defaultColumnOptions:{resizable:!0,maxWidth:800,minWidth:35},className:"rdg-light"})]})});var eI=t(97274),eA=t(36818);function eN(e){var n;let{params:t,onParamsChanged:l,setIsReadyToExecute:r}=e,[a,s]=(0,w.useState)(!t.columns||0===t.columns.length),o=t.model,d=t.primary_key,{columns:u,primaryKey:h,isLoading:m,error:f}=(0,ej.Ay)(t.model);(0,w.useEffect)(()=>{!d&&h&&l({...t,primary_key:h})},[d,h,t,l]),(0,w.useEffect)(()=>{r(!!d&&!!o)},[d,o,r]);let p=u.map(e=>e.name),x=Array.isArray(d)?d:d?[d]:void 0;return m?(0,i.jsx)(c.a,{children:"Loading..."}):0===p.length||f?(0,i.jsx)(c.a,{children:"Error: Please provide the 'catalog.json' to list column candidates"}):(0,i.jsxs)(q.T,{gap:5,m:"8px 24px",paddingBottom:"200px",children:[(0,i.jsxs)(ev.XO,{children:[(0,i.jsx)(ev.dh,{children:"Model"}),(0,i.jsx)(eI.p,{readOnly:!0,value:t.model})]}),(0,i.jsxs)(ev.XO,{children:[(0,i.jsx)(ev.dh,{children:"Primary key"}),(0,i.jsx)(eA.l6,{placeholder:"Select primary key",isMulti:!0,closeMenuOnSelect:!1,options:p.map(e=>({label:e,value:e})),value:(null!=x?x:[]).map(e=>({label:e,value:e})),onChange:e=>{l({...t,primary_key:1==e.length?e[0].value:e.map(e=>e.value)})}})]}),(0,i.jsxs)(ev.XO,{children:[(0,i.jsx)(ev.dh,{children:"Columns"}),(0,i.jsxs)(eo.y8,{marginBottom:"10px",size:"xs",checked:a,onCheckedChange:e=>{s(!!e.checked),l({...t,columns:void 0})},children:[(0,i.jsx)(eo.Ks,{}),(0,i.jsx)(eo.v7,{}),(0,i.jsx)(eo.Sb,{children:"All columns"})]}),!a&&(0,i.jsx)(eA.l6,{isMulti:!0,closeMenuOnSelect:!1,options:p.map(e=>({label:e,value:e})),value:(null!=(n=t.columns)?n:[]).map(e=>({label:e,value:e})),onChange:e=>{let n,r=e.map(e=>e.value);n=0===r.length?void 0:r,l({...t,columns:n})}})]})]})}var eL=t(97887),eF=t(43094);function eV(e){let{params:n,column:t}=e,{runAction:l}=(0,eL.tr)(),{featureToggles:r}=(0,eF.c)(),s=(e,t)=>{l("value_diff_detail",{...n,...e},t)};return(0,i.jsxs)(a.s,{children:[(0,i.jsx)(c.a,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:t}),(0,i.jsx)(o.h,{}),(0,i.jsxs)(I.il,{lazyMount:!0,children:[(0,i.jsx)(I.cQ,{asChild:!0,children:(0,i.jsx)(A.K,{className:"row-context-menu",variant:"plain",size:"sm",disabled:r.disableDatabaseQuery,children:(0,i.jsx)(H.Q7K,{})})}),(0,i.jsx)(N.Z,{children:(0,i.jsx)(I.y3,{children:(0,i.jsx)(I.rm,{lineHeight:"20px",children:(0,i.jsxs)(I.Uh,{title:"Action",as:c.a,fontSize:"8pt",children:[(0,i.jsx)(I.Dr,{value:"show-mismatched-values",fontSize:"10pt",onClick:()=>{s({},{showForm:!0})},children:"Show mismatched values..."}),(0,i.jsxs)(I.Dr,{value:"show-mismatched-columns",fontSize:"10pt",onClick:()=>{s({columns:[t]},{showForm:!1})},children:["Show mismatched values for '",t,"'"]})]})})})})]})]})}let ez=(0,w.forwardRef)(function(e,n){let{run:t}=e,l=t.result,r=t.params,s=e=>{let n=e[2];return null!=n&&n<1?"diff-cell-modified":""},o=Array.isArray(r.primary_key)?r.primary_key:[r.primary_key],d=[{key:"__is_pk__",name:"",width:30,maxWidth:30,renderCell:e=>{let{row:n}=e;return(0,i.jsx)(S.o,{height:"100%",children:o.includes(String(n[0]))&&(0,i.jsx)(T.I,{as:F.IuQ})})}},{key:"0",name:"Column",resizable:!0,renderCell:e=>{let{row:n,column:t}=e;return(0,i.jsx)(eV,{column:String(n[t.key]),params:r})},cellClass:"cell-show-context-menu"},{key:"1",name:"Matched",resizable:!0,cellClass:s},{key:"2",name:"Matched %",resizable:!0,renderCell:e=>{let{column:n,row:t}=e,l=t[n.key];return(0,i.jsx)(c.a,{textAlign:"end",children:null!=l?"".concat((100*l).toFixed(2)," %"):"N/A"})},cellClass:s}];return(0,i.jsxs)(a.s,{direction:"column",gap:"5px",pt:"5px",height:"100%",children:[(0,i.jsxs)(c.a,{px:"16px",children:["Model: ",r.model,", ",l.summary.total," total (",l.summary.total-l.summary.added-l.summary.removed," common,"," ",l.summary.added," added, ",l.summary.removed," removed)"]}),(0,i.jsx)(E.z,{ref:n,style:{blockSize:"auto",maxHeight:"100%",overflow:"auto",borderBlock:"1px solid lightgray"},columns:d,rows:l.data.data,renderers:{noRowsFallback:(0,i.jsx)(E.a,{})},defaultColumnOptions:{resizable:!0},className:"rdg-light"})]})});var eH=t(37630),eP=t(3664);function eD(e){var n;let{params:t,onParamsChanged:l,setIsReadyToExecute:r}=e,[a,s]=(0,w.useState)(!t.columns||0===t.columns.length),o=t.model,{columns:d,isLoading:u,error:h}=(0,ej.Ay)(t.model);(0,w.useEffect)(()=>{r(!!o)},[o,r]);let m=d.map(e=>e.name);return u?(0,i.jsx)(c.a,{children:"Loading..."}):0===m.length||h?(0,i.jsx)(c.a,{children:"Error: Please provide the 'catalog.json' to list column candidates"}):(0,i.jsxs)(q.T,{gap:5,m:"8px 24px",paddingBottom:"200px",children:[(0,i.jsxs)(ev.XO,{children:[(0,i.jsx)(ev.dh,{children:"Model"}),(0,i.jsx)(eI.p,{readOnly:!0,value:t.model})]}),(0,i.jsxs)(ev.XO,{children:[(0,i.jsx)(ev.dh,{children:"Columns"}),(0,i.jsxs)(eo.y8,{marginBottom:"10px",checked:a,onCheckedChange:e=>{s(!!e.checked),l({...t,columns:void 0})},children:[(0,i.jsx)(eo.Ks,{}),(0,i.jsx)(eo.v7,{}),(0,i.jsx)(eo.Sb,{children:"All columns"})]}),!a&&(0,i.jsx)(eA.l6,{isMulti:!0,closeMenuOnSelect:!1,options:m.map(e=>({label:e,value:e})),value:(null!=(n=t.columns)?n:[]).map(e=>({label:e,value:e})),onChange:e=>{let n,r=e.map(e=>e.value);n=0===r.length?void 0:r,l({...t,columns:n})}})]})]})}let eK={lineage_diff:{title:"Lineage Diff",icon:l.RN4},schema_diff:{title:"Schema Diff",icon:eP.Hsw},query:{title:"Query",icon:l.RY4,RunResultView:el},query_base:{title:"Query Base",icon:l.RY4,RunResultView:el},query_diff:{title:"Query Diff",icon:l.RY4,RunResultView:eh},row_count:{title:"Row Count",icon:eP.xj_,RunResultView:eg},row_count_diff:{title:"Row Count Diff",icon:eP.xj_,RunResultView:ex},profile:{title:"Profile",icon:l.W4V,RunResultView:ei,RunForm:eD},profile_diff:{title:"Profile Diff",icon:l.W4V,RunResultView:er,RunForm:eD},value_diff:{title:"Value Diff",icon:l.z76,RunResultView:ez,RunForm:eN},value_diff_detail:{title:"Value Diff Detail",icon:l.z76,RunResultView:eT,RunForm:eN},top_k_diff:{title:"Top-K Diff",icon:eH.J3A,RunResultView:eO,RunForm:function(e){let{params:n,onParamsChanged:t,setIsReadyToExecute:l}=e,{columns:r,isLoading:a,error:s}=(0,ej.Ay)(n.model),o=r.map(e=>e.name);return((0,w.useEffect)(()=>{l(!!n.column_name)},[n,l]),a)?(0,i.jsx)(c.a,{children:"Loading..."}):0===o.length||s?(0,i.jsx)(c.a,{children:"Error: Please provide the 'catalog.json' to list column candidates"}):(0,i.jsx)(c.a,{m:"16px",children:(0,i.jsxs)(ev.XO,{children:[(0,i.jsx)(ev.dh,{children:"Pick a column to show top-k"}),(0,i.jsx)(ey.MQ,{children:(0,i.jsx)(ey.uT,{placeholder:"Select column",value:n.column_name,onChange:e=>{let l=e.target.value;t({...n,column_name:l})},children:o.map(e=>(0,i.jsx)("option",{value:e,children:e},e))})})]})})}},histogram_diff:{title:"Histogram Diff",icon:l.JKR,RunResultView:k,RunForm:r.y},sandbox:{title:"Sandbox",icon:l.wtR}},eB=e=>eK[e]}}]);