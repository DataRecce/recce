(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,62027,e=>{"use strict";let t;var r,n=e.i(24627),a=e.i(24419),o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function s(e,t,r,n){return new(r||(r=Promise))(function(a,o){function i(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(i,s)}c((n=n.apply(e,t||[])).next())})}function c(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){var u=[s,c];if(r)throw TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(i=0)),i;)try{if(r=1,n&&(a=2&u[0]?n.return:u[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,u[1])).done)return a;switch(n=0,a&&(u=[2&u[0],a.value]),u[0]){case 0:case 1:a=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,n=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===u[0]||2===u[0])){i=0;continue}if(3===u[0]&&(!a||u[1]>a[0]&&u[1]<a[3])){i.label=u[1];break}if(6===u[0]&&i.label<a[1]){i.label=a[1],a=u;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(u);break}a[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],n=0}finally{r=a=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}}function u(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}"function"==typeof SuppressedError&&SuppressedError;var l="is not",f="contains",h="does not contain",p="less",v="less or equal",d="greater",y="greater or equal",g="version less",m="version less or equal",b="version greater",x="version greater or equal",w="set is",_="set is not",S="set contains",A="set does not contain",C="set contains any",T="set does not contain any",E=function(e){for(var t=[],r=0,n=0;n<e.length;n++){var a=e.charCodeAt(n);a<128?t[r++]=a:(a<2048?t[r++]=a>>6|192:((64512&a)==55296&&n+1<e.length&&(64512&e.charCodeAt(n+1))==56320?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++n)),t[r++]=a>>18|240,t[r++]=a>>12&63|128):t[r++]=a>>12|224,t[r++]=a>>6&63|128),t[r++]=63&a|128)}return Uint8Array.from(t)},F=function(e,t){void 0===t&&(t=0);for(var r=E(e),n=r.length,a=n>>2,o=t,i=0;i<a;i++)o=O(B(r,i<<2),o);var s=a<<2,c=0;switch(n-s){case 3:c^=r[s+2]<<16,c^=r[s+1]<<8,c^=r[s],o^=c=Math.imul(c=N(c=Math.imul(c,-0x3361d2af),15),0x1b873593);break;case 2:c^=r[s+1]<<8,c^=r[s],o^=c=Math.imul(c=N(c=Math.imul(c,-0x3361d2af),15),0x1b873593);break;case 1:c^=r[s],o^=c=Math.imul(c=N(c=Math.imul(c,-0x3361d2af),15),0x1b873593)}return k(o^=n)>>>0},O=function(e,t){var r=e,n=t;return n^=r=Math.imul(r=N(r=Math.imul(r,-0x3361d2af),15),0x1b873593),(n=Math.imul(n=N(n,13),5))+-0x19ab949c|0},k=function(e){var t=e;return t^=t>>>16,t=Math.imul(t,-0x7a143595),t^=t>>>13,t=Math.imul(t,-0x3d4d51cb),t^=t>>>16},N=function(e,t,r){void 0===r&&(r=32),t>r&&(t%=r);var n=(e&0xffffffff<<r-t>>>0)>>>0>>>r-t>>>0;return(e<<t|n)>>>0},B=function(e,t){return void 0===t&&(t=0),I(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])},I=function(e){return(-0x1000000&e)>>>24|(0xff0000&e)>>>8|(65280&e)<<8|(255&e)<<24},j=function(e,t){var r,n;if(t&&0!==t.length){try{for(var a=u(t),o=a.next();!o.done;o=a.next()){var i=o.value;if(!i||!e||"object"!=typeof e)return;e=e[i]}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}if(!e)return;return e}},R="^".concat("(\\d+)\\.(\\d+)","(\\.").concat("(\\d+)").concat("(-(([-\\w]+\\.?)*))?",")?$"),M=function(){function e(e,t,r,n){void 0===n&&(n=void 0),this.major=e,this.minor=t,this.patch=r,this.preRelease=n}return e.parse=function(t){if(t){var r=new RegExp(R).exec(t);if(r){var n=Number(r[1]),a=Number(r[2]);if(!(isNaN(n)||isNaN(a)))return new e(n,a,Number(r[4])||0,r[5]||void 0)}}},e.prototype.compareTo=function(e){if(this.major>e.major)return 1;if(this.major<e.major)return -1;if(this.minor>e.minor)return 1;if(this.minor<e.minor)return -1;if(this.patch>e.patch)return 1;if(this.patch<e.patch||this.preRelease&&!e.preRelease)return -1;if(!this.preRelease&&e.preRelease)return 1;if(this.preRelease&&e.preRelease){if(this.preRelease>e.preRelease)return 1;if(this.preRelease<e.preRelease)return -1}return 0},e}(),P=function(){function e(){}return e.prototype.evaluate=function(e,t){var r,n,a={},o={context:e,result:a};try{for(var i=u(t),s=i.next();!s.done;s=i.next()){var c=s.value,l=this.evaluateFlag(o,c);l&&(a[c.key]=l)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},e.prototype.evaluateFlag=function(e,t){try{for(var r,n,a,o=u(t.segments),s=o.next();!s.done;s=o.next()){var c=s.value;if(a=this.evaluateSegment(e,t,c)){var l=i(i(i({},t.metadata),c.metadata),a.metadata);a=i(i({},a),{metadata:l});break}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a},e.prototype.evaluateSegment=function(e,t,r){var n,a,o,i;if(!r.conditions){var s=this.bucket(e,r);return void 0!==s?t.variants[s]:void 0}try{for(var c=u(r.conditions),l=c.next();!l.done;l=c.next()){var f=l.value,h=!0;try{for(var p=(o=void 0,u(f)),v=p.next();!v.done;v=p.next()){var d=v.value;if(!(h=this.matchCondition(e,d)))break}}catch(e){o={error:e}}finally{try{v&&!v.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}if(h){var s=this.bucket(e,r);if(void 0!==s)return t.variants[s];return}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}},e.prototype.matchCondition=function(e,t){var r=j(e,t.selector);if(!r)return this.matchNull(t.op,t.values);if(this.isSetOperator(t.op)){var n=this.coerceStringArray(r);return!!n&&this.matchSet(n,t.op,t.values)}var a=this.coerceString(r);return void 0!==a&&this.matchString(a,t.op,t.values)},e.prototype.getHash=function(e){return F(e)},e.prototype.bucket=function(e,t){if(!t.bucket)return t.variant;var r,n,a,o,i=this.coerceString(j(e,t.bucket.selector));if(!i||0===i.length)return t.variant;var s="".concat(t.bucket.salt,"/").concat(i),c=this.getHash(s),l=c%100,f=Math.floor(c/100);try{for(var h=u(t.bucket.allocations),p=h.next();!p.done;p=h.next()){var v=p.value,d=v.range[0],y=v.range[1];if(l>=d&&l<y)try{for(var g=(a=void 0,u(v.distributions)),m=g.next();!m.done;m=g.next()){var b=m.value,x=b.range[0],w=b.range[1];if(f>=x&&f<w)return b.variant}}catch(e){a={error:e}}finally{try{m&&!m.done&&(o=g.return)&&o.call(g)}finally{if(a)throw a.error}}}}catch(e){r={error:e}}finally{try{p&&!p.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}return t.variant},e.prototype.matchNull=function(e,t){var r=this.containsNone(t);switch(e){case"is":case f:case p:case v:case d:case y:case g:case m:case b:case x:case w:case S:case C:return r;case l:case h:case A:case T:return!r;default:return!1}},e.prototype.matchSet=function(e,t,r){switch(t){case w:return this.setEquals(e,r);case _:return!this.setEquals(e,r);case S:return this.matchesSetContainsAll(e,r);case A:return!this.matchesSetContainsAll(e,r);case C:return this.matchesSetContainsAny(e,r);case T:return!this.matchesSetContainsAny(e,r);default:return!1}},e.prototype.matchString=function(e,t,r){var n=this;switch(t){case"is":return this.matchesIs(e,r);case l:return!this.matchesIs(e,r);case f:return this.matchesContains(e,r);case h:return!this.matchesContains(e,r);case p:case v:case d:case y:return this.matchesComparable(e,t,r,function(e){return n.parseNumber(e)},this.comparator);case g:case m:case b:case x:return this.matchesComparable(e,t,r,function(e){return M.parse(e)},this.versionComparator);case"regex match":return this.matchesRegex(e,r);case"regex does not match":return!this.matchesRegex(e,r);default:return!1}},e.prototype.matchesIs=function(e,t){if(this.containsBooleans(t)){var r=e.toLowerCase();if("true"===r||"false"===r)return t.some(function(e){return e.toLowerCase()===r})}return t.some(function(t){return e===t})},e.prototype.matchesContains=function(e,t){var r,n;try{for(var a=u(t),o=a.next();!o.done;o=a.next()){var i=o.value;if(e.toLowerCase().includes(i.toLowerCase()))return!0}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return!1},e.prototype.matchesComparable=function(e,t,r,n,a){var o=this,i=n(e),s=r.map(function(e){return n(e)}).filter(function(e){return void 0!==e});return void 0===i||0===s.length?r.some(function(r){return o.comparator(e,t,r)}):s.some(function(e){return a(i,t,e)})},e.prototype.comparator=function(e,t,r){switch(t){case p:case g:return e<r;case v:case m:return e<=r;case d:case b:return e>r;case y:case x:return e>=r;default:return!1}},e.prototype.versionComparator=function(e,t,r){var n=e.compareTo(r);switch(t){case p:case g:return n<0;case v:case m:return n<=0;case d:case b:return n>0;case y:case x:return n>=0;default:return!1}},e.prototype.matchesRegex=function(e,t){return t.some(function(t){return!!new RegExp(t).exec(e)})},e.prototype.containsNone=function(e){return e.some(function(e){return"(none)"===e})},e.prototype.containsBooleans=function(e){return e.some(function(e){switch(e.toLowerCase()){case"true":case"false":return!0;default:return!1}})},e.prototype.parseNumber=function(e){var t;return null!=(t=Number(e))?t:void 0},e.prototype.coerceString=function(e){if(e)return"object"==typeof e?JSON.stringify(e):String(e)},e.prototype.coerceStringArray=function(e){var t=this;if(Array.isArray(e)){var r=e;return r.map(function(e){return t.coerceString(e)}).filter(Boolean)}var n=String(e);try{var a=JSON.parse(n);if(!Array.isArray(a))return;var r=e;return r.map(function(e){return t.coerceString(e)}).filter(Boolean)}catch(e){return}},e.prototype.isSetOperator=function(e){switch(e){case w:case _:case S:case A:case C:case T:return!0;default:return!1}},e.prototype.setEquals=function(e,t){var r=new Set(e),n=new Set(t);return r.size===n.size&&(function(e,t,r){if(r||2==arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))})([],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,o=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(a)throw a.error}}return i}(n),!1).every(function(e){return r.has(e)})},e.prototype.matchesSetContainsAll=function(e,t){var r,n;if(e.length<t.length)return!1;try{for(var a=u(t),o=a.next();!o.done;o=a.next()){var i=o.value;if(!this.matchesIs(i,e))return!1}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return!0},e.prototype.matchesSetContainsAny=function(e,t){var r,n;try{for(var a=u(t),o=a.next();!o.done;o=a.next()){var i=o.value;if(this.matchesIs(i,e))return!0}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return!1},e}();let K="function"==typeof atob,U="function"==typeof btoa,q="function"==typeof a.Buffer,D="function"==typeof TextDecoder?new TextDecoder:void 0,z="function"==typeof TextEncoder?new TextEncoder:void 0,L=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),J=(t={},L.forEach((e,r)=>t[e]=r),t),X=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Z=String.fromCharCode.bind(String),G="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),V=e=>e.replace(/=/g,"").replace(/[+\/]/g,e=>"+"==e?"-":"_"),H=U?e=>btoa(e):q?e=>a.Buffer.from(e,"binary").toString("base64"):e=>{let t,r,n,a,o="",i=e.length%3;for(let i=0;i<e.length;){if((r=e.charCodeAt(i++))>255||(n=e.charCodeAt(i++))>255||(a=e.charCodeAt(i++))>255)throw TypeError("invalid character found");o+=L[(t=r<<16|n<<8|a)>>18&63]+L[t>>12&63]+L[t>>6&63]+L[63&t]}return i?o.slice(0,i-3)+"===".substring(i):o},$=q?e=>a.Buffer.from(e).toString("base64"):e=>{let t=[];for(let r=0,n=e.length;r<n;r+=4096)t.push(Z.apply(null,e.subarray(r,r+4096)));return H(t.join(""))},Q=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?Z(192|t>>>6)+Z(128|63&t):Z(224|t>>>12&15)+Z(128|t>>>6&63)+Z(128|63&t)}var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return Z(240|t>>>18&7)+Z(128|t>>>12&63)+Z(128|t>>>6&63)+Z(128|63&t)},W=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Y=q?e=>a.Buffer.from(e,"utf8").toString("base64"):z?e=>$(z.encode(e)):e=>H(e.replace(W,Q)),ee=(e,t=!1)=>t?V(Y(e)):Y(e),et=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,er=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return Z((t>>>10)+55296)+Z((1023&t)+56320);case 3:return Z((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return Z((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},en=K?e=>atob(e.replace(/[^A-Za-z0-9\+\/]/g,"")):q?e=>a.Buffer.from(e,"base64").toString("binary"):e=>{if(e=e.replace(/\s+/g,""),!X.test(e))throw TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,r="",n,a;for(let o=0;o<e.length;)t=J[e.charAt(o++)]<<18|J[e.charAt(o++)]<<12|(n=J[e.charAt(o++)])<<6|(a=J[e.charAt(o++)]),r+=64===n?Z(t>>16&255):64===a?Z(t>>16&255,t>>8&255):Z(t>>16&255,t>>8&255,255&t);return r},ea=q?e=>G(a.Buffer.from(e,"base64")):e=>G(en(e).split("").map(e=>e.charCodeAt(0))),eo=q?e=>a.Buffer.from(e,"base64").toString("utf8"):D?e=>D.decode(ea(e)):e=>en(e).replace(et,er);var ei=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=r}function r(t,n){var a=e.call(this,n)||this;return a.statusCode=t,Object.setPrototypeOf(a,r.prototype),a}return o(r,e),r.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t),r}(Error);(function(e,t,r){this.deploymentKey=e,this.serverUrl=t,this.httpClient=r}).prototype.getVariants=function(e,t){return s(this,void 0,void 0,function(){var r,n,a;return c(this,function(o){switch(o.label){case 0:return r=ee(JSON.stringify(e),!0),n={Authorization:"Api-Key ".concat(this.deploymentKey),"X-Amp-Exp-User":r},(null==t?void 0:t.flagKeys)&&(n["X-Amp-Exp-Flag-Keys"]=ee(JSON.stringify(t.flagKeys),!0)),(null==t?void 0:t.trackingOption)&&(n["X-Amp-Exp-Track"]=t.trackingOption),[4,this.httpClient.request({requestUrl:"".concat(this.serverUrl,"/sdk/v2/vardata?v=0"),method:"GET",headers:n,timeoutMillis:null==t?void 0:t.timeoutMillis})];case 1:if(200!=(a=o.sent()).status)throw new ei(a.status,"Fetch error response: status=".concat(a.status));return[2,JSON.parse(a.body)]}})})},(function(e,t,r){this.deploymentKey=e,this.serverUrl=t,this.httpClient=r}).prototype.getFlags=function(e){return s(this,void 0,void 0,function(){var t,r;return c(this,function(n){switch(n.label){case 0:return t={Authorization:"Api-Key ".concat(this.deploymentKey)},(null==e?void 0:e.libraryName)&&(null==e?void 0:e.libraryVersion)&&(t["X-Amp-Exp-Library"]="".concat(e.libraryName,"/").concat(e.libraryVersion)),[4,this.httpClient.request({requestUrl:"".concat(this.serverUrl,"/sdk/v2/flags"),method:"GET",headers:t,timeoutMillis:null==e?void 0:e.timeoutMillis})];case 1:if(200!=(r=n.sent()).status)throw Error("Flags error response: status=".concat(r.status));return[2,JSON.parse(r.body).reduce(function(e,t){return e[t.key]=t,e},{})]}})})};var es="undefined"!=typeof globalThis?globalThis:e.g||self;function ec(e,t){this.poller=void 0,this.action=e,this.ms=t}ec.prototype.start=function(){this.poller||(this.poller=es.setInterval(this.action,this.ms),this.action())},ec.prototype.stop=function(){this.poller&&(es.clearInterval(this.poller),this.poller=void 0)};var eu=e.i(1217),el=new function(){var e=this;this.dbs={},this.createStore=function(t){return(0,n.__awaiter)(e,void 0,void 0,function(){return(0,n.__generator)(this,function(e){switch(e.label){case 0:return[4,(0,eu.openDB)(t,1,{upgrade:function(e){e.objectStoreNames.contains("eventTypesForSession")||e.createObjectStore("eventTypesForSession",{keyPath:"sessionId"})}})];case 1:return[2,e.sent()]}})})},this.openOrCreateDB=function(t){return(0,n.__awaiter)(e,void 0,void 0,function(){var e,r;return(0,n.__generator)(this,function(n){switch(n.label){case 0:if(this.dbs&&this.dbs[t])return[2,this.dbs[t]];return e="".concat(t.substring(0,10),"_amp_targeting"),[4,this.createStore(e)];case 1:return r=n.sent(),this.dbs[t]=r,[2,r]}})})},this.updateEventListForSession=function(t){var r=t.sessionId,a=t.eventType,o=t.eventTime,i=t.loggerProvider,s=t.tx;return(0,n.__awaiter)(e,void 0,void 0,function(){var e,t,c,u,l,f,h;return(0,n.__generator)(this,function(p){switch(p.label){case 0:return p.trys.push([0,3,,4]),[4,s.store.get(r)];case 1:return c=(t=(e=p.sent())?e.eventTypes:{})[a]||{},u=(0,n.__assign)((0,n.__assign)({},t),((f={})[a]=(0,n.__assign)((0,n.__assign)({},c),((h={})[o]={event_type:a},h)),f)),[4,s.store.put({sessionId:r,eventTypes:u})];case 2:return p.sent(),[2,u];case 3:return l=p.sent(),i.warn("Failed to store events for targeting ".concat(r,": ").concat(l)),[3,4];case 4:return[2,void 0]}})})},this.deleteOldSessionEventTypes=function(t){var r=t.currentSessionId,a=t.loggerProvider,o=t.tx;return(0,n.__awaiter)(e,void 0,void 0,function(){var e,t,i,s,c;return(0,n.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,6,,7]),[4,o.store.getAll()];case 1:e=n.sent(),t=0,n.label=2;case 2:if(!(t<e.length))return[3,5];if(i=e[t],s=Date.now()-i.sessionId,!(i.sessionId!==r&&s>1728e5))return[3,4];return[4,o.store.delete(i.sessionId)];case 3:n.sent(),n.label=4;case 4:return t++,[3,2];case 5:return[3,7];case 6:return c=n.sent(),a.warn("Failed to clear old session events for targeting: ".concat(c)),[3,7];case 7:return[2]}})})},this.storeEventTypeForSession=function(t){var r=t.loggerProvider,a=t.sessionId,o=t.eventType,i=t.eventTime,s=t.apiKey;return(0,n.__awaiter)(e,void 0,void 0,function(){var e,t,c;return(0,n.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),[4,this.openOrCreateDB(s)];case 1:if(!(e=n.sent().transaction("eventTypesForSession","readwrite")))return[2];return[4,this.updateEventListForSession({sessionId:a,tx:e,loggerProvider:r,eventType:o,eventTime:i})];case 2:return t=n.sent(),[4,this.deleteOldSessionEventTypes({currentSessionId:a,tx:e,loggerProvider:r})];case 3:return n.sent(),[4,e.done];case 4:return n.sent(),[2,t];case 5:return c=n.sent(),r.warn("Failed to store events for targeting ".concat(a,": ").concat(c)),[3,6];case 6:return[2,void 0]}})})}},ef={evaluateTargeting:(r=new function(){var e=this;this.evaluateTargeting=function(t){var r=t.apiKey,a=t.loggerProvider,o=t.event,i=t.sessionId,s=t.userProperties,c=t.deviceId,u=t.flag;return(0,n.__awaiter)(e,void 0,void 0,function(){var e,t,l,f;return(0,n.__generator)(this,function(n){switch(n.label){case 0:if(!(o&&o.time))return[3,2];return[4,el.storeEventTypeForSession({loggerProvider:a,apiKey:r,sessionId:i,eventType:o.event_type,eventTime:o.time})];case 1:return t=n.sent(),[3,3];case 2:t=void 0,n.label=3;case 3:return f={session_id:i,event:o,event_types:(l=(e=t)&&new Set(Object.keys(e)))&&Array.from(l),user:{device_id:c,user_properties:s}},[2,this.evaluationEngine.evaluate(f,[u])]}})})},this.evaluationEngine=new P}).evaluateTargeting.bind(r)}.evaluateTargeting;e.s(["evaluateTargeting",()=>ef],62027)}]);