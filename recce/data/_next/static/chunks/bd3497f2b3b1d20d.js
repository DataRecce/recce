(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,158180,(e,t,n)=>{"use strict";var o=e.r(277078),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},r=o.useState,a=o.useEffect,s=o.useLayoutEffect,l=o.useDebugValue;function d(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(e){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),o=r({inst:{value:n,getSnapshot:t}}),i=o[0].inst,c=o[1];return s(function(){i.value=n,i.getSnapshot=t,d(i)&&c({inst:i})},[e,n,t]),a(function(){return d(i)&&c({inst:i}),e(function(){d(i)&&c({inst:i})})},[e]),l(n),n};n.useSyncExternalStore=void 0!==o.useSyncExternalStore?o.useSyncExternalStore:c},765472,(e,t,n)=>{"use strict";t.exports=e.r(158180)},587934,(e,t,n)=>{"use strict";var o=e.r(277078),i=e.r(765472),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=i.useSyncExternalStore,s=o.useRef,l=o.useEffect,d=o.useMemo,c=o.useDebugValue;n.useSyncExternalStoreWithSelector=function(e,t,n,o,i){var u=s(null);if(null===u.current){var g={hasValue:!1,value:null};u.current=g}else g=u.current;var h=a(e,(u=d(function(){function e(e){if(!l){if(l=!0,a=e,e=o(e),void 0!==i&&g.hasValue){var t=g.value;if(i(t,e))return s=t}return s=e}if(t=s,r(a,e))return t;var n=o(e);return void 0!==i&&i(t,n)?(a=e,t):(a=e,s=n)}var a,s,l=!1,d=void 0===n?null:n;return[function(){return e(t())},null===d?void 0:function(){return e(d())}]},[t,n,o,i]))[0],u[1]);return l(function(){g.hasValue=!0,g.value=h},[h]),c(h),h}},234214,(e,t,n)=>{"use strict";t.exports=e.r(587934)},785546,407275,953131,323194,987923,2216,187726,525519,248859,88515,166598,904451,632951,676502,163669,636819,592355,832421,739145,428537,224779,e=>{"use strict";e.i(990477);var t,n,o=e.i(209482),i=e.i(277078);function r(e){if("string"==typeof e||"number"==typeof e)return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)""!==(o=r(e[n]))&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var a=e.i(280998),s=e.i(234214);let l={get url(){return`file://${e.P("node_modules/.pnpm/zustand@4.5.7_@types+react@19.2.7_react@19.2.1/node_modules/zustand/esm/vanilla.mjs")}`}},d=e=>{let t,n=new Set,o=(e,o)=>{let i="function"==typeof e?e(t):e;if(!Object.is(i,t)){let e=t;t=(null!=o?o:"object"!=typeof i||null===i)?i:Object.assign({},t,i),n.forEach(n=>n(t,e))}},i=()=>t,r={setState:o,getState:i,getInitialState:()=>a,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{(l.env?l.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},a=t=e(o,i,r);return r},{useDebugValue:c}=i.default,{useSyncExternalStoreWithSelector:u}=s.default,g=e=>e;function h(e,t=g,n){let o=u(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return c(o),o}let p=(e,t)=>{let n=e?d(e):d,o=(e,o=t)=>h(n,e,o);return Object.assign(o,n),o};function f(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[n,o]of e)if(!Object.is(o,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}let n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}e.i(923081);let m=(0,i.createContext)(null),x=m.Provider,y=a.errorMessages.error001();function b(e,t){let n=(0,i.useContext)(m);if(null===n)throw Error(y);return h(n,e,t)}function w(){let e=(0,i.useContext)(m);if(null===e)throw Error(y);return(0,i.useMemo)(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}let v={display:"none"},j={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},C="react-flow__node-desc",S="react-flow__edge-desc",k=e=>e.ariaLiveMessage,_=e=>e.ariaLabelConfig;function R({rfId:e}){let t=b(k);return(0,o.jsx)("div",{id:`react-flow__aria-live-${e}`,"aria-live":"assertive","aria-atomic":"true",style:j,children:t})}function M({rfId:e,disableKeyboardA11y:t}){let n=b(_);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{id:`${C}-${e}`,style:v,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),(0,o.jsx)("div",{id:`${S}-${e}`,style:v,children:n["edge.a11yDescription.default"]}),!t&&(0,o.jsx)(R,{rfId:e})]})}let I=(0,i.forwardRef)(({position:e="top-left",children:t,className:n,style:i,...a},s)=>{let l=`${e}`.split("-");return(0,o.jsx)("div",{className:r(["react-flow__panel",n,...l]),style:i,ref:s,...a,children:t})});function E({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:(0,o.jsx)(I,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:(0,o.jsx)("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}I.displayName="Panel";let N=e=>{let t=[],n=[];for(let[,n]of e.nodeLookup)n.selected&&t.push(n.internals.userNode);for(let[,t]of e.edgeLookup)t.selected&&n.push(t);return{selectedNodes:t,selectedEdges:n}},D=e=>e.id;function T(e,t){return f(e.selectedNodes.map(D),t.selectedNodes.map(D))&&f(e.selectedEdges.map(D),t.selectedEdges.map(D))}function P({onSelectionChange:e}){let t=w(),{selectedNodes:n,selectedEdges:o}=b(N,T);return(0,i.useEffect)(()=>{let i={nodes:n,edges:o};e?.(i),t.getState().onSelectionChangeHandlers.forEach(e=>e(i))},[n,o,e]),null}let L=e=>!!e.onSelectionChangeHandlers;function z({onSelectionChange:e}){let t=b(L);return e||t?(0,o.jsx)(P,{onSelectionChange:e}):null}let B=[0,0],A={x:0,y:0,zoom:1},O=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","rfId"],F=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),V={translateExtent:a.infiniteExtent,nodeOrigin:B,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function $(e){let{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:r,setTranslateExtent:s,setNodeExtent:l,reset:d,setDefaultNodesAndEdges:c}=b(F,f),u=w();(0,i.useEffect)(()=>(c(e.defaultNodes,e.defaultEdges),()=>{g.current=V,d()}),[]);let g=(0,i.useRef)(V);return(0,i.useEffect)(()=>{for(let i of O){let d=e[i];d!==g.current[i]&&void 0!==e[i]&&("nodes"===i?t(d):"edges"===i?n(d):"minZoom"===i?o(d):"maxZoom"===i?r(d):"translateExtent"===i?s(d):"nodeExtent"===i?l(d):"ariaLabelConfig"===i?u.setState({ariaLabelConfig:(0,a.mergeAriaLabelConfig)(d)}):"fitView"===i?u.setState({fitViewQueued:d}):"fitViewOptions"===i?u.setState({fitViewOptions:d}):u.setState({[i]:d}))}g.current=e},O.map(t=>e[t])),null}function H(){return"undefined"!=typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null}let G="undefined"!=typeof document?document:null;function W(e=null,t={target:G,actInsideInputWithModifier:!0}){let[n,o]=(0,i.useState)(!1),r=(0,i.useRef)(!1),s=(0,i.useRef)(new Set([])),[l,d]=(0,i.useMemo)(()=>{if(null!==e){let t=(Array.isArray(e)?e:[e]).filter(e=>"string"==typeof e).map(e=>e.replace("+","\n").replace("\n\n","\n+").split("\n")),n=t.reduce((e,t)=>e.concat(...t),[]);return[t,n]}return[[],[]]},[e]);return(0,i.useEffect)(()=>{let n=t?.target??G,i=t?.actInsideInputWithModifier??!0;if(null!==e){let e=e=>{if(r.current=e.ctrlKey||e.metaKey||e.shiftKey||e.altKey,(!r.current||r.current&&!i)&&(0,a.isInputDOMNode)(e))return!1;let n=Z(e.code,d);if(s.current.add(e[n]),K(l,s.current,!1)){let n=e.composedPath?.()?.[0]||e.target,i=n?.nodeName==="BUTTON"||n?.nodeName==="A";!1!==t.preventDefault&&(r.current||!i)&&e.preventDefault(),o(!0)}},c=e=>{let t=Z(e.code,d);K(l,s.current,!0)?(o(!1),s.current.clear()):s.current.delete(e[t]),"Meta"===e.key&&s.current.clear(),r.current=!1},u=()=>{s.current.clear(),o(!1)};return n?.addEventListener("keydown",e),n?.addEventListener("keyup",c),window.addEventListener("blur",u),window.addEventListener("contextmenu",u),()=>{n?.removeEventListener("keydown",e),n?.removeEventListener("keyup",c),window.removeEventListener("blur",u),window.removeEventListener("contextmenu",u)}}},[e,o]),n}function K(e,t,n){return e.filter(e=>n||e.length===t.size).some(e=>e.every(e=>t.has(e)))}function Z(e,t){return t.includes(e)?"code":"key"}function Q(e,t){let n=[],o=new Map,i=[];for(let t of e)if("add"===t.type){i.push(t);continue}else if("remove"===t.type||"replace"===t.type)o.set(t.id,[t]);else{let e=o.get(t.id);e?e.push(t):o.set(t.id,[t])}for(let e of t){let t=o.get(e.id);if(!t){n.push(e);continue}if("remove"===t[0].type)continue;if("replace"===t[0].type){n.push({...t[0].item});continue}let i={...e};for(let e of t){var r=e,a=i;switch(r.type){case"select":a.selected=r.selected;break;case"position":void 0!==r.position&&(a.position=r.position),void 0!==r.dragging&&(a.dragging=r.dragging);break;case"dimensions":void 0!==r.dimensions&&(a.measured??={},a.measured.width=r.dimensions.width,a.measured.height=r.dimensions.height,r.setAttributes&&((!0===r.setAttributes||"width"===r.setAttributes)&&(a.width=r.dimensions.width),(!0===r.setAttributes||"height"===r.setAttributes)&&(a.height=r.dimensions.height))),"boolean"==typeof r.resizing&&(a.resizing=r.resizing)}}n.push(i)}return i.length&&i.forEach(e=>{void 0!==e.index?n.splice(e.index,0,{...e.item}):n.push({...e.item})}),n}function q(e,t){return{id:e,type:"select",selected:t}}function U(e,t=new Set,n=!1){let o=[];for(let[i,r]of e){let e=t.has(i);(void 0!==r.selected||e)&&r.selected!==e&&(n&&(r.selected=e),o.push(q(r.id,e)))}return o}function X({items:e=[],lookup:t}){let n=[],o=new Map(e.map(e=>[e.id,e]));for(let[o,i]of e.entries()){let e=t.get(i.id),r=e?.internals?.userNode??e;void 0!==r&&r!==i&&n.push({id:i.id,item:i,type:"replace"}),void 0===r&&n.push({item:i,type:"add",index:o})}for(let[e]of t)void 0===o.get(e)&&n.push({id:e,type:"remove"});return n}function Y(e){return{id:e.id,type:"remove"}}let J=e=>(0,a.isNodeBase)(e);function ee(e){return(0,i.forwardRef)(e)}let et="undefined"!=typeof window?i.useLayoutEffect:i.useEffect;function en(e){let[t,n]=(0,i.useState)(BigInt(0)),[o]=(0,i.useState)(()=>{var e;let t;return e=()=>n(e=>e+BigInt(1)),t=[],{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}});return et(()=>{let t=o.get();t.length&&(e(t),o.reset())},[t]),o}let eo=(0,i.createContext)(null);function ei({children:e}){let t=w(),n=en((0,i.useCallback)(e=>{let{nodes:n=[],setNodes:o,hasDefaultNodes:i,onNodesChange:r,nodeLookup:a,fitViewQueued:s}=t.getState(),l=n;for(let t of e)l="function"==typeof t?t(l):t;let d=X({items:l,lookup:a});i&&o(l),d.length>0?r?.(d):s&&window.requestAnimationFrame(()=>{let{fitViewQueued:e,nodes:n,setNodes:o}=t.getState();e&&o(n)})},[])),r=en((0,i.useCallback)(e=>{let{edges:n=[],setEdges:o,hasDefaultEdges:i,onEdgesChange:r,edgeLookup:a}=t.getState(),s=n;for(let t of e)s="function"==typeof t?t(s):t;i?o(s):r&&r(X({items:s,lookup:a}))},[])),a=(0,i.useMemo)(()=>({nodeQueue:n,edgeQueue:r}),[]);return(0,o.jsx)(eo.Provider,{value:a,children:e})}let er=e=>!!e.panZoom;function ea(){let e,t=(e=w(),(0,i.useMemo)(()=>({zoomIn:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{let{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{let{transform:[o,i,r],panZoom:a}=e.getState();return a?(await a.setViewport({x:t.x??o,y:t.y??i,zoom:t.zoom??r},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{let[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{let{width:o,height:i,minZoom:r,maxZoom:s,panZoom:l}=e.getState(),d=(0,a.getViewportForBounds)(t,o,i,r,s,n?.padding??.1);return l?(await l.setViewport(d,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{let{transform:o,snapGrid:i,snapToGrid:r,domNode:s}=e.getState();if(!s)return t;let{x:l,y:d}=s.getBoundingClientRect(),c={x:t.x-l,y:t.y-d},u=n.snapGrid??i,g=n.snapToGrid??r;return(0,a.pointToRendererPoint)(c,o,g,u)},flowToScreenPosition:t=>{let{transform:n,domNode:o}=e.getState();if(!o)return t;let{x:i,y:r}=o.getBoundingClientRect(),s=(0,a.rendererPointToPoint)(t,n);return{x:s.x+i,y:s.y+r}}}),[])),n=w(),o=function(){let e=(0,i.useContext)(eo);if(!e)throw Error("useBatchContext must be used within a BatchProvider");return e}(),r=b(er),s=(0,i.useMemo)(()=>{let e=e=>n.getState().nodeLookup.get(e),t=e=>{o.nodeQueue.push(e)},i=e=>{o.edgeQueue.push(e)},r=e=>{let{nodeLookup:t,nodeOrigin:o}=n.getState(),i=J(e)?e:t.get(e.id),r=i.parentId?(0,a.evaluateAbsolutePosition)(i.position,i.measured,i.parentId,t,o):i.position,s={...i,position:r,width:i.measured?.width??i.width,height:i.measured?.height??i.height};return(0,a.nodeToRect)(s)},s=(e,n,o={replace:!1})=>{t(t=>t.map(t=>{if(t.id===e){let e="function"==typeof n?n(t):n;return o.replace&&J(e)?e:{...t,...e}}return t}))},l=(e,t,n={replace:!1})=>{i(o=>o.map(o=>{if(o.id===e){let e="function"==typeof t?t(o):t;return n.replace&&(0,a.isEdgeBase)(e)?e:{...o,...e}}return o}))};return{getNodes:()=>n.getState().nodes.map(e=>({...e})),getNode:t=>e(t)?.internals.userNode,getInternalNode:e,getEdges:()=>{let{edges:e=[]}=n.getState();return e.map(e=>({...e}))},getEdge:e=>n.getState().edgeLookup.get(e),setNodes:t,setEdges:i,addNodes:e=>{let t=Array.isArray(e)?e:[e];o.nodeQueue.push(e=>[...e,...t])},addEdges:e=>{let t=Array.isArray(e)?e:[e];o.edgeQueue.push(e=>[...e,...t])},toObject:()=>{let{nodes:e=[],edges:t=[],transform:o}=n.getState(),[i,r,a]=o;return{nodes:e.map(e=>({...e})),edges:t.map(e=>({...e})),viewport:{x:i,y:r,zoom:a}}},deleteElements:async({nodes:e=[],edges:t=[]})=>{let{nodes:o,edges:i,onNodesDelete:r,onEdgesDelete:s,triggerNodeChanges:l,triggerEdgeChanges:d,onDelete:c,onBeforeDelete:u}=n.getState(),{nodes:g,edges:h}=await (0,a.getElementsToRemove)({nodesToRemove:e,edgesToRemove:t,nodes:o,edges:i,onBeforeDelete:u}),p=h.length>0,f=g.length>0;if(p){let e=h.map(Y);s?.(h),d(e)}if(f){let e=g.map(Y);r?.(g),l(e)}return(f||p)&&c?.({nodes:g,edges:h}),{deletedNodes:g,deletedEdges:h}},getIntersectingNodes:(e,t=!0,o)=>{let i=(0,a.isRectObject)(e),s=i?e:r(e),l=void 0!==o;return s?(o||n.getState().nodes).filter(o=>{let r=n.getState().nodeLookup.get(o.id);if(r&&!i&&(o.id===e.id||!r.internals.positionAbsolute))return!1;let d=(0,a.nodeToRect)(l?o:r),c=(0,a.getOverlappingArea)(d,s);return t&&c>0||c>=d.width*d.height||c>=s.width*s.height}):[]},isNodeIntersecting:(e,t,n=!0)=>{let o=(0,a.isRectObject)(e)?e:r(e);if(!o)return!1;let i=(0,a.getOverlappingArea)(o,t);return n&&i>0||i>=t.width*t.height||i>=o.width*o.height},updateNode:s,updateNodeData:(e,t,n={replace:!1})=>{s(e,e=>{let o="function"==typeof t?t(e):t;return n.replace?{...e,data:o}:{...e,data:{...e.data,...o}}},n)},updateEdge:l,updateEdgeData:(e,t,n={replace:!1})=>{l(e,e=>{let o="function"==typeof t?t(e):t;return n.replace?{...e,data:o}:{...e,data:{...e.data,...o}}},n)},getNodesBounds:e=>{let{nodeLookup:t,nodeOrigin:o}=n.getState();return(0,a.getNodesBounds)(e,{nodeLookup:t,nodeOrigin:o})},getHandleConnections:({type:e,id:t,nodeId:o})=>Array.from(n.getState().connectionLookup.get(`${o}-${e}${t?`-${t}`:""}`)?.values()??[]),getNodeConnections:({type:e,handleId:t,nodeId:o})=>Array.from(n.getState().connectionLookup.get(`${o}${e?t?`-${e}-${t}`:`-${e}`:""}`)?.values()??[]),fitView:async e=>{let t=n.getState().fitViewResolver??(0,a.withResolvers)();return n.setState({fitViewQueued:!0,fitViewOptions:e,fitViewResolver:t}),o.nodeQueue.push(e=>[...e]),t.promise}}},[]);return(0,i.useMemo)(()=>({...s,...t,viewportInitialized:r}),[r])}let es=e=>e.selected,el="undefined"!=typeof window?window:void 0,ed={position:"absolute",width:"100%",height:"100%",top:0,left:0},ec=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function eu({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:s=.5,panOnScrollMode:l=a.PanOnScrollMode.Free,zoomOnDoubleClick:d=!0,panOnDrag:c=!0,defaultViewport:u,translateExtent:g,minZoom:h,maxZoom:p,zoomActivationKeyCode:m,preventScrolling:x=!0,children:y,noWheelClassName:v,noPanClassName:j,onViewportChange:C,isControlledViewport:S,paneClickDistance:k,selectionOnDrag:_}){let R,M=w(),I=(0,i.useRef)(null),{userSelectionActive:E,lib:N,connectionInProgress:D}=b(ec,f),T=W(m),P=(0,i.useRef)();R=w(),(0,i.useEffect)(()=>{let e=()=>{if(!I.current||!(I.current.checkVisibility?.()??!0))return!1;let e=(0,a.getDimensions)(I.current);(0===e.height||0===e.width)&&R.getState().onError?.("004",a.errorMessages.error004()),R.setState({width:e.width||500,height:e.height||500})};if(I.current){e(),window.addEventListener("resize",e);let t=new ResizeObserver(()=>e());return t.observe(I.current),()=>{window.removeEventListener("resize",e),t&&I.current&&t.unobserve(I.current)}}},[]);let L=(0,i.useCallback)(e=>{C?.({x:e[0],y:e[1],zoom:e[2]}),S||M.setState({transform:e})},[C,S]);return(0,i.useEffect)(()=>{if(I.current){P.current=(0,a.XYPanZoom)({domNode:I.current,minZoom:h,maxZoom:p,translateExtent:g,viewport:u,onDraggingChange:e=>M.setState({paneDragging:e}),onPanZoomStart:(e,t)=>{let{onViewportChangeStart:n,onMoveStart:o}=M.getState();o?.(e,t),n?.(t)},onPanZoom:(e,t)=>{let{onViewportChange:n,onMove:o}=M.getState();o?.(e,t),n?.(t)},onPanZoomEnd:(e,t)=>{let{onViewportChangeEnd:n,onMoveEnd:o}=M.getState();o?.(e,t),n?.(t)}});let{x:e,y:t,zoom:n}=P.current.getViewport();return M.setState({panZoom:P.current,transform:[e,t,n],domNode:I.current.closest(".react-flow")}),()=>{P.current?.destroy()}}},[]),(0,i.useEffect)(()=>{P.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:s,panOnScrollMode:l,zoomOnDoubleClick:d,panOnDrag:c,zoomActivationKeyPressed:T,preventScrolling:x,noPanClassName:j,userSelectionActive:E,noWheelClassName:v,lib:N,onTransformChange:L,connectionInProgress:D,selectionOnDrag:_,paneClickDistance:k})},[e,t,n,r,s,l,d,c,T,x,j,E,v,N,L,D,_,k]),(0,o.jsx)("div",{className:"react-flow__renderer",ref:I,style:ed,children:y})}let eg=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function eh(){let{userSelectionActive:e,userSelectionRect:t}=b(eg,f);return e&&t?(0,o.jsx)("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}let ep=(e,t)=>n=>{n.target===t.current&&e?.(n)},ef=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function em({isSelecting:e,selectionKeyPressed:t,selectionMode:n=a.SelectionMode.Full,panOnDrag:s,paneClickDistance:l,selectionOnDrag:d,onSelectionStart:c,onSelectionEnd:u,onPaneClick:g,onPaneContextMenu:h,onPaneScroll:p,onPaneMouseEnter:m,onPaneMouseMove:x,onPaneMouseLeave:y,children:v}){let j=w(),{userSelectionActive:C,elementsSelectable:S,dragging:k,connectionInProgress:_}=b(ef,f),R=S&&(e||C),M=(0,i.useRef)(null),I=(0,i.useRef)(),E=(0,i.useRef)(new Set),N=(0,i.useRef)(new Set),D=(0,i.useRef)(!1),T=e=>{if(D.current||_){D.current=!1;return}g?.(e),j.getState().resetSelectedElements(),j.setState({nodesSelectionActive:!1})},P=!0===s||Array.isArray(s)&&s.includes(0);return(0,o.jsxs)("div",{className:r(["react-flow__pane",{draggable:P,dragging:k,selection:e}]),onClick:R?void 0:ep(T,M),onContextMenu:ep(e=>{Array.isArray(s)&&s?.includes(2)?e.preventDefault():h?.(e)},M),onWheel:ep(p?e=>p(e):void 0,M),onPointerEnter:R?void 0:m,onPointerMove:R?e=>{let{userSelectionRect:o,transform:i,nodeLookup:r,edgeLookup:s,connectionLookup:d,triggerNodeChanges:u,triggerEdgeChanges:g,defaultEdgeOptions:h,resetSelectedElements:p}=j.getState();if(!I.current||!o)return;let{x:f,y:m}=(0,a.getEventPosition)(e.nativeEvent,I.current),{startX:x,startY:y}=o;if(!D.current){if(Math.hypot(f-x,m-y)<=(t?0:l))return;p(),c?.(e)}D.current=!0;let b={startX:x,startY:y,x:f<x?f:x,y:m<y?m:y,width:Math.abs(f-x),height:Math.abs(m-y)},w=E.current,v=N.current;E.current=new Set((0,a.getNodesInside)(r,b,i,n===a.SelectionMode.Partial,!0).map(e=>e.id)),N.current=new Set;let C=h?.selectable??!0;for(let e of E.current){let t=d.get(e);if(t)for(let{edgeId:e}of t.values()){let t=s.get(e);t&&(t.selectable??C)&&N.current.add(e)}}(0,a.areSetsEqual)(w,E.current)||u(U(r,E.current,!0)),(0,a.areSetsEqual)(v,N.current)||g(U(s,N.current)),j.setState({userSelectionRect:b,userSelectionActive:!0,nodesSelectionActive:!1})}:x,onPointerUp:R?e=>{0===e.button&&(e.target?.releasePointerCapture?.(e.pointerId),!C&&e.target===M.current&&j.getState().userSelectionRect&&T?.(e),j.setState({userSelectionActive:!1,userSelectionRect:null}),D.current&&(u?.(e),j.setState({nodesSelectionActive:E.current.size>0})))}:void 0,onPointerDownCapture:R?n=>{let{domNode:o}=j.getState();if(I.current=o?.getBoundingClientRect(),!I.current)return;let i=n.target===M.current;if(!i&&n.target.closest(".nokey")||!e||!(d&&i||t)||0!==n.button||!n.isPrimary)return;n.target?.setPointerCapture?.(n.pointerId),D.current=!1;let{x:r,y:s}=(0,a.getEventPosition)(n.nativeEvent,I.current);j.setState({userSelectionRect:{width:0,height:0,startX:r,startY:s,x:r,y:s}}),i||(n.stopPropagation(),n.preventDefault())}:void 0,onClickCapture:R?e=>{D.current&&(e.stopPropagation(),D.current=!1)}:void 0,onPointerLeave:y,ref:M,style:ed,children:[v,(0,o.jsx)(eh,{})]})}function ex({id:e,store:t,unselect:n=!1,nodeRef:o}){let{addSelectedNodes:i,unselectNodesAndEdges:r,multiSelectionActive:s,nodeLookup:l,onError:d}=t.getState(),c=l.get(e);c?(t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&s)&&(r({nodes:[c],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):i([e])):d?.("012",a.errorMessages.error012(e))}function ey({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:s,nodeClickDistance:l}){let d=w(),[c,u]=(0,i.useState)(!1),g=(0,i.useRef)();return(0,i.useEffect)(()=>{g.current=(0,a.XYDrag)({getStoreItems:()=>d.getState(),onNodeMouseDown:t=>{ex({id:t,store:d,nodeRef:e})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),(0,i.useEffect)(()=>{if(t)g.current?.destroy();else if(e.current)return g.current?.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:s,nodeId:r,nodeClickDistance:l}),()=>{g.current?.destroy()}},[n,o,t,s,e,r]),c}function eb(){let e=w();return(0,i.useCallback)(t=>{let{nodeExtent:n,snapToGrid:o,snapGrid:i,nodesDraggable:r,onError:s,updateNodePositions:l,nodeLookup:d,nodeOrigin:c}=e.getState(),u=new Map,g=e=>e.selected&&(e.draggable||r&&void 0===e.draggable),h=o?i[0]:5,p=o?i[1]:5,f=t.direction.x*h*t.factor,m=t.direction.y*p*t.factor;for(let[,e]of d){if(!g(e))continue;let t={x:e.internals.positionAbsolute.x+f,y:e.internals.positionAbsolute.y+m};o&&(t=(0,a.snapPosition)(t,i));let{position:r,positionAbsolute:l}=(0,a.calculateNodePosition)({nodeId:e.id,nextPosition:t,nodeLookup:d,nodeExtent:n,nodeOrigin:c,onError:s});e.position=r,e.internals.positionAbsolute=l,u.set(e.id,e)}l(u)},[])}let ew=(0,i.createContext)(null),ev=ew.Provider;ew.Consumer;let ej=()=>(0,i.useContext)(ew),eC=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),eS=(0,i.memo)(ee(function({type:e="source",position:t=a.Position.Top,isValidConnection:n,isConnectable:i=!0,isConnectableStart:s=!0,isConnectableEnd:l=!0,id:d,onConnect:c,children:u,className:g,onMouseDown:h,onTouchStart:p,...m},x){let y=d||null,v="target"===e,j=w(),C=ej(),{connectOnClick:S,noPanClassName:k,rfId:_}=b(eC,f),{connectingFrom:R,connectingTo:M,clickConnecting:I,isPossibleEndHandle:E,connectionInProcess:N,clickConnectionInProcess:D,valid:T}=b(t=>{let{connectionClickStartHandle:n,connectionMode:o,connection:i}=t,{fromHandle:r,toHandle:s,isValid:l}=i,d=s?.nodeId===C&&s?.id===y&&s?.type===e;return{connectingFrom:r?.nodeId===C&&r?.id===y&&r?.type===e,connectingTo:d,clickConnecting:n?.nodeId===C&&n?.id===y&&n?.type===e,isPossibleEndHandle:o===a.ConnectionMode.Strict?r?.type!==e:C!==r?.nodeId||y!==r?.id,connectionInProcess:!!r,clickConnectionInProcess:!!n,valid:d&&l}},f);C||j.getState().onError?.("010",a.errorMessages.error010());let P=e=>{let{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:o}=j.getState(),i={...t,...e};if(o){let{edges:e,setEdges:t}=j.getState();t((0,a.addEdge)(i,e))}n?.(i),c?.(i)},L=e=>{if(!C)return;let t=(0,a.isMouseEvent)(e.nativeEvent);if(s&&(t&&0===e.button||!t)){let t=j.getState();a.XYHandle.onPointerDown(e.nativeEvent,{handleDomNode:e.currentTarget,autoPanOnConnect:t.autoPanOnConnect,connectionMode:t.connectionMode,connectionRadius:t.connectionRadius,domNode:t.domNode,nodeLookup:t.nodeLookup,lib:t.lib,isTarget:v,handleId:y,nodeId:C,flowId:t.rfId,panBy:t.panBy,cancelConnection:t.cancelConnection,onConnectStart:t.onConnectStart,onConnectEnd:t.onConnectEnd,updateConnection:t.updateConnection,onConnect:P,isValidConnection:n||t.isValidConnection,getTransform:()=>j.getState().transform,getFromHandle:()=>j.getState().connection.fromHandle,autoPanSpeed:t.autoPanSpeed,dragThreshold:t.connectionDragThreshold})}t?h?.(e):p?.(e)};return(0,o.jsx)("div",{"data-handleid":y,"data-nodeid":C,"data-handlepos":t,"data-id":`${_}-${C}-${y}-${e}`,className:r(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",k,g,{source:!v,target:v,connectable:i,connectablestart:s,connectableend:l,clickconnecting:I,connectingfrom:R,connectingto:M,valid:T,connectionindicator:i&&(!N||E)&&(N||D?l:s)}]),onMouseDown:L,onTouchStart:L,onClick:S?t=>{let{onClickConnectStart:o,onClickConnectEnd:i,connectionClickStartHandle:r,connectionMode:l,isValidConnection:d,lib:c,rfId:u,nodeLookup:g,connection:h}=j.getState();if(!C||!r&&!s)return;if(!r){o?.(t.nativeEvent,{nodeId:C,handleId:y,handleType:e}),j.setState({connectionClickStartHandle:{nodeId:C,type:e,id:y}});return}let p=(0,a.getHostForElement)(t.target),f=n||d,{connection:m,isValid:x}=a.XYHandle.isValid(t.nativeEvent,{handle:{nodeId:C,id:y,type:e},connectionMode:l,fromNodeId:r.nodeId,fromHandleId:r.id||null,fromType:r.type,isValidConnection:f,flowId:u,doc:p,lib:c,nodeLookup:g});x&&m&&P(m);let b=structuredClone(h);delete b.inProgress,b.toPosition=b.toHandle?b.toHandle.position:null,i?.(t,b),j.setState({connectionClickStartHandle:null})}:void 0,ref:x,...m,children:u})})),ek={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},e_={input:function({data:e,isConnectable:t,sourcePosition:n=a.Position.Bottom}){return(0,o.jsxs)(o.Fragment,{children:[e?.label,(0,o.jsx)(eS,{type:"source",position:n,isConnectable:t})]})},default:function({data:e,isConnectable:t,targetPosition:n=a.Position.Top,sourcePosition:i=a.Position.Bottom}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eS,{type:"target",position:n,isConnectable:t}),e?.label,(0,o.jsx)(eS,{type:"source",position:i,isConnectable:t})]})},output:function({data:e,isConnectable:t,targetPosition:n=a.Position.Top}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eS,{type:"target",position:n,isConnectable:t}),e?.label]})},group:function(){return null}},eR=e=>{let{width:t,height:n,x:o,y:i}=(0,a.getInternalNodesBounds)(e.nodeLookup,{filter:e=>!!e.selected});return{width:(0,a.isNumeric)(t)?t:null,height:(0,a.isNumeric)(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${i}px)`}};function eM({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){let a=w(),{width:s,height:l,transformString:d,userSelectionActive:c}=b(eR,f),u=eb(),g=(0,i.useRef)(null);if((0,i.useEffect)(()=>{n||g.current?.focus({preventScroll:!0})},[n]),ey({nodeRef:g}),c||!s||!l)return null;let h=e?t=>{e(t,a.getState().nodes.filter(e=>e.selected))}:void 0;return(0,o.jsx)("div",{className:r(["react-flow__nodesselection","react-flow__container",t]),style:{transform:d},children:(0,o.jsx)("div",{ref:g,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:e=>{Object.prototype.hasOwnProperty.call(ek,e.key)&&(e.preventDefault(),u({direction:ek[e.key],factor:e.shiftKey?4:1}))},style:{width:s,height:l}})})}let eI="undefined"!=typeof window?window:void 0,eE=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function eN({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:s,onPaneScroll:l,paneClickDistance:d,deleteKeyCode:c,selectionKeyCode:u,selectionOnDrag:g,selectionMode:h,onSelectionStart:p,onSelectionEnd:f,multiSelectionKeyCode:m,panActivationKeyCode:x,zoomActivationKeyCode:y,elementsSelectable:v,zoomOnScroll:j,zoomOnPinch:C,panOnScroll:S,panOnScrollSpeed:k,panOnScrollMode:_,zoomOnDoubleClick:R,panOnDrag:M,defaultViewport:I,translateExtent:E,minZoom:N,maxZoom:D,preventScrolling:T,onSelectionContextMenu:P,noWheelClassName:L,noPanClassName:z,disableKeyboardA11y:B,onViewportChange:A,isControlledViewport:O}){let{nodesSelectionActive:F,userSelectionActive:V}=b(eE),$=W(u,{target:eI}),H=W(x,{target:eI}),G=H||M,K=H||S,Z=g&&!0!==G,Q=$||V||Z;return!function({deleteKeyCode:e,multiSelectionKeyCode:t}){let n=w(),{deleteElements:o}=ea(),r=W(e,{actInsideInputWithModifier:!1}),a=W(t,{target:el});(0,i.useEffect)(()=>{if(r){let{edges:e,nodes:t}=n.getState();o({nodes:t.filter(es),edges:e.filter(es)}),n.setState({nodesSelectionActive:!1})}},[r]),(0,i.useEffect)(()=>{n.setState({multiSelectionActive:a})},[a])}({deleteKeyCode:c,multiSelectionKeyCode:m}),(0,o.jsx)(eu,{onPaneContextMenu:s,elementsSelectable:v,zoomOnScroll:j,zoomOnPinch:C,panOnScroll:K,panOnScrollSpeed:k,panOnScrollMode:_,zoomOnDoubleClick:R,panOnDrag:!$&&G,defaultViewport:I,translateExtent:E,minZoom:N,maxZoom:D,zoomActivationKeyCode:y,preventScrolling:T,noWheelClassName:L,noPanClassName:z,onViewportChange:A,isControlledViewport:O,paneClickDistance:d,selectionOnDrag:Z,children:(0,o.jsxs)(em,{onSelectionStart:p,onSelectionEnd:f,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:s,onPaneScroll:l,panOnDrag:G,isSelecting:!!Q,selectionMode:h,selectionKeyPressed:$,paneClickDistance:d,selectionOnDrag:Z,children:[e,F&&(0,o.jsx)(eM,{onSelectionContextMenu:P,noPanClassName:z,disableKeyboardA11y:B})]})})}eN.displayName="FlowRenderer";let eD=(0,i.memo)(eN),eT=e=>e.updateNodeInternals;var eP=(0,i.memo)(function({id:e,onClick:t,onMouseEnter:n,onMouseMove:s,onMouseLeave:l,onContextMenu:d,onDoubleClick:c,nodesDraggable:u,elementsSelectable:g,nodesConnectable:h,nodesFocusable:p,resizeObserver:m,noDragClassName:x,noPanClassName:y,disableKeyboardA11y:v,rfId:j,nodeTypes:S,nodeClickDistance:k,onError:_}){let{node:R,internals:M,isParent:I}=b(t=>{let n=t.nodeLookup.get(e),o=t.parentLookup.has(e);return{node:n,internals:n.internals,isParent:o}},f),E=R.type||"default",N=S?.[E]||e_[E];void 0===N&&(_?.("003",a.errorMessages.error003(E)),E="default",N=S?.default||e_.default);let D=!!(R.draggable||u&&void 0===R.draggable),T=!!(R.selectable||g&&void 0===R.selectable),P=!!(R.connectable||h&&void 0===R.connectable),L=!!(R.focusable||p&&void 0===R.focusable),z=w(),B=(0,a.nodeHasDimensions)(R),A=function({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){let r=w(),a=(0,i.useRef)(null),s=(0,i.useRef)(null),l=(0,i.useRef)(e.sourcePosition),d=(0,i.useRef)(e.targetPosition),c=(0,i.useRef)(t),u=n&&!!e.internals.handleBounds;return(0,i.useEffect)(()=>{!a.current||e.hidden||u&&s.current===a.current||(s.current&&o?.unobserve(s.current),o?.observe(a.current),s.current=a.current)},[u,e.hidden]),(0,i.useEffect)(()=>()=>{s.current&&(o?.unobserve(s.current),s.current=null)},[]),(0,i.useEffect)(()=>{if(a.current){let n=c.current!==t,o=l.current!==e.sourcePosition,i=d.current!==e.targetPosition;(n||o||i)&&(c.current=t,l.current=e.sourcePosition,d.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:a.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),a}({node:R,nodeType:E,hasDimensions:B,resizeObserver:m}),O=ey({nodeRef:A,disabled:R.hidden||!D,noDragClassName:x,handleSelector:R.dragHandle,nodeId:e,isSelectable:T,nodeClickDistance:k}),F=eb();if(R.hidden)return null;let V=(0,a.getNodeDimensions)(R),$=void 0===R.internals.handleBounds?{width:R.width??R.initialWidth??R.style?.width,height:R.height??R.initialHeight??R.style?.height}:{width:R.width??R.style?.width,height:R.height??R.style?.height},H=T||D||t||n||s||l,G=n?e=>n(e,{...M.userNode}):void 0,W=s?e=>s(e,{...M.userNode}):void 0,K=l?e=>l(e,{...M.userNode}):void 0,Z=d?e=>d(e,{...M.userNode}):void 0,Q=c?e=>c(e,{...M.userNode}):void 0;return(0,o.jsx)("div",{className:r(["react-flow__node",`react-flow__node-${E}`,{[y]:D},R.className,{selected:R.selected,selectable:T,parent:I,draggable:D,dragging:O}]),ref:A,style:{zIndex:M.z,transform:`translate(${M.positionAbsolute.x}px,${M.positionAbsolute.y}px)`,pointerEvents:H?"all":"none",visibility:B?"visible":"hidden",...R.style,...$},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:G,onMouseMove:W,onMouseLeave:K,onContextMenu:Z,onClick:n=>{let{selectNodesOnDrag:o,nodeDragThreshold:i}=z.getState();T&&(!o||!D||i>0)&&ex({id:e,store:z,nodeRef:A}),t&&t(n,{...M.userNode})},onDoubleClick:Q,onKeyDown:L?t=>{if(!(0,a.isInputDOMNode)(t.nativeEvent)&&!v){if(a.elementSelectionKeys.includes(t.key)&&T)ex({id:e,store:z,unselect:"Escape"===t.key,nodeRef:A});else if(D&&R.selected&&Object.prototype.hasOwnProperty.call(ek,t.key)){t.preventDefault();let{ariaLabelConfig:e}=z.getState();z.setState({ariaLiveMessage:e["node.a11yDescription.ariaLiveMessage"]({direction:t.key.replace("Arrow","").toLowerCase(),x:~~M.positionAbsolute.x,y:~~M.positionAbsolute.y})}),F({direction:ek[t.key],factor:t.shiftKey?4:1})}}}:void 0,tabIndex:L?0:void 0,onFocus:L?()=>{if(v||!A.current?.matches(":focus-visible"))return;let{transform:t,width:n,height:o,autoPanOnNodeFocus:i,setCenter:r}=z.getState();!i||(0,a.getNodesInside)(new Map([[e,R]]),{x:0,y:0,width:n,height:o},t,!0).length>0||r(R.position.x+V.width/2,R.position.y+V.height/2,{zoom:t[2]})}:void 0,role:R.ariaRole??(L?"group":void 0),"aria-roledescription":"node","aria-describedby":v?void 0:`${C}-${j}`,"aria-label":R.ariaLabel,...R.domAttributes,children:(0,o.jsx)(ev,{value:e,children:(0,o.jsx)(N,{id:e,data:R.data,type:E,positionAbsoluteX:M.positionAbsolute.x,positionAbsoluteY:M.positionAbsolute.y,selected:R.selected??!1,selectable:T,draggable:D,deletable:R.deletable??!0,isConnectable:P,sourcePosition:R.sourcePosition,targetPosition:R.targetPosition,dragging:O,dragHandle:R.dragHandle,zIndex:M.z,parentId:R.parentId,...V})})})});let eL=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function ez(e){var t;let{nodesDraggable:n,nodesConnectable:r,nodesFocusable:s,elementsSelectable:l,onError:d}=b(eL,f),c=(t=e.onlyRenderVisibleElements,b((0,i.useCallback)(e=>t?(0,a.getNodesInside)(e.nodeLookup,{x:0,y:0,width:e.width,height:e.height},e.transform,!0).map(e=>e.id):Array.from(e.nodeLookup.keys()),[t]),f)),u=function(){let e=b(eT),[t]=(0,i.useState)(()=>"undefined"==typeof ResizeObserver?null:new ResizeObserver(t=>{let n=new Map;t.forEach(e=>{let t=e.target.getAttribute("data-id");n.set(t,{id:t,nodeElement:e.target,force:!0})}),e(n)}));return(0,i.useEffect)(()=>()=>{t?.disconnect()},[t]),t}();return(0,o.jsx)("div",{className:"react-flow__nodes",style:ed,children:c.map(t=>(0,o.jsx)(eP,{id:t,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:u,nodesDraggable:n,nodesConnectable:r,nodesFocusable:s,elementsSelectable:l,nodeClickDistance:e.nodeClickDistance,onError:d},t))})}ez.displayName="NodeRenderer";let eB=(0,i.memo)(ez),eA={[a.MarkerType.Arrow]:({color:e="none",strokeWidth:t=1})=>{let n={strokeWidth:t,...e&&{stroke:e}};return(0,o.jsx)("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},[a.MarkerType.ArrowClosed]:({color:e="none",strokeWidth:t=1})=>{let n={strokeWidth:t,...e&&{stroke:e,fill:e}};return(0,o.jsx)("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})}},eO=({id:e,type:t,color:n,width:r=12.5,height:s=12.5,markerUnits:l="strokeWidth",strokeWidth:d,orient:c="auto-start-reverse"})=>{let u,g=(u=w(),(0,i.useMemo)(()=>Object.prototype.hasOwnProperty.call(eA,t)?eA[t]:(u.getState().onError?.("009",a.errorMessages.error009(t)),null),[t]));return g?(0,o.jsx)("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:l,orient:c,refX:"0",refY:"0",children:(0,o.jsx)(g,{color:n,strokeWidth:d})}):null},eF=({defaultColor:e,rfId:t})=>{let n=b(e=>e.edges),r=b(e=>e.defaultEdgeOptions),s=(0,i.useMemo)(()=>(0,a.createMarkerIds)(n,{id:t,defaultColor:e,defaultMarkerStart:r?.markerStart,defaultMarkerEnd:r?.markerEnd}),[n,r,t,e]);return s.length?(0,o.jsx)("svg",{className:"react-flow__marker","aria-hidden":"true",children:(0,o.jsx)("defs",{children:s.map(e=>(0,o.jsx)(eO,{id:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient},e.id))})}):null};eF.displayName="MarkerDefinitions";var eV=(0,i.memo)(eF);function e$({x:e,y:t,label:n,labelStyle:a,labelShowBg:s=!0,labelBgStyle:l,labelBgPadding:d=[2,4],labelBgBorderRadius:c=2,children:u,className:g,...h}){let[p,f]=(0,i.useState)({x:1,y:0,width:0,height:0}),m=r(["react-flow__edge-textwrapper",g]),x=(0,i.useRef)(null);return((0,i.useEffect)(()=>{if(x.current){let e=x.current.getBBox();f({x:e.x,y:e.y,width:e.width,height:e.height})}},[n]),n)?(0,o.jsxs)("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:m,visibility:p.width?"visible":"hidden",...h,children:[s&&(0,o.jsx)("rect",{width:p.width+2*d[0],x:-d[0],y:-d[1],height:p.height+2*d[1],className:"react-flow__edge-textbg",style:l,rx:c,ry:c}),(0,o.jsx)("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:x,style:a,children:n}),u]}):null}e$.displayName="EdgeText";let eH=(0,i.memo)(e$);function eG({path:e,labelX:t,labelY:n,label:i,labelStyle:s,labelShowBg:l,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:u,interactionWidth:g=20,...h}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{...h,d:e,fill:"none",className:r(["react-flow__edge-path",h.className])}),g?(0,o.jsx)("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}):null,i&&(0,a.isNumeric)(t)&&(0,a.isNumeric)(n)?(0,o.jsx)(eH,{x:t,y:n,label:i,labelStyle:s,labelShowBg:l,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:u}):null]})}function eW({pos:e,x1:t,y1:n,x2:o,y2:i}){return e===a.Position.Left||e===a.Position.Right?[.5*(t+o),n]:[t,.5*(n+i)]}function eK({sourceX:e,sourceY:t,sourcePosition:n=a.Position.Bottom,targetX:o,targetY:i,targetPosition:r=a.Position.Top}){let[s,l]=eW({pos:n,x1:e,y1:t,x2:o,y2:i}),[d,c]=eW({pos:r,x1:o,y1:i,x2:e,y2:t}),[u,g,h,p]=(0,a.getBezierEdgeCenter)({sourceX:e,sourceY:t,targetX:o,targetY:i,sourceControlX:s,sourceControlY:l,targetControlX:d,targetControlY:c});return[`M${e},${t} C${s},${l} ${d},${c} ${o},${i}`,u,g,h,p]}function eZ(e){return(0,i.memo)(({id:t,sourceX:n,sourceY:i,targetX:r,targetY:a,sourcePosition:s,targetPosition:l,label:d,labelStyle:c,labelShowBg:u,labelBgStyle:g,labelBgPadding:h,labelBgBorderRadius:p,style:f,markerEnd:m,markerStart:x,interactionWidth:y})=>{let[b,w,v]=eK({sourceX:n,sourceY:i,sourcePosition:s,targetX:r,targetY:a,targetPosition:l}),j=e.isInternal?void 0:t;return(0,o.jsx)(eG,{id:j,path:b,labelX:w,labelY:v,label:d,labelStyle:c,labelShowBg:u,labelBgStyle:g,labelBgPadding:h,labelBgBorderRadius:p,style:f,markerEnd:m,markerStart:x,interactionWidth:y})})}let eQ=eZ({isInternal:!1}),eq=eZ({isInternal:!0});function eU(e){return(0,i.memo)(({id:t,sourceX:n,sourceY:i,targetX:r,targetY:s,label:l,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:g,labelBgBorderRadius:h,style:p,sourcePosition:f=a.Position.Bottom,targetPosition:m=a.Position.Top,markerEnd:x,markerStart:y,pathOptions:b,interactionWidth:w})=>{let[v,j,C]=(0,a.getSmoothStepPath)({sourceX:n,sourceY:i,sourcePosition:f,targetX:r,targetY:s,targetPosition:m,borderRadius:b?.borderRadius,offset:b?.offset,stepPosition:b?.stepPosition}),S=e.isInternal?void 0:t;return(0,o.jsx)(eG,{id:S,path:v,labelX:j,labelY:C,label:l,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:g,labelBgBorderRadius:h,style:p,markerEnd:x,markerStart:y,interactionWidth:w})})}eQ.displayName="SimpleBezierEdge",eq.displayName="SimpleBezierEdgeInternal";let eX=eU({isInternal:!1}),eY=eU({isInternal:!0});function eJ(e){return(0,i.memo)(({id:t,...n})=>{let r=e.isInternal?void 0:t;return(0,o.jsx)(eX,{...n,id:r,pathOptions:(0,i.useMemo)(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}eX.displayName="SmoothStepEdge",eY.displayName="SmoothStepEdgeInternal";let e0=eJ({isInternal:!1}),e1=eJ({isInternal:!0});function e2(e){return(0,i.memo)(({id:t,sourceX:n,sourceY:i,targetX:r,targetY:s,label:l,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:g,labelBgBorderRadius:h,style:p,markerEnd:f,markerStart:m,interactionWidth:x})=>{let[y,b,w]=(0,a.getStraightPath)({sourceX:n,sourceY:i,targetX:r,targetY:s}),v=e.isInternal?void 0:t;return(0,o.jsx)(eG,{id:v,path:y,labelX:b,labelY:w,label:l,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:g,labelBgBorderRadius:h,style:p,markerEnd:f,markerStart:m,interactionWidth:x})})}e0.displayName="StepEdge",e1.displayName="StepEdgeInternal";let e3=e2({isInternal:!1}),e5=e2({isInternal:!0});function e4(e){return(0,i.memo)(({id:t,sourceX:n,sourceY:i,targetX:r,targetY:s,sourcePosition:l=a.Position.Bottom,targetPosition:d=a.Position.Top,label:c,labelStyle:u,labelShowBg:g,labelBgStyle:h,labelBgPadding:p,labelBgBorderRadius:f,style:m,markerEnd:x,markerStart:y,pathOptions:b,interactionWidth:w})=>{let[v,j,C]=(0,a.getBezierPath)({sourceX:n,sourceY:i,sourcePosition:l,targetX:r,targetY:s,targetPosition:d,curvature:b?.curvature}),S=e.isInternal?void 0:t;return(0,o.jsx)(eG,{id:S,path:v,labelX:j,labelY:C,label:c,labelStyle:u,labelShowBg:g,labelBgStyle:h,labelBgPadding:p,labelBgBorderRadius:f,style:m,markerEnd:x,markerStart:y,interactionWidth:w})})}e3.displayName="StraightEdge",e5.displayName="StraightEdgeInternal";let e8=e4({isInternal:!1}),e6=e4({isInternal:!0});e8.displayName="BezierEdge",e6.displayName="BezierEdgeInternal";let e7={default:e6,straight:e5,step:e1,smoothstep:eY,simplebezier:eq},e9={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},te="react-flow__edgeupdater";function tt({position:e,centerX:t,centerY:n,radius:i=10,onMouseDown:s,onMouseEnter:l,onMouseOut:d,type:c}){return(0,o.jsx)("circle",{onMouseDown:s,onMouseEnter:l,onMouseOut:d,className:r([te,`${te}-${c}`]),cx:e===a.Position.Left?t-i:e===a.Position.Right?t+i:t,cy:e===a.Position.Top?n-i:e===a.Position.Bottom?n+i:n,r:i,stroke:"transparent",fill:"transparent"})}function tn({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:i,sourceY:r,targetX:s,targetY:l,sourcePosition:d,targetPosition:c,onReconnect:u,onReconnectStart:g,onReconnectEnd:h,setReconnecting:p,setUpdateHover:f}){let m=w(),x=(e,t)=>{if(0!==e.button)return;let{autoPanOnConnect:o,domNode:i,isValidConnection:r,connectionMode:s,connectionRadius:l,lib:d,onConnectStart:c,onConnectEnd:f,cancelConnection:x,nodeLookup:y,rfId:b,panBy:w,updateConnection:v}=m.getState(),j="target"===t.type;a.XYHandle.onPointerDown(e.nativeEvent,{autoPanOnConnect:o,connectionMode:s,connectionRadius:l,domNode:i,handleId:t.id,nodeId:t.nodeId,nodeLookup:y,isTarget:j,edgeUpdaterType:t.type,lib:d,flowId:b,cancelConnection:x,panBy:w,isValidConnection:r,onConnect:e=>u?.(n,e),onConnectStart:(o,i)=>{p(!0),g?.(e,n,t.type),c?.(o,i)},onConnectEnd:f,onReconnectEnd:(e,o)=>{p(!1),h?.(e,n,t.type,o)},updateConnection:v,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle,dragThreshold:m.getState().connectionDragThreshold,handleDomNode:e.currentTarget})},y=()=>f(!0),b=()=>f(!1);return(0,o.jsxs)(o.Fragment,{children:[(!0===e||"source"===e)&&(0,o.jsx)(tt,{position:d,centerX:i,centerY:r,radius:t,onMouseDown:e=>x(e,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),onMouseEnter:y,onMouseOut:b,type:"source"}),(!0===e||"target"===e)&&(0,o.jsx)(tt,{position:c,centerX:s,centerY:l,radius:t,onMouseDown:e=>x(e,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),onMouseEnter:y,onMouseOut:b,type:"target"})]})}var to=(0,i.memo)(function({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:s,onClick:l,onDoubleClick:d,onContextMenu:c,onMouseEnter:u,onMouseMove:g,onMouseLeave:h,reconnectRadius:p,onReconnect:m,onReconnectStart:x,onReconnectEnd:y,rfId:v,edgeTypes:j,noPanClassName:C,onError:k,disableKeyboardA11y:_}){let R=b(t=>t.edgeLookup.get(e)),M=b(e=>e.defaultEdgeOptions),I=(R=M?{...M,...R}:R).type||"default",E=j?.[I]||e7[I];void 0===E&&(k?.("011",a.errorMessages.error011(I)),I="default",E=j?.default||e7.default);let N=!!(R.focusable||t&&void 0===R.focusable),D=void 0!==m&&(R.reconnectable||n&&void 0===R.reconnectable),T=!!(R.selectable||s&&void 0===R.selectable),P=(0,i.useRef)(null),[L,z]=(0,i.useState)(!1),[B,A]=(0,i.useState)(!1),O=w(),{zIndex:F,sourceX:V,sourceY:$,targetX:H,targetY:G,sourcePosition:W,targetPosition:K}=b((0,i.useCallback)(t=>{let n=t.nodeLookup.get(R.source),o=t.nodeLookup.get(R.target);if(!n||!o)return{zIndex:R.zIndex,...e9};let i=(0,a.getEdgePosition)({id:e,sourceNode:n,targetNode:o,sourceHandle:R.sourceHandle||null,targetHandle:R.targetHandle||null,connectionMode:t.connectionMode,onError:k});return{zIndex:(0,a.getElevatedEdgeZIndex)({selected:R.selected,zIndex:R.zIndex,sourceNode:n,targetNode:o,elevateOnSelect:t.elevateEdgesOnSelect}),...i||e9}},[R.source,R.target,R.sourceHandle,R.targetHandle,R.selected,R.zIndex]),f),Z=(0,i.useMemo)(()=>R.markerStart?`url('#${(0,a.getMarkerId)(R.markerStart,v)}')`:void 0,[R.markerStart,v]),Q=(0,i.useMemo)(()=>R.markerEnd?`url('#${(0,a.getMarkerId)(R.markerEnd,v)}')`:void 0,[R.markerEnd,v]);if(R.hidden||null===V||null===$||null===H||null===G)return null;let q=d?e=>{d(e,{...R})}:void 0,U=c?e=>{c(e,{...R})}:void 0,X=u?e=>{u(e,{...R})}:void 0,Y=g?e=>{g(e,{...R})}:void 0,J=h?e=>{h(e,{...R})}:void 0;return(0,o.jsx)("svg",{style:{zIndex:F},children:(0,o.jsxs)("g",{className:r(["react-flow__edge",`react-flow__edge-${I}`,R.className,C,{selected:R.selected,animated:R.animated,inactive:!T&&!l,updating:L,selectable:T}]),onClick:t=>{let{addSelectedEdges:n,unselectNodesAndEdges:o,multiSelectionActive:i}=O.getState();T&&(O.setState({nodesSelectionActive:!1}),R.selected&&i?(o({nodes:[],edges:[R]}),P.current?.blur()):n([e])),l&&l(t,R)},onDoubleClick:q,onContextMenu:U,onMouseEnter:X,onMouseMove:Y,onMouseLeave:J,onKeyDown:N?t=>{if(!_&&a.elementSelectionKeys.includes(t.key)&&T){let{unselectNodesAndEdges:n,addSelectedEdges:o}=O.getState();"Escape"===t.key?(P.current?.blur(),n({edges:[R]})):o([e])}}:void 0,tabIndex:N?0:void 0,role:R.ariaRole??(N?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":null===R.ariaLabel?void 0:R.ariaLabel||`Edge from ${R.source} to ${R.target}`,"aria-describedby":N?`${S}-${v}`:void 0,ref:P,...R.domAttributes,children:[!B&&(0,o.jsx)(E,{id:e,source:R.source,target:R.target,type:R.type,selected:R.selected,animated:R.animated,selectable:T,deletable:R.deletable??!0,label:R.label,labelStyle:R.labelStyle,labelShowBg:R.labelShowBg,labelBgStyle:R.labelBgStyle,labelBgPadding:R.labelBgPadding,labelBgBorderRadius:R.labelBgBorderRadius,sourceX:V,sourceY:$,targetX:H,targetY:G,sourcePosition:W,targetPosition:K,data:R.data,style:R.style,sourceHandleId:R.sourceHandle,targetHandleId:R.targetHandle,markerStart:Z,markerEnd:Q,pathOptions:"pathOptions"in R?R.pathOptions:void 0,interactionWidth:R.interactionWidth}),D&&(0,o.jsx)(tn,{edge:R,isReconnectable:D,reconnectRadius:p,onReconnect:m,onReconnectStart:x,onReconnectEnd:y,sourceX:V,sourceY:$,targetX:H,targetY:G,sourcePosition:W,targetPosition:K,setUpdateHover:z,setReconnecting:A})]})})});let ti=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function tr({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:s,onReconnect:l,onEdgeContextMenu:d,onEdgeMouseEnter:c,onEdgeMouseMove:u,onEdgeMouseLeave:g,onEdgeClick:h,reconnectRadius:p,onEdgeDoubleClick:m,onReconnectStart:x,onReconnectEnd:y,disableKeyboardA11y:w}){let{edgesFocusable:v,edgesReconnectable:j,elementsSelectable:C,onError:S}=b(ti,f),k=b((0,i.useCallback)(e=>{if(!t)return e.edges.map(e=>e.id);let n=[];if(e.width&&e.height)for(let t of e.edges){let o=e.nodeLookup.get(t.source),i=e.nodeLookup.get(t.target);o&&i&&(0,a.isEdgeVisible)({sourceNode:o,targetNode:i,width:e.width,height:e.height,transform:e.transform})&&n.push(t.id)}return n},[t]),f);return(0,o.jsxs)("div",{className:"react-flow__edges",children:[(0,o.jsx)(eV,{defaultColor:e,rfId:n}),k.map(e=>(0,o.jsx)(to,{id:e,edgesFocusable:v,edgesReconnectable:j,elementsSelectable:C,noPanClassName:s,onReconnect:l,onContextMenu:d,onMouseEnter:c,onMouseMove:u,onMouseLeave:g,onClick:h,reconnectRadius:p,onDoubleClick:m,onReconnectStart:x,onReconnectEnd:y,rfId:n,onError:S,edgeTypes:r,disableKeyboardA11y:w},e))]})}tr.displayName="EdgeRenderer";let ta=(0,i.memo)(tr),ts=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function tl({children:e}){let t=b(ts);return(0,o.jsx)("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}let td=e=>e.panZoom?.syncViewport;function tc(e){return e.connection.inProgress?{...e.connection,to:(0,a.pointToRendererPoint)(e.connection.to,e.transform)}:{...e.connection}}let tu=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function tg({containerStyle:e,style:t,type:n,component:i}){let{nodesConnectable:s,width:l,height:d,isValid:c,inProgress:u}=b(tu,f);return l&&s&&u?(0,o.jsx)("svg",{style:e,width:l,height:d,className:"react-flow__connectionline react-flow__container",children:(0,o.jsx)("g",{className:r(["react-flow__connection",(0,a.getConnectionStatus)(c)]),children:(0,o.jsx)(th,{style:t,type:n,CustomComponent:i,isValid:c})})}):null}let th=({style:e,type:t=a.ConnectionLineType.Bezier,CustomComponent:n,isValid:i})=>{let{inProgress:r,from:s,fromNode:l,fromHandle:d,fromPosition:c,to:u,toNode:g,toHandle:h,toPosition:p,pointer:m}=b(tc,f);if(!r)return;if(n)return(0,o.jsx)(n,{connectionLineType:t,connectionLineStyle:e,fromNode:l,fromHandle:d,fromX:s.x,fromY:s.y,toX:u.x,toY:u.y,fromPosition:c,toPosition:p,connectionStatus:(0,a.getConnectionStatus)(i),toNode:g,toHandle:h,pointer:m});let x="",y={sourceX:s.x,sourceY:s.y,sourcePosition:c,targetX:u.x,targetY:u.y,targetPosition:p};switch(t){case a.ConnectionLineType.Bezier:[x]=(0,a.getBezierPath)(y);break;case a.ConnectionLineType.SimpleBezier:[x]=eK(y);break;case a.ConnectionLineType.Step:[x]=(0,a.getSmoothStepPath)({...y,borderRadius:0});break;case a.ConnectionLineType.SmoothStep:[x]=(0,a.getSmoothStepPath)(y);break;default:[x]=(0,a.getStraightPath)(y)}return(0,o.jsx)("path",{d:x,fill:"none",className:"react-flow__connection-path",style:e})};th.displayName="ConnectionLine";let tp={};function tf(e=tp){(0,i.useRef)(e),w(),(0,i.useEffect)(()=>{},[e])}function tm({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:a,onNodeDoubleClick:s,onEdgeDoubleClick:l,onNodeMouseEnter:d,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:g,onSelectionContextMenu:h,onSelectionStart:p,onSelectionEnd:f,connectionLineType:m,connectionLineStyle:x,connectionLineComponent:y,connectionLineContainerStyle:v,selectionKeyCode:j,selectionOnDrag:C,selectionMode:S,multiSelectionKeyCode:k,panActivationKeyCode:_,zoomActivationKeyCode:R,deleteKeyCode:M,onlyRenderVisibleElements:I,elementsSelectable:E,defaultViewport:N,translateExtent:D,minZoom:T,maxZoom:P,preventScrolling:L,defaultMarkerColor:z,zoomOnScroll:B,zoomOnPinch:A,panOnScroll:O,panOnScrollSpeed:F,panOnScrollMode:V,zoomOnDoubleClick:$,panOnDrag:H,onPaneClick:G,onPaneMouseEnter:W,onPaneMouseMove:K,onPaneMouseLeave:Z,onPaneScroll:Q,onPaneContextMenu:q,paneClickDistance:U,nodeClickDistance:X,onEdgeContextMenu:Y,onEdgeMouseEnter:J,onEdgeMouseMove:ee,onEdgeMouseLeave:et,reconnectRadius:en,onReconnect:eo,onReconnectStart:ei,onReconnectEnd:er,noDragClassName:es,noWheelClassName:el,noPanClassName:ed,disableKeyboardA11y:ec,nodeExtent:eu,rfId:eg,viewport:eh,onViewportChange:ep}){let ef,em,ex,ey;return tf(e),tf(t),w(),(0,i.useRef)(!1),(0,i.useEffect)(()=>{},[]),ef=ea(),em=(0,i.useRef)(!1),(0,i.useEffect)(()=>{!em.current&&ef.viewportInitialized&&n&&(setTimeout(()=>n(ef),1),em.current=!0)},[n,ef.viewportInitialized]),ex=b(td),ey=w(),(0,i.useEffect)(()=>{eh&&(ex?.(eh),ey.setState({transform:[eh.x,eh.y,eh.zoom]}))},[eh,ex]),(0,o.jsx)(eD,{onPaneClick:G,onPaneMouseEnter:W,onPaneMouseMove:K,onPaneMouseLeave:Z,onPaneContextMenu:q,onPaneScroll:Q,paneClickDistance:U,deleteKeyCode:M,selectionKeyCode:j,selectionOnDrag:C,selectionMode:S,onSelectionStart:p,onSelectionEnd:f,multiSelectionKeyCode:k,panActivationKeyCode:_,zoomActivationKeyCode:R,elementsSelectable:E,zoomOnScroll:B,zoomOnPinch:A,zoomOnDoubleClick:$,panOnScroll:O,panOnScrollSpeed:F,panOnScrollMode:V,panOnDrag:H,defaultViewport:N,translateExtent:D,minZoom:T,maxZoom:P,onSelectionContextMenu:h,preventScrolling:L,noDragClassName:es,noWheelClassName:el,noPanClassName:ed,disableKeyboardA11y:ec,onViewportChange:ep,isControlledViewport:!!eh,children:(0,o.jsxs)(tl,{children:[(0,o.jsx)(ta,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:l,onReconnect:eo,onReconnectStart:ei,onReconnectEnd:er,onlyRenderVisibleElements:I,onEdgeContextMenu:Y,onEdgeMouseEnter:J,onEdgeMouseMove:ee,onEdgeMouseLeave:et,reconnectRadius:en,defaultMarkerColor:z,noPanClassName:ed,disableKeyboardA11y:ec,rfId:eg}),(0,o.jsx)(tg,{style:x,type:m,component:y,containerStyle:v}),(0,o.jsx)("div",{className:"react-flow__edgelabel-renderer"}),(0,o.jsx)(eB,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:s,onNodeMouseEnter:d,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:g,nodeClickDistance:X,onlyRenderVisibleElements:I,noPanClassName:ed,noDragClassName:es,disableKeyboardA11y:ec,nodeExtent:eu,rfId:eg}),(0,o.jsx)("div",{className:"react-flow__viewport-portal"})]})})}tm.displayName="GraphView";let tx=(0,i.memo)(tm),ty=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:i,height:r,fitView:s,fitViewOptions:l,minZoom:d=.5,maxZoom:c=2,nodeOrigin:u,nodeExtent:g}={})=>{let h=new Map,p=new Map,f=new Map,m=new Map,x=o??t??[],y=n??e??[],b=u??[0,0],w=g??a.infiniteExtent;(0,a.updateConnectionLookup)(f,m,x);let v=(0,a.adoptUserNodes)(y,h,p,{nodeOrigin:b,nodeExtent:w,elevateNodesOnSelect:!1}),j=[0,0,1];if(s&&i&&r){let e=(0,a.getInternalNodesBounds)(h,{filter:e=>!!((e.width||e.initialWidth)&&(e.height||e.initialHeight))}),{x:t,y:n,zoom:o}=(0,a.getViewportForBounds)(e,i,r,d,c,l?.padding??.1);j=[t,n,o]}return{rfId:"1",width:i??0,height:r??0,transform:j,nodes:y,nodesInitialized:v,nodeLookup:h,parentLookup:p,edges:x,edgeLookup:m,connectionLookup:f,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:void 0!==n,hasDefaultEdges:void 0!==o,panZoom:null,minZoom:d,maxZoom:c,translateExtent:a.infiniteExtent,nodeExtent:w,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:a.ConnectionMode.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:b,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:s??!1,fitViewOptions:l,fitViewResolver:null,connection:{...a.initialConnection},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:a.devWarn,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:a.defaultAriaLabelConfig}};function tb({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:s,initialHeight:l,initialMinZoom:d,initialMaxZoom:c,initialFitViewOptions:u,fitView:g,nodeOrigin:h,nodeExtent:f,children:m}){let[y]=(0,i.useState)(()=>(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:i,height:r,fitView:s,fitViewOptions:l,minZoom:d,maxZoom:c,nodeOrigin:u,nodeExtent:g})=>{let h,f;return h=(h,p)=>{async function f(){let{nodeLookup:e,panZoom:t,fitViewOptions:n,fitViewResolver:o,width:i,height:r,minZoom:s,maxZoom:l}=p();t&&(await (0,a.fitViewport)({nodes:e,width:i,height:r,panZoom:t,minZoom:s,maxZoom:l},n),o?.resolve(!0),h({fitViewResolver:null}))}return{...ty({nodes:e,edges:t,width:i,height:r,fitView:s,fitViewOptions:l,minZoom:d,maxZoom:c,nodeOrigin:u,nodeExtent:g,defaultNodes:n,defaultEdges:o}),setNodes:e=>{let{nodeLookup:t,parentLookup:n,nodeOrigin:o,elevateNodesOnSelect:i,fitViewQueued:r}=p(),s=(0,a.adoptUserNodes)(e,t,n,{nodeOrigin:o,nodeExtent:g,elevateNodesOnSelect:i,checkEquality:!0});r&&s?(f(),h({nodes:e,nodesInitialized:s,fitViewQueued:!1,fitViewOptions:void 0})):h({nodes:e,nodesInitialized:s})},setEdges:e=>{let{connectionLookup:t,edgeLookup:n}=p();(0,a.updateConnectionLookup)(t,n,e),h({edges:e})},setDefaultNodesAndEdges:(e,t)=>{if(e){let{setNodes:t}=p();t(e),h({hasDefaultNodes:!0})}if(t){let{setEdges:e}=p();e(t),h({hasDefaultEdges:!0})}},updateNodeInternals:e=>{let{triggerNodeChanges:t,nodeLookup:n,parentLookup:o,domNode:i,nodeOrigin:r,nodeExtent:s,debug:l,fitViewQueued:d}=p(),{changes:c,updatedInternals:u}=(0,a.updateNodeInternals)(e,n,o,i,r,s);u&&((0,a.updateAbsolutePositions)(n,o,{nodeOrigin:r,nodeExtent:s}),d?(f(),h({fitViewQueued:!1,fitViewOptions:void 0})):h({}),c?.length>0&&(l&&console.log("React Flow: trigger node changes",c),t?.(c)))},updateNodePositions:(e,t=!1)=>{let n=[],o=[],{nodeLookup:i,triggerNodeChanges:r}=p();for(let[r,a]of e){let e=i.get(r),s=!!(e?.expandParent&&e?.parentId&&a?.position),l={id:r,type:"position",position:s?{x:Math.max(0,a.position.x),y:Math.max(0,a.position.y)}:a.position,dragging:t};s&&e.parentId&&n.push({id:r,parentId:e.parentId,rect:{...a.internals.positionAbsolute,width:a.measured.width??0,height:a.measured.height??0}}),o.push(l)}if(n.length>0){let{parentLookup:e,nodeOrigin:t}=p(),r=(0,a.handleExpandParent)(n,i,e,t);o.push(...r)}r(o)},triggerNodeChanges:e=>{let{onNodesChange:t,setNodes:n,nodes:o,hasDefaultNodes:i,debug:r}=p();e?.length&&(i&&n(Q(e,o)),r&&console.log("React Flow: trigger node changes",e),t?.(e))},triggerEdgeChanges:e=>{let{onEdgesChange:t,setEdges:n,edges:o,hasDefaultEdges:i,debug:r}=p();e?.length&&(i&&n(Q(e,o)),r&&console.log("React Flow: trigger edge changes",e),t?.(e))},addSelectedNodes:e=>{let{multiSelectionActive:t,edgeLookup:n,nodeLookup:o,triggerNodeChanges:i,triggerEdgeChanges:r}=p();t?i(e.map(e=>q(e,!0))):(i(U(o,new Set([...e]),!0)),r(U(n)))},addSelectedEdges:e=>{let{multiSelectionActive:t,edgeLookup:n,nodeLookup:o,triggerNodeChanges:i,triggerEdgeChanges:r}=p();t?r(e.map(e=>q(e,!0))):(r(U(n,new Set([...e]))),i(U(o,new Set,!0)))},unselectNodesAndEdges:({nodes:e,edges:t}={})=>{let{edges:n,nodes:o,nodeLookup:i,triggerNodeChanges:r,triggerEdgeChanges:a}=p(),s=(e||o).map(e=>{let t=i.get(e.id);return t&&(t.selected=!1),q(e.id,!1)}),l=(t||n).map(e=>q(e.id,!1));r(s),a(l)},setMinZoom:e=>{let{panZoom:t,maxZoom:n}=p();t?.setScaleExtent([e,n]),h({minZoom:e})},setMaxZoom:e=>{let{panZoom:t,minZoom:n}=p();t?.setScaleExtent([n,e]),h({maxZoom:e})},setTranslateExtent:e=>{p().panZoom?.setTranslateExtent(e),h({translateExtent:e})},resetSelectedElements:()=>{let{edges:e,nodes:t,triggerNodeChanges:n,triggerEdgeChanges:o,elementsSelectable:i}=p();if(!i)return;let r=t.reduce((e,t)=>t.selected?[...e,q(t.id,!1)]:e,[]),a=e.reduce((e,t)=>t.selected?[...e,q(t.id,!1)]:e,[]);n(r),o(a)},setNodeExtent:e=>{let{nodes:t,nodeLookup:n,parentLookup:o,nodeOrigin:i,elevateNodesOnSelect:r,nodeExtent:s}=p();(e[0][0]!==s[0][0]||e[0][1]!==s[0][1]||e[1][0]!==s[1][0]||e[1][1]!==s[1][1])&&((0,a.adoptUserNodes)(t,n,o,{nodeOrigin:i,nodeExtent:e,elevateNodesOnSelect:r,checkEquality:!1}),h({nodeExtent:e}))},panBy:e=>{let{transform:t,width:n,height:o,panZoom:i,translateExtent:r}=p();return(0,a.panBy)({delta:e,panZoom:i,transform:t,translateExtent:r,width:n,height:o})},setCenter:async(e,t,n)=>{let{width:o,height:i,maxZoom:r,panZoom:a}=p();if(!a)return Promise.resolve(!1);let s=void 0!==n?.zoom?n.zoom:r;return await a.setViewport({x:o/2-e*s,y:i/2-t*s,zoom:s},{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{h({connection:{...a.initialConnection}})},updateConnection:e=>{h({connection:e})},reset:()=>h({...ty()})}},f=Object.is,h?p(h,f):p})({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:s,height:l,fitView:g,minZoom:d,maxZoom:c,fitViewOptions:u,nodeOrigin:h,nodeExtent:f}));return(0,o.jsx)(x,{value:y,children:(0,o.jsx)(ei,{children:m})})}function tw({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:a,width:s,height:l,fitView:d,fitViewOptions:c,minZoom:u,maxZoom:g,nodeOrigin:h,nodeExtent:p}){return(0,i.useContext)(m)?(0,o.jsx)(o.Fragment,{children:e}):(0,o.jsx)(tb,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:a,initialWidth:s,initialHeight:l,fitView:d,initialFitViewOptions:c,initialMinZoom:u,initialMaxZoom:g,nodeOrigin:h,nodeExtent:p,children:e})}let tv={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};var tj=ee(function({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,className:l,nodeTypes:d,edgeTypes:c,onNodeClick:u,onEdgeClick:g,onInit:h,onMove:p,onMoveStart:f,onMoveEnd:m,onConnect:x,onConnectStart:y,onConnectEnd:b,onClickConnectStart:w,onClickConnectEnd:v,onNodeMouseEnter:j,onNodeMouseMove:C,onNodeMouseLeave:S,onNodeContextMenu:k,onNodeDoubleClick:_,onNodeDragStart:R,onNodeDrag:I,onNodeDragStop:N,onNodesDelete:D,onEdgesDelete:T,onDelete:P,onSelectionChange:L,onSelectionDragStart:O,onSelectionDrag:F,onSelectionDragStop:V,onSelectionContextMenu:G,onSelectionStart:W,onSelectionEnd:K,onBeforeDelete:Z,connectionMode:Q,connectionLineType:q=a.ConnectionLineType.Bezier,connectionLineStyle:U,connectionLineComponent:X,connectionLineContainerStyle:Y,deleteKeyCode:J="Backspace",selectionKeyCode:ee="Shift",selectionOnDrag:et=!1,selectionMode:en=a.SelectionMode.Full,panActivationKeyCode:eo="Space",multiSelectionKeyCode:ei=(0,a.isMacOs)()?"Meta":"Control",zoomActivationKeyCode:er=(0,a.isMacOs)()?"Meta":"Control",snapToGrid:ea,snapGrid:es,onlyRenderVisibleElements:el=!1,selectNodesOnDrag:ed,nodesDraggable:ec,autoPanOnNodeFocus:eu,nodesConnectable:eg,nodesFocusable:eh,nodeOrigin:ep=B,edgesFocusable:ef,edgesReconnectable:em,elementsSelectable:ex=!0,defaultViewport:ey=A,minZoom:eb=.5,maxZoom:ew=2,translateExtent:ev=a.infiniteExtent,preventScrolling:ej=!0,nodeExtent:eC,defaultMarkerColor:eS="#b1b1b7",zoomOnScroll:ek=!0,zoomOnPinch:e_=!0,panOnScroll:eR=!1,panOnScrollSpeed:eM=.5,panOnScrollMode:eI=a.PanOnScrollMode.Free,zoomOnDoubleClick:eE=!0,panOnDrag:eN=!0,onPaneClick:eD,onPaneMouseEnter:eT,onPaneMouseMove:eP,onPaneMouseLeave:eL,onPaneScroll:ez,onPaneContextMenu:eB,paneClickDistance:eA=1,nodeClickDistance:eO=0,children:eF,onReconnect:eV,onReconnectStart:e$,onReconnectEnd:eH,onEdgeContextMenu:eG,onEdgeDoubleClick:eW,onEdgeMouseEnter:eK,onEdgeMouseMove:eZ,onEdgeMouseLeave:eQ,reconnectRadius:eq=10,onNodesChange:eU,onEdgesChange:eX,noDragClassName:eY="nodrag",noWheelClassName:eJ="nowheel",noPanClassName:e0="nopan",fitView:e1,fitViewOptions:e2,connectOnClick:e3,attributionPosition:e5,proOptions:e4,defaultEdgeOptions:e8,elevateNodesOnSelect:e6,elevateEdgesOnSelect:e7,disableKeyboardA11y:e9=!1,autoPanOnConnect:te,autoPanOnNodeDrag:tt,autoPanSpeed:tn,connectionRadius:to,isValidConnection:ti,onError:tr,style:ta,id:ts,nodeDragThreshold:tl,connectionDragThreshold:td,viewport:tc,onViewportChange:tu,width:tg,height:th,colorMode:tp="light",debug:tf,onScroll:tm,ariaLabelConfig:ty,...tb},tj){let tC=ts||"1",tS=function(e){let[t,n]=(0,i.useState)("system"===e?null:e);return(0,i.useEffect)(()=>{if("system"!==e)return void n(e);let t=H(),o=()=>n(t?.matches?"dark":"light");return o(),t?.addEventListener("change",o),()=>{t?.removeEventListener("change",o)}},[e]),null!==t?t:H()?.matches?"dark":"light"}(tp),tk=(0,i.useCallback)(e=>{e.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),tm?.(e)},[tm]);return(0,o.jsx)("div",{"data-testid":"rf__wrapper",...tb,onScroll:tk,style:{...ta,...tv},ref:tj,className:r(["react-flow",l,tS]),id:ts,role:"application",children:(0,o.jsxs)(tw,{nodes:e,edges:t,width:tg,height:th,fitView:e1,fitViewOptions:e2,minZoom:eb,maxZoom:ew,nodeOrigin:ep,nodeExtent:eC,children:[(0,o.jsx)(tx,{onInit:h,onNodeClick:u,onEdgeClick:g,onNodeMouseEnter:j,onNodeMouseMove:C,onNodeMouseLeave:S,onNodeContextMenu:k,onNodeDoubleClick:_,nodeTypes:d,edgeTypes:c,connectionLineType:q,connectionLineStyle:U,connectionLineComponent:X,connectionLineContainerStyle:Y,selectionKeyCode:ee,selectionOnDrag:et,selectionMode:en,deleteKeyCode:J,multiSelectionKeyCode:ei,panActivationKeyCode:eo,zoomActivationKeyCode:er,onlyRenderVisibleElements:el,defaultViewport:ey,translateExtent:ev,minZoom:eb,maxZoom:ew,preventScrolling:ej,zoomOnScroll:ek,zoomOnPinch:e_,zoomOnDoubleClick:eE,panOnScroll:eR,panOnScrollSpeed:eM,panOnScrollMode:eI,panOnDrag:eN,onPaneClick:eD,onPaneMouseEnter:eT,onPaneMouseMove:eP,onPaneMouseLeave:eL,onPaneScroll:ez,onPaneContextMenu:eB,paneClickDistance:eA,nodeClickDistance:eO,onSelectionContextMenu:G,onSelectionStart:W,onSelectionEnd:K,onReconnect:eV,onReconnectStart:e$,onReconnectEnd:eH,onEdgeContextMenu:eG,onEdgeDoubleClick:eW,onEdgeMouseEnter:eK,onEdgeMouseMove:eZ,onEdgeMouseLeave:eQ,reconnectRadius:eq,defaultMarkerColor:eS,noDragClassName:eY,noWheelClassName:eJ,noPanClassName:e0,rfId:tC,disableKeyboardA11y:e9,nodeExtent:eC,viewport:tc,onViewportChange:tu}),(0,o.jsx)($,{nodes:e,edges:t,defaultNodes:n,defaultEdges:s,onConnect:x,onConnectStart:y,onConnectEnd:b,onClickConnectStart:w,onClickConnectEnd:v,nodesDraggable:ec,autoPanOnNodeFocus:eu,nodesConnectable:eg,nodesFocusable:eh,edgesFocusable:ef,edgesReconnectable:em,elementsSelectable:ex,elevateNodesOnSelect:e6,elevateEdgesOnSelect:e7,minZoom:eb,maxZoom:ew,nodeExtent:eC,onNodesChange:eU,onEdgesChange:eX,snapToGrid:ea,snapGrid:es,connectionMode:Q,translateExtent:ev,connectOnClick:e3,defaultEdgeOptions:e8,fitView:e1,fitViewOptions:e2,onNodesDelete:D,onEdgesDelete:T,onDelete:P,onNodeDragStart:R,onNodeDrag:I,onNodeDragStop:N,onSelectionDrag:F,onSelectionDragStart:O,onSelectionDragStop:V,onMove:p,onMoveStart:f,onMoveEnd:m,noPanClassName:e0,nodeOrigin:ep,rfId:tC,autoPanOnConnect:te,autoPanOnNodeDrag:tt,autoPanSpeed:tn,onError:tr,connectionRadius:to,isValidConnection:ti,selectNodesOnDrag:ed,nodeDragThreshold:tl,connectionDragThreshold:td,onBeforeDelete:Z,debug:tf,ariaLabelConfig:ty}),(0,o.jsx)(z,{onSelectionChange:L}),eF,(0,o.jsx)(E,{proOptions:e4,position:e5}),(0,o.jsx)(M,{rfId:tC,disableKeyboardA11y:e9})]})})});function tC(e){let[t,n]=(0,i.useState)(e),o=(0,i.useCallback)(e=>n(t=>Q(e,t)),[]);return[t,n,o]}function tS(e){let[t,n]=(0,i.useState)(e),o=(0,i.useCallback)(e=>n(t=>Q(e,t)),[]);return[t,n,o]}function tk({dimensions:e,lineWidth:t,variant:n,className:i}){return(0,o.jsx)("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:r(["react-flow__background-pattern",n,i])})}function t_({radius:e,className:t}){return(0,o.jsx)("circle",{cx:e,cy:e,r:e,className:r(["react-flow__background-pattern","dots",t])})}a.errorMessages.error014(),(t=n||(n={})).Lines="lines",t.Dots="dots",t.Cross="cross";let tR={[n.Dots]:1,[n.Lines]:1,[n.Cross]:6},tM=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function tI({id:e,variant:t=n.Dots,gap:a=20,size:s,lineWidth:l=1,offset:d=0,color:c,bgColor:u,style:g,className:h,patternClassName:p}){let m=(0,i.useRef)(null),{transform:x,patternId:y}=b(tM,f),w=s||tR[t],v=t===n.Dots,j=t===n.Cross,C=Array.isArray(a)?a:[a,a],S=[C[0]*x[2]||1,C[1]*x[2]||1],k=w*x[2],_=Array.isArray(d)?d:[d,d],R=j?[k,k]:S,M=[_[0]*x[2]||1+R[0]/2,_[1]*x[2]||1+R[1]/2],I=`${y}${e||""}`;return(0,o.jsxs)("svg",{className:r(["react-flow__background",h]),style:{...g,...ed,"--xy-background-color-props":u,"--xy-background-pattern-color-props":c},ref:m,"data-testid":"rf__background",children:[(0,o.jsx)("pattern",{id:I,x:x[0]%S[0],y:x[1]%S[1],width:S[0],height:S[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${M[0]},-${M[1]})`,children:v?(0,o.jsx)(t_,{radius:k/2,className:p}):(0,o.jsx)(tk,{dimensions:R,lineWidth:l,variant:t,className:p})}),(0,o.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${I})`})]})}tI.displayName="Background";let tE=(0,i.memo)(tI);function tN(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:(0,o.jsx)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function tD(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:(0,o.jsx)("path",{d:"M0 0h32v4.2H0z"})})}function tT(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:(0,o.jsx)("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function tP(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,o.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function tL(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,o.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function tz({children:e,className:t,...n}){return(0,o.jsx)("button",{type:"button",className:r(["react-flow__controls-button",t]),...n,children:e})}let tB=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function tA({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:i=!0,fitViewOptions:a,onZoomIn:s,onZoomOut:l,onFitView:d,onInteractiveChange:c,className:u,children:g,position:h="bottom-left",orientation:p="vertical","aria-label":m}){let x=w(),{isInteractive:y,minZoomReached:v,maxZoomReached:j,ariaLabelConfig:C}=b(tB,f),{zoomIn:S,zoomOut:k,fitView:_}=ea();return(0,o.jsxs)(I,{className:r(["react-flow__controls","horizontal"===p?"horizontal":"vertical",u]),position:h,style:e,"data-testid":"rf__controls","aria-label":m??C["controls.ariaLabel"],children:[t&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tz,{onClick:()=>{S(),s?.()},className:"react-flow__controls-zoomin",title:C["controls.zoomIn.ariaLabel"],"aria-label":C["controls.zoomIn.ariaLabel"],disabled:j,children:(0,o.jsx)(tN,{})}),(0,o.jsx)(tz,{onClick:()=>{k(),l?.()},className:"react-flow__controls-zoomout",title:C["controls.zoomOut.ariaLabel"],"aria-label":C["controls.zoomOut.ariaLabel"],disabled:v,children:(0,o.jsx)(tD,{})})]}),n&&(0,o.jsx)(tz,{className:"react-flow__controls-fitview",onClick:()=>{_(a),d?.()},title:C["controls.fitView.ariaLabel"],"aria-label":C["controls.fitView.ariaLabel"],children:(0,o.jsx)(tT,{})}),i&&(0,o.jsx)(tz,{className:"react-flow__controls-interactive",onClick:()=>{x.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),c?.(!y)},title:C["controls.interactive.ariaLabel"],"aria-label":C["controls.interactive.ariaLabel"],children:y?(0,o.jsx)(tL,{}):(0,o.jsx)(tP,{})}),g]})}tA.displayName="Controls";let tO=(0,i.memo)(tA),tF=(0,i.memo)(function({id:e,x:t,y:n,width:i,height:a,style:s,color:l,strokeColor:d,strokeWidth:c,className:u,borderRadius:g,shapeRendering:h,selected:p,onClick:f}){let{background:m,backgroundColor:x}=s||{};return(0,o.jsx)("rect",{className:r(["react-flow__minimap-node",{selected:p},u]),x:t,y:n,rx:g,ry:g,width:i,height:a,style:{fill:l||m||x,stroke:d,strokeWidth:c},shapeRendering:h,onClick:f?t=>f(t,e):void 0})}),tV=e=>e.nodes.map(e=>e.id),t$=e=>e instanceof Function?e:()=>e,tH=(0,i.memo)(function({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:i,nodeBorderRadius:r,nodeStrokeWidth:s,shapeRendering:l,NodeComponent:d,onClick:c}){let{node:u,x:g,y:h,width:p,height:m}=b(t=>{let{internals:n}=t.nodeLookup.get(e),o=n.userNode,{x:i,y:r}=n.positionAbsolute,{width:s,height:l}=(0,a.getNodeDimensions)(o);return{node:o,x:i,y:r,width:s,height:l}},f);return u&&!u.hidden&&(0,a.nodeHasDimensions)(u)?(0,o.jsx)(d,{x:g,y:h,width:p,height:m,style:u.style,selected:!!u.selected,className:i(u),color:t(u),borderRadius:r,strokeColor:n(u),strokeWidth:s,shapeRendering:l,onClick:c,id:u.id}):null});var tG=(0,i.memo)(function({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:i=5,nodeStrokeWidth:r,nodeComponent:a=tF,onClick:s}){let l=b(tV,f),d=t$(t),c=t$(e),u=t$(n),g="undefined"==typeof window||window.chrome?"crispEdges":"geometricPrecision";return(0,o.jsx)(o.Fragment,{children:l.map(e=>(0,o.jsx)(tH,{id:e,nodeColorFunc:d,nodeStrokeColorFunc:c,nodeClassNameFunc:u,nodeBorderRadius:i,nodeStrokeWidth:r,NodeComponent:a,onClick:s,shapeRendering:g},e))})});let tW=e=>!e.hidden,tK=e=>{let t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?(0,a.getBoundsOfRects)((0,a.getInternalNodesBounds)(e.nodeLookup,{filter:tW}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}};function tZ({style:e,className:t,nodeStrokeColor:n,nodeColor:s,nodeClassName:l="",nodeBorderRadius:d=5,nodeStrokeWidth:c,nodeComponent:u,bgColor:g,maskColor:h,maskStrokeColor:p,maskStrokeWidth:m,position:x="bottom-right",onClick:y,onNodeClick:v,pannable:j=!1,zoomable:C=!1,ariaLabel:S,inversePan:k,zoomStep:_=1,offsetScale:R=5}){let M=w(),E=(0,i.useRef)(null),{boundingRect:N,viewBB:D,rfId:T,panZoom:P,translateExtent:L,flowWidth:z,flowHeight:B,ariaLabelConfig:A}=b(tK,f),O=e?.width??200,F=e?.height??150,V=Math.max(N.width/O,N.height/F),$=V*O,H=V*F,G=R*V,W=N.x-($-N.width)/2-G,K=N.y-(H-N.height)/2-G,Z=$+2*G,Q=H+2*G,q=`react-flow__minimap-desc-${T}`,U=(0,i.useRef)(0),X=(0,i.useRef)();U.current=V,(0,i.useEffect)(()=>{if(E.current&&P)return X.current=(0,a.XYMinimap)({domNode:E.current,panZoom:P,getTransform:()=>M.getState().transform,getViewScale:()=>U.current}),()=>{X.current?.destroy()}},[P]),(0,i.useEffect)(()=>{X.current?.update({translateExtent:L,width:z,height:B,inversePan:k,pannable:j,zoomStep:_,zoomable:C})},[j,C,k,_,L,z,B]);let Y=y?e=>{let[t,n]=X.current?.pointer(e)||[0,0];y(e,{x:t,y:n})}:void 0,J=v?(0,i.useCallback)((e,t)=>{v(e,M.getState().nodeLookup.get(t).internals.userNode)},[]):void 0,ee=S??A["minimap.ariaLabel"];return(0,o.jsx)(I,{position:x,style:{...e,"--xy-minimap-background-color-props":"string"==typeof g?g:void 0,"--xy-minimap-mask-background-color-props":"string"==typeof h?h:void 0,"--xy-minimap-mask-stroke-color-props":"string"==typeof p?p:void 0,"--xy-minimap-mask-stroke-width-props":"number"==typeof m?m*V:void 0,"--xy-minimap-node-background-color-props":"string"==typeof s?s:void 0,"--xy-minimap-node-stroke-color-props":"string"==typeof n?n:void 0,"--xy-minimap-node-stroke-width-props":"number"==typeof c?c:void 0},className:r(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:(0,o.jsxs)("svg",{width:O,height:F,viewBox:`${W} ${K} ${Z} ${Q}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":q,ref:E,onClick:Y,children:[ee&&(0,o.jsx)("title",{id:q,children:ee}),(0,o.jsx)(tG,{onClick:J,nodeColor:s,nodeStrokeColor:n,nodeBorderRadius:d,nodeClassName:l,nodeStrokeWidth:c,nodeComponent:u}),(0,o.jsx)("path",{className:"react-flow__minimap-mask",d:`M${W-G},${K-G}h${Z+2*G}v${Q+2*G}h${-Z-2*G}z
        M${D.x},${D.y}h${D.width}v${D.height}h${-D.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}tZ.displayName="MiniMap";let tQ=(0,i.memo)(tZ),tq={[a.ResizeControlVariant.Line]:"right",[a.ResizeControlVariant.Handle]:"bottom-right"};(0,i.memo)(function({nodeId:e,position:t,variant:n=a.ResizeControlVariant.Handle,className:s,style:l,children:d,color:c,minWidth:u=10,minHeight:g=10,maxWidth:h=Number.MAX_VALUE,maxHeight:p=Number.MAX_VALUE,keepAspectRatio:m=!1,resizeDirection:x,autoScale:y=!0,shouldResize:v,onResizeStart:j,onResize:C,onResizeEnd:S}){let k,_=ej(),R="string"==typeof e?e:_,M=w(),I=(0,i.useRef)(null),E=n===a.ResizeControlVariant.Handle,N=b((0,i.useCallback)((k=E&&y,e=>k?`${Math.max(1/e.transform[2],1)}`:void 0),[E,y]),f),D=(0,i.useRef)(null),T=t??tq[n];(0,i.useEffect)(()=>{if(I.current&&R)return D.current||(D.current=(0,a.XYResizer)({domNode:I.current,nodeId:R,getStoreItems:()=>{let{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:o,nodeOrigin:i,domNode:r}=M.getState();return{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:o,nodeOrigin:i,paneDomNode:r}},onChange:(e,t)=>{let{triggerNodeChanges:n,nodeLookup:o,parentLookup:i,nodeOrigin:r}=M.getState(),s=[],l={x:e.x,y:e.y},d=o.get(R);if(d&&d.expandParent&&d.parentId){let t=d.origin??r,n=e.width??d.measured.width??0,c=e.height??d.measured.height??0,u={id:d.id,parentId:d.parentId,rect:{width:n,height:c,...(0,a.evaluateAbsolutePosition)({x:e.x??d.position.x,y:e.y??d.position.y},{width:n,height:c},d.parentId,o,t)}},g=(0,a.handleExpandParent)([u],o,i,r);s.push(...g),l.x=e.x?Math.max(t[0]*n,e.x):void 0,l.y=e.y?Math.max(t[1]*c,e.y):void 0}if(void 0!==l.x&&void 0!==l.y){let e={id:R,type:"position",position:{...l}};s.push(e)}if(void 0!==e.width&&void 0!==e.height){let t={id:R,type:"dimensions",resizing:!0,setAttributes:!x||("horizontal"===x?"width":"height"),dimensions:{width:e.width,height:e.height}};s.push(t)}for(let e of t){let t={...e,type:"position"};s.push(t)}n(s)},onEnd:({width:e,height:t})=>{M.getState().triggerNodeChanges([{id:R,type:"dimensions",resizing:!1,dimensions:{width:e,height:t}}])}})),D.current.update({controlPosition:T,boundaries:{minWidth:u,minHeight:g,maxWidth:h,maxHeight:p},keepAspectRatio:m,resizeDirection:x,onResizeStart:j,onResize:C,onResizeEnd:S,shouldResize:v}),()=>{D.current?.destroy()}},[T,u,g,h,p,m,j,C,S,v]);let P=T.split("-");return(0,o.jsx)("div",{className:r(["react-flow__resize-control","nodrag",...P,n,s]),ref:I,style:{...l,scale:N,...c&&{[E?"backgroundColor":"borderColor"]:c}},children:d})}),e.s(["Background",()=>tE,"BaseEdge",()=>eG,"ControlButton",()=>tz,"Controls",()=>tO,"Handle",()=>eS,"MiniMap",()=>tQ,"Panel",()=>I,"ReactFlow",()=>tj,"ReactFlowProvider",()=>tb,"useEdgesState",()=>tS,"useNodesState",()=>tC,"useReactFlow",()=>ea,"useStore",()=>b],785546);let tU=(0,e.i(639967).chakra)("div",{base:{borderWidth:0,alignSelf:"stretch",borderColor:"inherit",width:"auto",height:"auto"}});tU.displayName="StackSeparator",e.s(["StackSeparator",()=>tU],407275);var tX=e.i(705443);async function tY(e){return(await tX.axiosClient.post("/api/cll",e)).data}async function tJ(e){return(await tX.axiosClient.post("/api/checks",{type:"lineage_diff",params:{},view_options:e})).data}async function t0(e){return(await tX.axiosClient.post("/api/checks",{type:"schema_diff",params:e})).data}async function t1(e){return(await tX.axiosClient.post("/api/select",e)).data}e.s(["getCll",()=>tY],953131),e.s(["createLineageDiffCheck",()=>tJ],323194),e.s(["createSchemaDiffCheck",()=>t0],987923),e.s(["select",()=>t1],2216);var t2=e.i(672235),t3=e.i(960503),t5=e.i(862744);let t4=(0,i.createContext)(void 0),t8=()=>{let e=(0,i.useContext)(t4);if(!e)throw Error("useLineageViewContext must be used within a LineageViewProvider");return e};function t6({onClose:e}){let{cancel:t,actionState:n}=t8();return(0,o.jsx)(t2.Box,{bg:"white",rounded:"md",shadow:"dark-lg",children:(0,o.jsxs)(t5.HStack,{p:"5px 15px",mt:"4",separator:(0,o.jsx)(tU,{borderColor:"gray.200"}),gap:4,children:[(0,o.jsxs)(t2.Box,{fontSize:"10pt",children:["Progress: ","per_node"===n.mode?`${n.completed} / ${n.total}`:n.currentRun?.progress?.percentage?`${100*n.currentRun.progress.percentage}%`:"completed"===n.status?"100%":"0%"," ","canceled"===n.status?" (canceled)":""]}),"running"===n.status||"canceling"===n.status?(0,o.jsx)(t3.Button,{size:"xs",variant:"outline",onClick:t,loading:"canceling"===n.status,loadingText:"Canceling",children:"Cancel"}):(0,o.jsx)(t5.HStack,{children:(0,o.jsx)(t3.Button,{size:"xs",variant:"outline",onClick:e,children:"Close"})})]})})}e.s(["LineageViewContext",0,t4,"useLineageViewContext",0,()=>(0,i.useContext)(t4),"useLineageViewContextSafe",0,t8],187726),e.s(["ActionControl",()=>t6],525519);var t7=e.i(312295),t9=e.i(176609),ne=e.i(746798),nt=e.i(68768),nn=e.i(667401),no=e.i(954307),ni=e.i(599180);let nr=no.VscDiffAdded,na=no.VscDiffRemoved,ns=no.VscDiffModified;function nl(e){return"added"===e?{color:"green.solid",hexColor:String(ni.system.token("colors.green.solid")),backgroundColor:"green.subtle",hexBackgroundColor:String(ni.system.token("colors.green.subtle")),icon:nr}:"removed"===e?{color:"red.solid",hexColor:String(ni.system.token("colors.red.solid")),backgroundColor:"red.subtle",hexBackgroundColor:String(ni.system.token("colors.red.subtle")),icon:na}:"modified"===e?{color:"orange.emphasized",hexColor:String(ni.system.token("colors.orange.emphasized")),backgroundColor:"orange.subtle",hexBackgroundColor:String(ni.system.token("colors.orange.subtle")),icon:ns}:{color:"gray.focusRing",hexColor:String(ni.system.token("colors.gray.focusRing")),backgroundColor:"white",hexBackgroundColor:String(ni.system.token("colors.white")),icon:void 0}}function nd(e){if("model"===e)return{color:String(ni.system.token("colors.cyan.subtle")),icon:nt.FaCube};if("metric"===e)return{color:String(ni.system.token("colors.rose.subtle")),icon:nn.FaChartSimple};if("source"===e)return{color:String(ni.system.token("colors.green.muted")),icon:nt.FaDatabase};if("exposure"===e)return{color:String(ni.system.token("colors.rose.subtle")),icon:nn.FaGauge};if("semantic_model"===e)return{color:String(ni.system.token("colors.rose.focusRing")),icon:nn.FaCircleNodes};else if("seed"===e)return{color:String(ni.system.token("colors.green.emphasized")),icon:nt.FaSeedling};else if("snapshot"===e)return{color:String(ni.system.token("colors.green.emphasized")),icon:nt.FaCamera};else return{color:"inherit",icon:void 0}}function nc(){return(0,o.jsx)(t2.Box,{bg:"white",padding:"12px",borderWidth:"1px",borderColor:"gray.200",fontSize:"sm",children:Object.entries({added:["Added","Added resource"],removed:["Removed","Removed resource"],modified:["Modified","Modified resource"]}).map(([e,[t,n]])=>{let{icon:i,color:r}=nl(e);return(0,o.jsx)(ne.Tooltip,{content:n,positioning:{placement:"right"},children:(0,o.jsxs)(t7.Flex,{alignItems:"center",gap:"6px",marginBottom:"2px",children:[(0,o.jsx)(t9.Icon,{color:r,as:i})," ",t]})},e)})})}e.s(["getIconForChangeStatus",()=>nl,"getIconForResourceType",()=>nd],248859),e.s(["ChangeStatusLegend",()=>nc],88515);var nu=e.i(905301),ng=e.i(983849);e.i(705353),e.i(582286);var nh=e.i(808676),np=e.i(480322),nf=e.i(220116),nm=e.i(284827),nx=e.i(916955),ny=e.i(286568);let nb=()=>{let{lineageGraph:e}=(0,nx.useLineageGraphContext)(),{centerNode:t,viewOptions:n}=t8(),i=n.column_level_lineage;if(!e)return(0,o.jsx)(o.Fragment,{});if(!i)return"Default View";if(void 0===i.node_id)return(0,o.jsx)(nf.Text,{as:"span",children:"Impact Radius for All Changed Models"});let r=i.node_id in e.nodes?e.nodes[i.node_id].data.name:i.node_id;if(i.column){let e=`${i.node_id}_${i.column}`;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(nf.Text,{as:"span",mr:"5px",children:["Column Lineage for"," "]}),(0,o.jsxs)(nu.Code,{onClick:()=>{t(e)},cursor:"pointer",children:[r,".",i.column]})]})}{let e=i.node_id;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(nf.Text,{as:"span",mr:"5px",children:"Impact Radius for"}),(0,o.jsx)(nu.Code,{onClick:()=>{t(e)},cursor:"pointer",children:r})]})}};e.s(["ColumnLevelLineageControl",0,({action:e})=>{let{showColumnLevelLineage:t,resetColumnLevelLineage:n,interactive:i,viewOptions:r}=t8(),{data:a}=(0,ny.useRecceServerFlag)(),s=a?.single_env_onboarding??!1,{lineageGraph:l}=(0,nx.useLineageGraphContext)(),d=!l?.catalogMetadata.current;return(0,o.jsxs)(t7.Flex,{direction:"row",gap:"5px",children:[!s&&(0,o.jsx)(t2.Box,{borderRadius:"md",boxShadow:"md",border:"1px solid",borderColor:"gray.200",bg:"white",children:(0,o.jsx)(ne.Tooltip,{openDelay:50,content:"Please provide catalog.json to enable Impact Radius",disabled:!d,positioning:{placement:"top"},children:(0,o.jsxs)(t3.Button,{size:"sm",variant:"ghost",whiteSpace:"nowrap",display:"inline-flex",disabled:!i||d,onClick:()=>{t({no_upstream:!0,change_analysis:!0})},children:[(0,o.jsx)(nt.FaRegDotCircle,{})," Impact Radius"]})})}),r.column_level_lineage&&(0,o.jsxs)(t7.Flex,{borderRadius:"md",boxShadow:"md",border:"1px solid",borderColor:"gray.200",bg:"white",fontSize:"0.8rem",p:"0 0.625rem",alignItems:"center",children:[(0,o.jsx)(nb,{}),e.isError&&(0,o.jsx)(ne.Tooltip,{content:`Error: ${e.error.message}`,positioning:{placement:"bottom"},children:(0,o.jsx)(nf.Text,{as:"span",color:"red.500",ml:"2px",display:"inline-flex",alignItems:"center",children:(0,o.jsx)(t9.Icon,{as:nm.PiInfo,color:"red.500",boxSize:"14px"})})}),e.isPending?(0,o.jsx)(np.Spinner,{size:"xs",ml:"2px"}):(0,o.jsx)(ng.IconButton,{variant:"ghost",size:"xs",ml:"2px","aria-label":"Reset Column Level Lineage",onClick:()=>{n()},children:(0,o.jsx)(nm.PiX,{size:"10px"})})]})]})}],166598);var nw=e.i(706249),nv=e.i(513596),nj=e.i(523043);let nC=({changeStatus:e})=>{if(!e)return(0,o.jsx)(o.Fragment,{});let{color:t,icon:n}=nl(e);return(0,o.jsx)(t9.Icon,{boxSize:"14px",display:"inline-flex",color:t,as:n})},nS=({transformationType:e,legend:t})=>{let n="U",i="red";return("passthrough"===e?(n="P",i="gray"):"renamed"===e?(n="R",i="orange"):"derived"===e?(n="D",i="orange"):"source"===e?(n="S",i="blue"):(n="U",i="red"),e)?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(nv.Tag.Root,{fontSize:"8pt",size:"sm",colorPalette:i,borderRadius:"full",paddingX:"4px",children:(0,o.jsx)(nv.Tag.Label,{children:n})})}):(0,o.jsx)(o.Fragment,{})};function nk(e){let{id:t,data:n}=e,{id:r}=n.node,{column:s,type:l,transformationType:d,changeStatus:c}=n,u=b(e=>e.transform[2]>.3),{viewOptions:g,showContextMenu:h,isNodeHighlighted:p,isNodeShowingChangeAnalysis:f}=t8(),m=g.column_level_lineage?.node_id,x=s===g.column_level_lineage?.column&&r===m,[y,w]=i.default.useState(!1),v=p(t),j=f(r);return u?(0,o.jsxs)(t7.Flex,{width:"280px",padding:"0px 10px",border:"1px solid gray",backgroundColor:x?"#f0f0f0":"inherit",_hover:{backgroundColor:"#f0f0f0"},onMouseEnter:()=>{w(!0)},onMouseLeave:()=>{w(!1)},filter:v?"none":"opacity(0.2) grayscale(50%)",cursor:"pointer",children:[(0,o.jsxs)(t7.Flex,{fontSize:"11px",color:"black",width:"100%",gap:"3px",alignItems:"center",height:`${nj.COLUMN_HEIGHT-1}px`,children:[j&&c?(0,o.jsx)(nC,{changeStatus:c}):(0,o.jsx)(nS,{transformationType:d}),(0,o.jsx)(t2.Box,{height:`${nj.COLUMN_HEIGHT+1}px`,children:s}),(0,o.jsx)(nw.Spacer,{}),y?(0,o.jsx)(t9.Icon,{as:no.VscKebabVertical,boxSize:"14px",display:"inline-flex",cursor:"pointer",_hover:{color:"black"},onClick:t=>{t.preventDefault(),t.stopPropagation(),h(t,e)}}):(0,o.jsx)(t2.Box,{height:`${nj.COLUMN_HEIGHT+1} px`,children:l})]}),(0,o.jsx)(eS,{type:"target",position:a.Position.Left,isConnectable:!1,style:{left:0,visibility:"hidden"}}),(0,o.jsx)(eS,{type:"source",position:a.Position.Right,isConnectable:!1,style:{right:0,visibility:"hidden"}})]}):(0,o.jsx)(o.Fragment,{})}function n_(){return(0,o.jsx)(t2.Box,{bg:"white",padding:"12px",borderWidth:"1px",borderColor:"gray.200",fontSize:"sm",children:Object.entries({passthrough:["Pass Through","The column is directly selected from the upstream table."],renamed:["Renamed","The column is selected from the upstream table but with a different name."],derived:["Derived","The column is created through transformations applied to upstream columns, such as calculations, conditions, functions, or aggregations."],source:["Source","The column is not derived from any upstream data. It may originate from a seed/source node, literal value, or data generation function."],unknown:["Unknown","We have no information about the transformation type. This could be due to a parse error, or other unknown reason."]}).map(([e,[t,n]])=>(0,o.jsx)(ne.Tooltip,{content:n,positioning:{placement:"right"},children:(0,o.jsxs)(t7.Flex,{alignItems:"center",gap:"6px",marginBottom:"2px",children:[(0,o.jsx)(nS,{legend:!0,transformationType:e})," ",t]})},e))})}function nR(e){let{source:t,target:n,sourceX:i,sourceY:r,targetX:s,targetY:l,sourcePosition:d,targetPosition:c,style:u={},markerEnd:g,data:h}=e,p={...u},{isEdgeHighlighted:f}=t8();h?.changeStatus&&(p.stroke=nl(h.changeStatus).hexColor,p.strokeDasharray="5"),f(t,n)||(p.filter="opacity(0.2) grayscale(50%)");let[m]=(0,a.getBezierPath)({sourceX:i,sourceY:r,sourcePosition:d,targetX:s,targetY:l,targetPosition:c});return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(eG,{path:m,markerEnd:g,style:{...p,...u}})})}e.s(["GraphColumnNode",()=>nk,"TransformationType",0,nS],904451),e.s(["ColumnLevelLineageLegend",()=>n_],632951),e.s(["default",()=>nR],676502);var nM=e.i(362896),nI=e.i(652058),nE=e.i(372230);function nN(e,t){if(!e||!t)return;let n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!0;for(let e=0;e<n.length;e++)if(n[e]!==o[e])return!0;for(let n of o)if(!e[n]||e[n].type!==t[n]?.type)return!0;return!1}e.s(["isSchemaChanged",()=>nN],163669);var nD=e.i(765565),nT=e.i(862754),nP=e.i(554962),nL=e.i(124352),nz=e.i(389125),nB=e.i(913369),nA=e.i(912007);function nO({node:e}){let{icon:t}=nd(e.data.resourceType);return(0,o.jsx)(ne.Tooltip,{showArrow:!0,content:"Type of resource",children:(0,o.jsxs)(nv.Tag.Root,{children:[t&&(0,o.jsx)(nv.Tag.StartElement,{children:(0,o.jsx)(t,{})}),(0,o.jsx)(nv.Tag.Label,{children:e.data.resourceType})]})})}function nF({rowCount:e}){let t=e.base,n=e.curr,i=null===e.base?"N/A":`${e.base} rows`,r=null===e.curr?"N/A":`${e.curr} rows`;return null===t&&null===n?(0,o.jsx)(o.Fragment,{children:" Failed to load"}):null===t||null===n?(0,o.jsxs)(t5.HStack,{children:[(0,o.jsx)(nf.Text,{children:i}),(0,o.jsx)(t9.Icon,{as:nL.FiArrowRight}),(0,o.jsx)(nf.Text,{children:r})]}):t===n?(0,o.jsxs)(t5.HStack,{children:[(0,o.jsx)(nf.Text,{children:r}),(0,o.jsx)(t9.Icon,{as:nz.RiSwapLine,color:"gray.500"}),(0,o.jsx)(nf.Text,{color:"gray.500",children:"No Change"})]}):t<n?(0,o.jsxs)(t5.HStack,{children:[(0,o.jsx)(nf.Text,{children:r}),(0,o.jsx)(t9.Icon,{as:nz.RiArrowUpSFill,color:"green.500"}),(0,o.jsx)(nf.Text,{color:"green.500",children:(0,nI.deltaPercentageString)(t,n)})]}):(0,o.jsxs)(t5.HStack,{children:[(0,o.jsx)(nf.Text,{children:r}),(0,o.jsx)(t9.Icon,{as:nz.RiArrowDownSFill,color:"red.500"}),(0,o.jsx)(nf.Text,{color:"red.500",children:(0,nI.deltaPercentageString)(t,n)})]})}function nV({rowCount:e,node:t,onRefresh:n,isFetching:i}){let{featureToggles:r}=(0,nA.useRecceInstanceContext)(),{runsAggregated:a}=(0,nx.useLineageGraphContext)(),s=a?.[t.id]?.row_count_diff.result,l=(0,nE.findByRunType)("row_count_diff").icon,d=e??s,c=d?`${d.base??"N/A"} -> ${d.curr??"N/A"} rows`:"";return(0,o.jsx)(ne.Tooltip,{content:c,children:(0,o.jsx)(nB.default,{display:"metadata only"===r.mode,children:(0,o.jsx)(nv.Tag.Root,{asChild:!0,children:(0,o.jsxs)(t7.Flex,{direction:"row",alignItems:"center",gap:"1",children:[(0,o.jsx)(l,{}),null!=d||i?(0,o.jsx)(nP.SkeletonText,{loading:!1,noOfLines:1,minWidth:"30px",fontSize:"xs",children:null!=d?(0,o.jsx)(nF,{rowCount:d}):"row count"}):(0,o.jsx)(nf.Text,{fontSize:"xs",children:"row count"}),n&&(0,o.jsx)(ng.IconButton,{loading:i,"aria-label":"Query Row Count",size:"2xs",p:"0",variant:"ghost",onClick:n,disabled:r.disableDatabaseQuery,children:(0,o.jsx)(nm.PiRepeat,{})})]})})})})}function n$({rowCount:e,node:t,onRefresh:n,isFetching:i}){let r,{runsAggregated:a}=(0,nx.useLineageGraphContext)(),s=a?.[t.id]?.row_count.result,l=(0,nE.findByRunType)("row_count").icon,d=e??s;if(d){let e=d.curr??"N/A";r=`${e} rows`}return(0,o.jsxs)(nv.Tag.Root,{children:[(0,o.jsx)(nv.Tag.StartElement,{children:(0,o.jsx)(l,{})}),(0,o.jsx)(nv.Tag.Label,{children:d||i?(0,o.jsx)(nP.SkeletonText,{loading:i,lineClamp:1,height:2,minWidth:"30px",children:d?`${r}`:"row count"}):(0,o.jsx)(o.Fragment,{children:"row count"})}),n&&(0,o.jsx)(ng.IconButton,{loading:i,"aria-label":"Query Row Count",size:"2xs",p:"0",variant:"ghost",onClick:n,disabled:"base"===t.data.from,children:(0,o.jsx)(nm.PiRepeat,{})})]})}e.s(["ResourceTypeTag",()=>nO,"RowCountDiffTag",()=>nV,"RowCountTag",()=>n$],636819);let nH=({node:e,action:t})=>{let{status:n,skipReason:i,run:r}=t;if("pending"===n)return(0,o.jsx)(nD.ProgressCircle.Root,{value:0,size:"xs",children:(0,o.jsxs)(nD.ProgressCircle.Circle,{children:[(0,o.jsx)(nD.ProgressCircle.Track,{}),(0,o.jsx)(nD.ProgressCircle.Range,{})]})});if("skipped"===n)return(0,o.jsx)(nv.Tag.Root,{backgroundColor:"gray.100",children:(0,o.jsx)(nv.Tag.Label,{children:(0,o.jsxs)(t7.Flex,{fontSize:"10pt",color:"gray.500",alignItems:"center",gap:"3px",children:[(0,o.jsx)(t2.Box,{children:"Skipped"}),i&&(0,o.jsx)(ne.Tooltip,{content:i,children:(0,o.jsx)(nm.PiInfo,{})})]})})});if(!r)return(0,o.jsx)(nD.ProgressCircle.Root,{value:null,size:"xs",children:(0,o.jsxs)(nD.ProgressCircle.Circle,{children:[(0,o.jsx)(nD.ProgressCircle.Track,{}),(0,o.jsx)(nD.ProgressCircle.Range,{})]})});let{error:a,run_id:s,progress:l}=r;if("running"===n)if(l?.percentage===void 0)return(0,o.jsx)(nD.ProgressCircle.Root,{value:null,size:"xs",children:(0,o.jsxs)(nD.ProgressCircle.Circle,{children:[(0,o.jsx)(nD.ProgressCircle.Track,{}),(0,o.jsx)(nD.ProgressCircle.Range,{})]})});else return(0,o.jsx)(nD.ProgressCircle.Root,{value:100*l.percentage,size:"xs",children:(0,o.jsxs)(nD.ProgressCircle.Circle,{children:[(0,o.jsx)(nD.ProgressCircle.Track,{}),(0,o.jsx)(nD.ProgressCircle.Range,{})]})});if(a)return(0,o.jsxs)(t7.Flex,{fontSize:"10pt",color:"gray",children:[(0,o.jsx)(t2.Box,{children:"Error"}),i&&(0,o.jsx)(ne.Tooltip,{content:a,children:(0,o.jsx)(nm.PiWarning,{})})]});if((0,nT.isValueDiffRun)(r)&&r.result){let e=r.result,t=0;for(let n of e.data.data)n[2]<1&&t++;return(0,o.jsx)(nv.Tag.Root,{backgroundColor:t>0?"red.100":"green.100",children:(0,o.jsx)(nv.Tag.Label,{children:(0,o.jsx)(t7.Flex,{fontSize:"10pt",color:t>0?"red":"green",alignItems:"center",gap:"3px",children:t>0?`${t} columns mismatched`:"All columns match"})})})}if((0,nT.isRowCountDiffRun)(r)&&r.result){let t=r.result;return(0,o.jsx)(nV,{rowCount:t[e.data.name],node:e})}if((0,nT.isRowCountRun)(r)&&r.result){let t=r.result;return(0,o.jsx)(n$,{rowCount:t[e.data.name],node:e})}return(0,o.jsx)(o.Fragment,{children:s})};function nG({rowCount:e}){let t,n,i=e.base,r=e.curr,a=null===e.base?"N/A":`${e.base} Rows`,s=null===e.curr?"N/A":`${e.curr} Rows`;return null===i&&null===r?(t="Failed to load",n="gray"):null===i||null===r?(t=`${a} -> ${s}`,n=null===i?"green":"red"):i===r?(t="=",n="gray"):i!==r&&(t=`${(0,nI.deltaPercentageString)(i,r)} Rows`,n=i<r?"green":"red"),(0,o.jsx)(nv.Tag.Root,{colorPalette:n,children:(0,o.jsxs)(t7.Flex,{gap:1,alignItems:"center",children:[(0,o.jsx)(t9.Icon,{as:(0,nE.findByRunType)("row_count_diff").icon}),(0,o.jsx)(nv.Tag.Label,{children:t})]})})}let nW={breaking:"Breaking",non_breaking:"Non Breaking",partial_breaking:"Partial Breaking",unknown:"Unknown"},nK=({id:e,inverted:t})=>{let n,i,{lineageGraph:r,runsAggregated:a}=(0,nx.useLineageGraphContext)(),s=a?.[e],l=r?.nodes[e];if(!s&&!l)return(0,o.jsx)(o.Fragment,{});if(l?.data.data.base&&l.data.data.current&&(n=nN(l.data.data.base.columns,l.data.data.current.columns)),s?.row_count_diff){let e=s.row_count_diff.result;i=e.curr!==e.base}let d=t?"white":nl("modified").color;return(0,o.jsxs)(t7.Flex,{flex:"1",children:[void 0!==n&&(0,o.jsx)(ne.Tooltip,{content:`Schema (${n?"changed":"no change"})`,openDelay:500,children:(0,o.jsx)(t2.Box,{height:"16px",children:(0,o.jsx)(t9.Icon,{as:(0,nE.findByRunType)("schema_diff").icon,color:n?d:t?"gray":"gray.100"})})}),(0,o.jsx)(nw.Spacer,{}),s?.row_count_diff&&void 0!==i&&(0,o.jsx)(ne.Tooltip,{content:`Row count (${i?"changed":"="})`,openDelay:500,children:(0,o.jsx)(t2.Box,{children:(0,o.jsx)(nG,{rowCount:s.row_count_diff.result})})})]})},nZ=({checked:e,onClick:t})=>(0,o.jsx)(t7.Flex,{onClick:t,alignSelf:"center",alignItems:"center",cursor:"pointer",children:e?(0,o.jsx)(t9.Icon,{boxSize:"20px",as:nt.FaCheckSquare}):(0,o.jsx)(t9.Icon,{boxSize:"20px",as:nt.FaRegSquare})}),nQ=({name:e,color:t,resourceType:n})=>(0,o.jsx)(t2.Box,{flex:"1",color:t,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:(0,o.jsx)(ne.Tooltip,{content:"model"===n?e:`${e} (${n})`,positioning:{placement:"top"},children:(0,o.jsx)("span",{children:e})})});function nq(e){let{data:t}=e,{id:n,resourceType:r,changeStatus:s}=t,l=b(e=>e.transform[2]>.3),{icon:d}=nd(r),[c,u]=(0,i.useState)(!1),{interactive:g,selectNode:h,selectMode:p,focusedNode:f,getNodeAction:m,getNodeColumnSet:x,isNodeHighlighted:y,isNodeSelected:w,isNodeShowingChangeAnalysis:v,showContextMenu:j,viewOptions:C,cll:S,showColumnLevelLineage:k}=t8(),_=S?.current.nodes[n]?.change_category,R=y(n),M=w(n),I=C.column_level_lineage?.node_id===n&&void 0===C.column_level_lineage.column,E=f?.id===n||I,N=v(n),{icon:D,color:T,backgroundColor:P}=s?nl(s):{icon:void 0,color:"gray.400",backgroundColor:"gray.100"},L=t.name,z=x(t.id),B=z.size>0,A="action_result"===p?m(t.id):void 0,O=l?"selecting"===p?M?T:"white":"action_result"!==p?E||M||c?P:"white":A?E||M||c?P:T:"white":E||M||c?T:P,F="selecting"===p?M?"white":"inherit":"action_result"===p&&A&&!M?"white":"inherit",V="selecting"===p?M?"white":"inherit":"action_result"===p&&A&&!M?"white":"inherit",$="selecting"===p?M?"white":T:"action_result"===p?A&&!M?"white":"inherit":T;return(0,o.jsxs)(t7.Flex,{cursor:"selecting"===p?"pointer":"inherit",direction:"column",width:"300px",transition:"box-shadow 0.2s ease-in-out",padding:0,filter:"action_result"===p?A?"none":"opacity(0.2) grayscale(50%)":R||E||M||c?"none":"opacity(0.2) grayscale(50%)",onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1)},children:[(0,o.jsxs)(t7.Flex,{borderColor:T,borderWidth:"2px",borderTopRadius:8,borderBottomRadius:8*!B,backgroundColor:O,height:"60px",children:[(0,o.jsx)(t7.Flex,{bg:T,padding:g?"8px":"2px",borderRightWidth:"2px",borderColor:"selecting"===p?"#00000020":T,alignItems:"top",visibility:l?"inherit":"hidden",children:g&&(0,o.jsx)(nZ,{checked:"selecting"===p&&M||"action_result"===p&&!!A,onClick:e=>{"action_result"!==p&&(e.stopPropagation(),h(t.id))}})}),(0,o.jsxs)(t7.Flex,{flex:"1 0 auto",mx:"1",width:"100px",direction:"column",children:[(0,o.jsxs)(t7.Flex,{width:"100%",textAlign:"left",fontWeight:"600",flex:"1",p:1,gap:"5px",alignItems:"center",visibility:l?"inherit":"hidden",children:[(0,o.jsx)(nQ,{name:L,color:F,resourceType:r}),c?(0,o.jsxs)(o.Fragment,{children:["modified"===s&&(0,o.jsx)(ne.Tooltip,{content:"Show Impact Radius",positioning:{placement:"top"},openDelay:500,children:(0,o.jsx)(nM.Center,{children:(0,o.jsx)(t9.Icon,{boxSize:"14px",as:nt.FaRegDotCircle,color:"gray",cursor:"pointer",_hover:{color:"black"},onClick:e=>{e.preventDefault(),e.stopPropagation(),k({node_id:n,change_analysis:!0,no_upstream:!0})}})})}),(0,o.jsx)(t9.Icon,{as:no.VscKebabVertical,color:"gray",cursor:"pointer",_hover:{color:"black"},onClick:t=>{t.preventDefault(),t.stopPropagation(),j(t,e)}})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t9.Icon,{boxSize:"16px",color:V,as:d}),s&&(0,o.jsx)(t9.Icon,{color:$,as:D})]})]}),(0,o.jsx)(t7.Flex,{flex:"1 0 auto",mx:"1",direction:"column",paddingBottom:"1",visibility:l?"inherit":"hidden",children:(0,o.jsx)(t5.HStack,{gap:"8px",children:A?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(nw.Spacer,{}),(0,o.jsx)(nH,{node:t,action:A})]}):N?(0,o.jsx)(t2.Box,{height:"20px",color:"gray",fontSize:"9pt",margin:0,fontWeight:600,children:_?nW[_]:""}):"action_result"!==p&&"model"===t.resourceType?(0,o.jsx)(nK,{id:t.id,inverted:"selecting"===p&&M}):(0,o.jsx)(o.Fragment,{})})})]})]}),B&&(0,o.jsx)(t2.Box,{p:"10px 10px",borderColor:T,borderWidth:"2px",borderTopWidth:0,borderBottomRadius:8,children:(0,o.jsx)(t2.Box,{height:`${z.size*nj.COLUMN_HEIGHT}px`,overflow:"auto"})}),Object.keys(t.parents).length>0&&(0,o.jsx)(eS,{type:"target",position:a.Position.Left,isConnectable:!1}),Object.keys(t.children).length>0&&(0,o.jsx)(eS,{type:"source",position:a.Position.Right,isConnectable:!1})]})}e.s(["GraphNode",()=>nq],592355);var nU=e.i(464503),nX=e.i(242413),nY=e.i(830818);function nJ(e){return(0,nY.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6 18h12v2H6zm6-14.414-6.707 6.707 1.414 1.414L11 7.414V16h2V7.414l4.293 4.293 1.414-1.414z"},child:[]}]})(e)}function n0(e){return(0,nY.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6 18h12v2H6zm5-14v8.586L6.707 8.293 5.293 9.707 12 16.414l6.707-6.707-1.414-1.414L13 12.586V4z"},child:[]}]})(e)}var n1=e.i(675155);function n2(e,t){let n=(0,n1.mergeKeys)(e,t);if(0===n.length)return[];if(0===e.length||0===t.length)return n.map((e,t)=>t===n.length-1?e:e+",");let o="";return n.forEach(n=>{e.includes(n)&&t.includes(n)&&(o=n)}),n.map((i,r)=>{let a;return(a=e.includes(i)?t.includes(i)?i:`--- ${i} (Removed)`:`--- ${i} (Added)`,i===o||r===n.length-1)?a:a+","})}e.s(["formatSelectColumns",()=>n2],832421);var n3=e.i(29134),n5=e.i(475119),n4=e.i(505251),n8=e.i(400905),n6=e.i(645364);let n7=({menuItems:e,open:t,onClose:n,x:i,y:r})=>{let{featureToggles:a}=(0,nA.useRecceInstanceContext)();return(0,o.jsx)(nU.Menu.Root,{open:t,onOpenChange:n,children:(0,o.jsx)(nh.Portal,{children:(0,o.jsx)(nU.Menu.Positioner,{children:(0,o.jsx)(nU.Menu.Content,{fontSize:"0.85rem",position:"absolute",width:"250px",style:{left:`${i}px`,top:`${r}px`},children:0===e.length?(0,o.jsx)(nU.Menu.Item,{value:"no-action",disabled:!0,children:"No action available"},"no action"):e.map(({isSeparator:e,label:t,isDisabled:i,action:r,itemIcon:s})=>{if(e)return(0,o.jsx)(nU.Menu.Separator,{},t);{let e=(0,o.jsxs)(nU.Menu.Item,{value:String(t),disabled:i,onClick:()=>{r&&r(),n()},children:[s," ",t]},t);return i?(0,o.jsx)(nB.default,{display:"metadata only"===a.mode,children:e},t):e}})})})})})},n9=({isOpen:e,onClose:t,x:n,y:i,node:r})=>{let a=[],{selectParentNodes:s,selectChildNodes:l,getNodeColumnSet:d,selectMode:c,cll:u,showColumnLevelLineage:g}=t8(),{runAction:h}=(0,n3.useRecceActionContext)(),{featureToggles:p}=(0,nA.useRecceInstanceContext)(),{isActionAvailable:f}=(0,nx.useLineageGraphContext)(),{data:m}=(0,ny.useRecceServerFlag)(),{lineageGraph:x}=(0,nx.useLineageGraphContext)(),y=!x?.catalogMetadata.current,b=m?.single_env_onboarding??!1,w=p.disableDatabaseQuery,{primaryKey:v}=(0,n8.default)(r?.data?.data.name),{setSqlQuery:j,setPrimaryKeys:C}=(0,n5.useRecceQueryContext)(),[,S]=(0,n4.useAppLocation)();if(!r?.data)return(0,o.jsx)(o.Fragment,{});let k=r.data,_=k.resourceType,R=Array.from(d(r.id)),M={source:"lineage_model_node"};if("modified"===k.changeStatus&&a.push({label:"Show Impact Radius",itemIcon:(0,o.jsx)(nt.FaRegDotCircle,{}),isDisabled:y,action:()=>{g({node_id:r.id,change_analysis:!0,no_upstream:!0})}}),!c&&_&&["model","seed","snapshot"].includes(_)){a.length>0&&a.push({label:"select group one",isSeparator:!0});let e=(0,nE.findByRunType)(b?"query":"query_diff"),t=n2(Object.keys(k.data.base?.columns??{}),Object.keys(k.data.current?.columns??{})),n=`select * from {{ ref("${k.name}") }}`;if(t.length&&(n=`select 
  ${t.join("\n  ")}
from {{ ref("${k.name}") }}`),a.push({label:"Query",itemIcon:(0,o.jsx)(t9.Icon,{as:e.icon}),isDisabled:w,action:()=>{j(n),f("query_diff_with_primary_key")&&C(void 0!==v?[v]:void 0),S("/query")}}),R.length>0)if(void 0!==u){let t=new Set;v&&t.add(v),R.forEach(e=>{t.add(e)}),a.push({label:"Query Related Columns",itemIcon:(0,o.jsx)(t9.Icon,{as:e.icon}),isDisabled:w,action:()=>{j(`select 
  ${Array.from(t).join(",\n  ")}
from {{ ref("${k.name}") }}`),f("query_diff_with_primary_key")&&C(void 0!==v?[v]:void 0),S("/query")}})}else{let t=Object.entries(k.change?.columns??{}).filter(([,e])=>"modified"===e).map(([e])=>e);if(t.length>0){let n=new Set;v&&n.add(v),t.forEach(e=>{n.add(e)}),a.push({label:"Query Modified Columns",itemIcon:(0,o.jsx)(t9.Icon,{as:e.icon}),isDisabled:w,action:()=>{j(`select 
  ${Array.from(n).join(",\n  ")}
from {{ ref("${k.name}") }}`),f("query_diff_with_primary_key")&&C(void 0!==v?[v]:void 0),S("/query")}})}}let i=(0,nE.findByRunType)(b?"row_count":"row_count_diff");a.push({label:i.title,itemIcon:(0,o.jsx)(t9.Icon,{as:i.icon}),isDisabled:w,action:()=>{h(b?"row_count":"row_count_diff",{node_names:[k.name]},{showForm:!1,trackProps:M})}});let s=(0,nE.findByRunType)(b?"profile":"profile_diff");if(a.push({label:s.title,itemIcon:(0,o.jsx)(t9.Icon,{as:s.icon}),isDisabled:w,action:()=>{let e=Array.from(d(r.id));h(b?"profile":"profile_diff",{model:k.name,columns:e},{showForm:!0,trackProps:M})}}),!b){let e=(0,nE.findByRunType)("value_diff");a.push({label:e.title,itemIcon:(0,o.jsx)(t9.Icon,{as:e.icon}),isDisabled:w,action:()=>{let e=Array.from(d(r.id));h("value_diff",{model:k.name,columns:e},{showForm:!0,trackProps:M})}})}}return b||(a.length>0&&a.push({label:"select group two",isSeparator:!0}),a.push({label:"Select Parent Nodes",itemIcon:(0,o.jsx)(nJ,{}),action:()=>{s(r.id,1)}}),a.push({label:"Select Child Nodes",itemIcon:(0,o.jsx)(n0,{}),action:()=>{l(r.id,1)}}),a.push({label:"Select All Upstream Nodes",itemIcon:(0,o.jsx)(nJ,{}),action:()=>{s(r.id)}}),a.push({label:"Select All Downstream Nodes",itemIcon:(0,o.jsx)(n0,{}),action:()=>{l(r.id)}})),(0,o.jsx)(n7,{x:n,y:i,menuItems:a,open:e,onClose:t})},oe=({isOpen:e,onClose:t,x:n,y:i,node:r})=>{let a=[],{runAction:s}=(0,n3.useRecceActionContext)(),{isActionAvailable:l}=(0,nx.useLineageGraphContext)(),{featureToggles:d}=(0,nA.useRecceInstanceContext)(),{data:c}=(0,ny.useRecceServerFlag)(),u=c?.single_env_onboarding??!1,g=d.disableDatabaseQuery;if(r?.data===void 0)return(0,o.jsx)(o.Fragment,{});let h=r.data,p=h.node,f=h.column,m=h.type,x={source:"lineage_column_node"},y=p.data.base?.columns?.[f]===void 0||p.data.current?.columns?.[f]===void 0,b=(0,nE.findByRunType)(u?"profile":"profile_diff");if(a.push({label:b.title,itemIcon:(0,o.jsx)(t9.Icon,{as:b.icon}),action:()=>{s("profile_diff",{model:p.name,columns:[f]},{showForm:!1,trackProps:x})},isDisabled:y||!l("profile_diff")||g}),!u){let e=(0,nE.findByRunType)("histogram_diff");a.push({label:e.title,itemIcon:(0,o.jsx)(t9.Icon,{as:e.icon}),action:()=>{s("histogram_diff",{model:p.name,column_name:f,column_type:m},{showForm:!1,trackProps:x})},isDisabled:y||!m||!(0,n6.supportsHistogramDiff)(m)||g});let t=(0,nE.findByRunType)("top_k_diff");a.push({label:t.title,itemIcon:(0,o.jsx)(t9.Icon,{as:t.icon}),action:()=>{s("top_k_diff",{model:p.name,column_name:f,k:50},{showForm:!1,trackProps:x})},isDisabled:y||g});let n=(0,nE.findByRunType)("value_diff");a.push({label:n.title,itemIcon:(0,o.jsx)(t9.Icon,{as:n.icon}),action:()=>{s("value_diff",{model:p.name,columns:[f]},{showForm:!0,trackProps:x})},isDisabled:y||g})}return(0,o.jsx)(n7,{x:n,y:i,menuItems:a,open:e,onClose:t})};e.s(["LineageViewContextMenu",0,({isOpen:e,onClose:t,x:n,y:i,node:r})=>{let{featureToggles:a}=(0,nA.useRecceInstanceContext)();return a.disableViewActionDropdown?(0,o.jsx)(n7,{menuItems:[],open:e,onClose:t,x:n,y:i}):r&&(0,nj.isLineageGraphNode)(r)?(0,o.jsx)(n9,{x:n,y:i,isOpen:e,onClose:t,node:r}):r&&(0,nj.isLineageGraphColumnNode)(r)?(0,o.jsx)(oe,{x:n,y:i,isOpen:e,onClose:t,node:r}):void 0},"useLineageViewContextMenu",0,()=>{let{open:e,onClose:t,onOpen:n}=(0,nX.useDisclosure)(),[o,r]=(0,i.useState)({x:0,y:0}),[a,s]=(0,i.useState)();return{props:{x:o.x,y:o.y,node:a,isOpen:e,onClose:t},showContextMenu:(e,t,o)=>{r({x:e,y:t}),s(o),n()},closeContextMenu:()=>{r({x:0,y:0}),s(void 0),t()}}}],739145);var ot=e.i(64805);let on="recce",oo={recommendationIgnored:`${on}-recommendation-ignored`,recommendationShowed:`${on}-recommendation-showed`,prevRefreshTimeStamp:`${on}-prev-refresh-timestamp`,lineageNotificationDismissed:`${on}-lineage-notification-dismissed`};function oi({notification:e,type:t}){let n=oo.lineageNotificationDismissed,[r,a]=(0,i.useState)(()=>"true"!==sessionStorage.getItem(n));return null!==e&&r?(0,o.jsxs)(t7.Flex,{w:"100%",direction:"row",p:"5px 10px",gap:"5px",alignItems:"flex-start",borderRadius:"md",boxShadow:"md",border:"1px solid",borderColor:"gray.200",bg:{info:"blue.50",success:"green.50",warning:"yellow.50",error:"red.50"}[t],children:[e,(0,o.jsx)(nw.Spacer,{}),(0,o.jsx)(ot.CloseButton,{onClick:()=>{sessionStorage.setItem(n,"true"),a(!1)}})]}):null}e.s(["LineageViewNotification",()=>oi],428537);var or=e.i(298669),oa=e.i(28194),os=e.i(375708),ol=e.i(339583),od=e.i(2936);let oc=()=>(0,o.jsxs)(ol.VStack,{align:"start",gap:0,children:[(0,o.jsx)(nf.Text,{fontSize:"10pt",color:"gray.500",pb:1,children:"Select nodes by dbt node selector syntax"}),(0,o.jsxs)(nf.Text,{fontSize:"8pt",children:[(0,o.jsx)(nu.Code,{fontSize:"8pt",children:"model_name"})," Select a node"]}),(0,o.jsxs)(nf.Text,{fontSize:"8pt",children:[(0,o.jsx)(nu.Code,{fontSize:"8pt",children:"model_name+"})," Select downstream nodes"]}),(0,o.jsxs)(nf.Text,{fontSize:"8pt",children:[(0,o.jsx)(nu.Code,{fontSize:"8pt",children:"+model_name"})," Select upstream nodes"]}),(0,o.jsxs)(nf.Text,{fontSize:"8pt",children:[(0,o.jsx)(nu.Code,{fontSize:"8pt",children:"model*"})," Select by wildcard"]})]}),ou=({isDisabled:e})=>{let{viewOptions:t,onViewOptionsChanged:n}=t8(),i=t.view_mode??"changed_models";return(0,o.jsxs)(nU.Menu.Root,{children:[(0,o.jsx)(nU.Menu.Trigger,{asChild:!0,children:(0,o.jsxs)(t3.Button,{minWidth:"100px",size:"2xs",variant:"outline",disabled:e,children:[(0,o.jsx)(t9.Icon,{as:nd("model").icon})," ","changed_models"===i?"Changed Models":"All"," ",(0,o.jsx)(nm.PiCaretDown,{})]})}),(0,o.jsx)(nh.Portal,{children:(0,o.jsx)(nU.Menu.Positioner,{children:(0,o.jsx)(nU.Menu.Content,{children:(0,o.jsxs)(nU.Menu.RadioItemGroup,{value:i,onValueChange:e=>{var o;o=e.value,n({...t,view_mode:o})},children:[(0,o.jsx)(nU.Menu.ItemGroupLabel,{children:"mode"}),(0,o.jsxs)(nU.Menu.RadioItem,{value:"changed_models",children:["Changed Models",(0,o.jsx)(nU.Menu.ItemIndicator,{})]}),(0,o.jsxs)(nU.Menu.RadioItem,{value:"all",children:["All",(0,o.jsx)(nU.Menu.ItemIndicator,{})]})]})})})})]})},og=({isDisabled:e})=>{let{lineageGraph:t}=(0,nx.useLineageGraphContext)(),{viewOptions:n,onViewOptionsChanged:i}=t8(),r=new Set;for(let e of Object.values(t?.nodes??{}))e.data.packageName&&r.add(e.data.packageName);let a=t?.manifestMetadata.current?.project_name,s=n.packages?new Set(n.packages):a?new Set([a]):r,l=s.size===r.size,d=0===s.size,c=1===s.size?Array.from(s)[0]:l?"All Packages":d?"No Package":`${s.size} Packages`;return(0,o.jsxs)(nU.Menu.Root,{closeOnSelect:!1,children:[(0,o.jsx)(nU.Menu.Trigger,{asChild:!0,children:(0,o.jsxs)(t3.Button,{minWidth:"100px",size:"2xs",variant:"outline",disabled:e,children:[(0,o.jsx)(t9.Icon,{as:nL.FiPackage})," ",c," ",(0,o.jsx)(nm.PiCaretDown,{})]})}),(0,o.jsx)(nh.Portal,{children:(0,o.jsx)(nU.Menu.Positioner,{children:(0,o.jsx)(nU.Menu.Content,{children:(0,o.jsxs)(nU.Menu.ItemGroup,{children:[(0,o.jsx)(nU.Menu.ItemGroupLabel,{children:"Select Packages"}),(0,o.jsx)(nU.Menu.Item,{value:"",asChild:!0,children:(0,o.jsxs)(oa.Checkbox.Root,{checked:l||d?l:"indeterminate",onCheckedChange:()=>{l?i({...n,packages:[]}):i({...n,packages:Array.from(r)})},children:[(0,o.jsx)(oa.Checkbox.HiddenInput,{}),(0,o.jsx)(oa.Checkbox.Control,{}),(0,o.jsx)(oa.Checkbox.Label,{children:"Select All"})]})}),(0,o.jsx)(nU.Menu.Separator,{}),Array.from(r).map(e=>(0,o.jsx)(nU.Menu.Item,{value:e,children:(0,o.jsxs)(oa.Checkbox.Root,{checked:s.has(e),onCheckedChange:()=>{let t;(t=new Set(s)).has(e)?t.delete(e):t.add(e),i({...n,packages:Array.from(t)})},children:[(0,o.jsx)(oa.Checkbox.HiddenInput,{}),(0,o.jsx)(oa.Checkbox.Control,{}),(0,o.jsx)(oa.Checkbox.Label,{className:"no-track-pii-safe",children:e})]})},e))]})})})})]})},oh=e=>{let[t,n]=(0,i.useState)(e.value),{data:r}=(0,ny.useRecceServerFlag)(),a=(0,i.useRef)(null);return(0,i.useEffect)(()=>{a.current&&(a.current.value=e.value)},[e.value]),(0,o.jsx)(ne.Tooltip,{contentProps:{width:"300px",padding:2,shadow:"md",borderWidth:1,rounded:"md",color:"black",backgroundColor:"white"},content:e.tooltipComponent,positioning:{placement:"bottom-start"},closeOnClick:!1,disabled:!r?.single_env_onboarding,children:(0,o.jsx)(os.Input,{ref:a,height:"24px",fontSize:"10pt",placeholder:"with selectors",disabled:e.isDisabled,value:t,onChange:e=>{n(e.target.value)},onKeyUp:o=>{"Enter"===o.key?e.onChange(t):"Escape"===o.key&&(o.preventDefault(),n(e.value),a.current&&a.current.blur())},onBlur:()=>{n(e.value)}})})},op=({isDisabled:e})=>{let{viewOptions:t,onViewOptionsChanged:n}=t8();return(0,o.jsx)(oh,{isDisabled:e,value:t.select??"",onChange:e=>{n({...t,select:e||void 0})},tooltipComponent:(0,o.jsx)(oc,{})})},of=({isDisabled:e})=>{let{viewOptions:t,onViewOptionsChanged:n}=t8();return(0,o.jsx)(oh,{isDisabled:e,value:t.exclude??"",onChange:e=>{n({...t,exclude:e||void 0})}})},om=e=>(0,o.jsxs)(t2.Box,{style:e.style,maxWidth:"300px",children:[(0,o.jsx)(t2.Box,{fontSize:"8pt",children:(e.label??"").trim()||(0,o.jsx)(o.Fragment,{children:""})}),e.children]});e.s(["LineageViewTopBar",0,()=>{let{deselect:e,focusedNode:t,selectedNodes:n,...i}=t8(),{featureToggles:r}=(0,nA.useRecceInstanceContext)(),{data:a}=(0,ny.useRecceServerFlag)(),s=a?.single_env_onboarding,l=n.length>0,d=!t&&!l;return(0,o.jsx)(t5.HStack,{width:"100%",padding:"4pt 8pt",className:"chakra-style-reset",children:(0,o.jsxs)(t5.HStack,{flex:"1",children:[(0,o.jsx)(od.default,{}),(0,o.jsx)(om,{label:"Mode",style:{flexShrink:"1"},children:(0,o.jsx)(ou,{isDisabled:l})}),(0,o.jsx)(om,{label:"Package",style:{flexShrink:"1"},children:(0,o.jsx)(og,{isDisabled:l})}),(0,o.jsx)(om,{label:"Select",style:{flex:"100 1 auto"},children:(0,o.jsx)(op,{isDisabled:l})}),(0,o.jsx)(om,{label:"Exclude",style:{flex:"100 1 auto"},children:(0,o.jsx)(of,{isDisabled:l})}),(0,o.jsx)(nw.Spacer,{}),l&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(om,{label:"",style:{flexShrink:"0"},children:(0,o.jsx)(nf.Text,{fontSize:"9pt",color:"gray.500",children:n.length>1?`${n.length} nodes selected`:`${n.length} node selected`})}),(0,o.jsx)(om,{label:"",children:(0,o.jsx)(t3.Button,{variant:"outline",size:"2xs",fontSize:"9pt",onClick:()=>{e()},children:"Deselect"})}),s&&(0,o.jsx)(om,{label:"Explore",children:(0,o.jsx)(or.ButtonGroup,{attached:!0,variant:"outline",children:(0,o.jsxs)(nU.Menu.Root,{positioning:{placement:"bottom-end"},children:[(0,o.jsx)(nU.Menu.Trigger,{asChild:!0,children:(0,o.jsxs)(t3.Button,{size:"2xs",children:["Actions ",(0,o.jsx)(nm.PiCaretDown,{})]})}),(0,o.jsx)(nh.Portal,{children:(0,o.jsx)(nU.Menu.Positioner,{children:(0,o.jsx)(nU.Menu.Content,{children:(0,o.jsx)(nU.Menu.Item,{value:"row-count",disabled:r.disableDatabaseQuery,onClick:async()=>{await i.runRowCount()},children:(0,o.jsxs)(nf.Text,{textStyle:"sm",children:[(0,o.jsx)(t9.Icon,{as:(0,nE.findByRunType)("row_count_diff").icon})," ","Row Count"]})})})})})]})})})]}),!s&&(0,o.jsx)(om,{label:"Explore",children:(0,o.jsx)(or.ButtonGroup,{attached:!0,variant:"outline",children:(0,o.jsxs)(nU.Menu.Root,{positioning:{placement:"bottom-end"},children:[(0,o.jsx)(nU.Menu.Trigger,{asChild:!0,children:(0,o.jsxs)(t3.Button,{size:"2xs",disabled:r.disableViewActionDropdown,children:["Actions ",(0,o.jsx)(nm.PiCaretDown,{})]})}),(0,o.jsx)(nh.Portal,{children:(0,o.jsx)(nU.Menu.Positioner,{children:(0,o.jsxs)(nU.Menu.Content,{children:[(0,o.jsxs)(nU.Menu.ItemGroup,{m:"0",p:"4px 12px",children:[(0,o.jsx)(nU.Menu.ItemGroupLabel,{children:"Diff"}),(0,o.jsx)(nB.default,{display:"metadata only"===r.mode,children:(0,o.jsx)(nU.Menu.Item,{value:"row-count-diff",disabled:r.disableDatabaseQuery,onClick:async()=>{await i.runRowCountDiff()},children:(0,o.jsxs)(nf.Text,{textStyle:"sm",children:[(0,o.jsx)(t9.Icon,{as:(0,nE.findByRunType)("row_count_diff").icon})," ","Row Count Diff"]})})}),(0,o.jsx)(nB.default,{display:"metadata only"===r.mode,children:(0,o.jsx)(nU.Menu.Item,{value:"value-diff",disabled:r.disableDatabaseQuery,onClick:async()=>{await i.runValueDiff()},children:(0,o.jsxs)(nf.Text,{textStyle:"sm",children:[(0,o.jsx)(t9.Icon,{as:(0,nE.findByRunType)("value_diff").icon})," ","Value Diff"]})})})]}),(0,o.jsx)(nU.Menu.Separator,{}),(0,o.jsxs)(nU.Menu.ItemGroup,{m:"0",px:"12px",children:[(0,o.jsx)(nU.Menu.ItemGroupLabel,{children:"Add to Checklist"}),(0,o.jsx)(nU.Menu.Item,{value:"lineage-diff",disabled:!(d||l&&n.length>1),onClick:()=>{i.addLineageDiffCheck(i.viewOptions.view_mode)},children:(0,o.jsxs)(nf.Text,{textStyle:"sm",children:[(0,o.jsx)(t9.Icon,{as:(0,nE.findByRunType)("lineage_diff").icon})," ","Lineage Diff"]})}),(0,o.jsx)(nU.Menu.Item,{value:"schema-diff",disabled:!1,onClick:()=>{i.addSchemaDiffCheck()},children:(0,o.jsxs)(nf.Text,{textStyle:"sm",children:[(0,o.jsx)(t9.Icon,{as:(0,nE.findByRunType)("schema_diff").icon})," ","Schema Diff"]})})]})]})})})]})})})]})})}],224779)},487798,e=>{"use strict";var t=e.i(209482),n=e.i(277078),o=e.i(639967);let i=(0,n.forwardRef)(function(e,n){let{templateAreas:i,column:r,row:a,autoFlow:s,autoRows:l,templateRows:d,autoColumns:c,templateColumns:u,inline:g,...h}=e;return(0,t.jsx)(o.chakra.div,{...h,ref:n,css:[{display:g?"inline-grid":"grid",gridTemplateAreas:i,gridAutoColumns:c,gridColumn:r,gridRow:a,gridAutoFlow:s,gridAutoRows:l,gridTemplateRows:d,gridTemplateColumns:u},e.css]})});i.displayName="Grid",e.s(["Grid",()=>i])},765996,637418,634513,e=>{"use strict";e.s(["DisableTooltipMessages",0,{add_or_remove:"Unavailable for added or removed resources."}],765996);var t=e.i(209482),n=e.i(277078),o=e.i(675155),i=e.i(672235),r=e.i(312295),a=e.i(176609),s=e.i(983849),l=e.i(464503),d=e.i(808676),c=e.i(706249),u=e.i(480322),g=e.i(954307),h=e.i(746798),p=e.i(29134),f=e.i(912007),m=e.i(645364),x=e.i(187726);function y({model:e,row:n,singleEnv:o,cllRunning:y}){let b=(0,x.useLineageViewContext)(),{runAction:w}=(0,p.useRecceActionContext)(),{featureToggles:v}=(0,f.useRecceInstanceContext)(),{name:j,baseType:C,currentType:S,baseIndex:k,currentIndex:_}=n,R=S??C,M=!C||!S;return(0,t.jsx)(h.Tooltip,{content:"View column lineage",positioning:{placement:"top"},showArrow:!0,disabled:void 0===b||void 0!==k&&void 0===_,children:(0,t.jsxs)(r.Flex,{alignItems:"center",gap:"3px",children:[(0,t.jsx)(i.Box,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:j}),(0,t.jsx)(c.Spacer,{}),y&&(0,t.jsx)(u.Spinner,{size:"xs",color:"gray.400"}),!o&&"source"!==e.resource_type&&(0,t.jsxs)(l.Menu.Root,{children:[(0,t.jsx)(l.Menu.Trigger,{asChild:!0,children:(0,t.jsx)(s.IconButton,{display:"flex",className:"row-context-menu",variant:"plain",size:"sm",color:"gray",_hover:{color:"black"},disabled:v.disableDatabaseQuery,onClick:e=>{e.stopPropagation()},children:(0,t.jsx)(a.Icon,{as:g.VscKebabVertical})})}),(0,t.jsx)(d.Portal,{children:(0,t.jsx)(l.Menu.Positioner,{children:(0,t.jsx)(l.Menu.Content,{lineHeight:"20px",children:(0,t.jsxs)(l.Menu.ItemGroup,{title:"Diff",m:"0",p:"4px 12px",children:[(0,t.jsx)(l.Menu.Item,{value:"profile-diff",fontSize:"0.85rem",onClick:()=>{w("profile_diff",{model:e.name,columns:[j]},{showForm:!1})},disabled:M,children:"Profile Diff"}),(0,t.jsx)(l.Menu.Item,{value:"histogram-diff",fontSize:"0.85rem",onClick:()=>{w("histogram_diff",{model:e.name,column_name:j,column_type:R},{showForm:!1})},disabled:M||!R||!(0,m.supportsHistogramDiff)(R),children:"Histogram Diff"}),(0,t.jsx)(l.Menu.Item,{value:"top-k-diff",fontSize:"0.85rem",onClick:()=>{w("top_k_diff",{model:e.name,column_name:j,k:50},{showForm:!1})},disabled:M,children:"Top-k Diff"}),(0,t.jsx)(l.Menu.Item,{value:"value-diff",fontSize:"0.85rem",onClick:()=>{w("value_diff",{model:e.name,columns:[j]},{showForm:!0})},disabled:M,children:"Value Diff"})]})})})})]})]})})}function b(e,n,o){function i(e){return void 0!==e.baseIndex&&void 0!==e.currentIndex&&!0===e.reordered?"column-index-reordered schema-column schema-column-index":"schema-column schema-column-index"}function r(e){return void 0!==e.baseIndex&&void 0!==e.currentIndex&&e.baseType!==e.currentType?"column-body-type-changed schema-column":"schema-column"}return{columns:[{key:"baseIndex",name:"",resizable:!0,minWidth:35,width:35,cellClass:i},{key:"currentIndex",name:"",resizable:!0,minWidth:35,width:35,cellClass:i},{key:"name",name:"Name",resizable:!0,renderCell:({row:e,column:i})=>n?(0,t.jsx)(y,{model:n,row:e,cllRunning:o?.get(e.name)??!1}):e.name,cellClass:function(){return"schema-column"}},{key:"baseType",name:"Base Type",resizable:!0,cellClass:r},{key:"currentType",name:"Current Type",resizable:!0,cellClass:r}],rows:Object.values(e)}}var w=e.i(717480),v=e.i(203158),j=e.i(916955),C=e.i(162234);let S=(0,n.forwardRef)(function({base:e,current:i,enableScreenshot:a=!1},s){let l,d,c=(0,x.useLineageViewContext)(),[u,g]=(0,n.useState)(new Map),{columns:h,rows:p}=(0,n.useMemo)(()=>{let t=function(e={},t={}){let n={};Object.entries((0,o.mergeKeysWithStatus)(Object.keys(e),Object.keys(t))).forEach(([e,t])=>{n[e]={name:e,reordered:"reordered"===t,__status:void 0}});let i=0;return Object.entries(e).forEach(([e,t])=>{null!=t&&(n[e].baseIndex=i+=1,n[e].baseType=t.type)}),i=0,Object.entries(t).forEach(([e,t])=>{null!=t&&(n[e].currentIndex=i+=1,n[e].currentType=t.type)}),n}(e?.columns,i?.columns),n=i?.resource_type??e?.resource_type;return n&&["model","seed","snapshot","source"].includes(n)?b(t,i??e,u):b(t)},[e,i,u]),{lineageGraph:f}=(0,j.useLineageGraphContext)(),m=!f?.catalogMetadata.base,y=!f?.catalogMetadata.current;m&&y?l="catalog.json not found on both environments. Run `recce debug` to troubleshoot.":m?l="catalog.json not found on base environment. Run `recce debug` to troubleshoot.":y&&(l="catalog.json not found on current environment. Run `recce debug` to troubleshoot.");let S=e&&void 0===e.columns,k=i&&void 0===i.columns;S&&k?d="catalog.json is outdated on both environments. Update catalog.json to get schema information.":S?d="catalog.json is outdated on base environment. Update catalog.json to get schema information.":k&&(d="catalog.json is outdated on current environment. Update catalog.json to get schema information.");let _=async t=>{(0,v.trackColumnLevelLineage)({action:"view",source:"schema_column"}),g(e=>new Map(e).set(t,!0));let n=i?.id??e?.id;n&&await c?.showColumnLevelLineage({node_id:n,column:t}),g(e=>new Map(e).set(t,!1))},R=c?.viewOptions.column_level_lineage,M=R?new Set([`${R.node_id}-${R.column}`]):new Set;return(0,t.jsxs)(r.Flex,{direction:"column",children:[l?(0,t.jsxs)(w.Alert.Root,{status:"warning",fontSize:"12px",p:"8px",children:[(0,t.jsx)(w.Alert.Indicator,{}),(0,t.jsx)(w.Alert.Description,{children:l})]}):d?(0,t.jsxs)(w.Alert.Root,{status:"warning",fontSize:"12px",p:"8px",children:[(0,t.jsx)(w.Alert.Indicator,{}),(0,t.jsx)(w.Alert.Description,{children:d})]}):(0,t.jsx)(t.Fragment,{}),p.length>0&&(0,t.jsx)(C.ScreenshotDataGrid,{style:{blockSize:"auto",maxHeight:"100%",overflow:"auto",fontSize:"0.8rem",borderWidth:1},columns:h,rows:p,rowHeight:35,renderers:{noRowsFallback:(0,t.jsx)(C.EmptyRowsRenderer,{})},className:"rdg-light no-track-pii-safe",ref:s,rowKeyGetter:t=>{let n=i?.id??e?.id;return`${n}-${t.name}`},selectedRows:M,onSelectedRowsChange:()=>{},onCellClick:async e=>{(void 0===e.row.baseIndex||void 0!==e.row.currentIndex)&&await _(e.row.name)},rowClass:e=>{let t;if(void 0===e.baseIndex)t="row-added";else{if(void 0===e.currentIndex)return"row-removed";t="row-normal"}return void 0!==c&&(t+=" row-selectable"),t}})]})}),k=(0,n.forwardRef)(function({current:e},o){let i,a,s=(0,x.useLineageViewContext)(),[l,d]=(0,n.useState)(new Map),{columns:c,rows:u}=(0,n.useMemo)(()=>(function(e={},n,o){return{columns:[{key:"index",name:"",resizable:!0,minWidth:35,width:35,cellClass:"schema-column schema-column-index"},{key:"name",name:"Name",resizable:!0,renderCell:({row:e})=>n?(0,t.jsx)(y,{model:n,row:e,cllRunning:o?.get(e.name)??!1,singleEnv:!0}):e.name,cellClass:"schema-column"},{key:"type",name:"Type",resizable:!0,cellClass:"schema-column"}],rows:Object.entries(e).filter(([e,t])=>null!=t).map(([e,t],n)=>({name:e,index:n+1,type:t.type,__status:void 0}))}})(e?.columns,e,l),[e,l]),{lineageGraph:g}=(0,j.useLineageGraphContext)();g?.catalogMetadata.current||(i="catalog.json not found. Run `recce debug` to troubleshoot."),e&&void 0===e.columns&&(a="catalog.json is outdated. Update catalog.json to get schema information.");let h=async t=>{(0,v.trackColumnLevelLineage)({action:"view",source:"schema_column"}),d(e=>new Map(e).set(t,!0));let n=e?.id;n&&await s?.showColumnLevelLineage({node_id:n,column:t}),d(e=>new Map(e).set(t,!1))},p=s?.viewOptions.column_level_lineage,f=p?new Set([`${p.node_id}-${p.column}`]):new Set;return(0,t.jsxs)(r.Flex,{direction:"column",children:[i?(0,t.jsxs)(w.Alert.Root,{status:"warning",fontSize:"12px",p:"8px",children:[(0,t.jsx)(w.Alert.Indicator,{}),(0,t.jsx)(w.Alert.Description,{children:i})]}):a?(0,t.jsxs)(w.Alert.Root,{status:"warning",fontSize:"12px",p:"8px",children:[(0,t.jsx)(w.Alert.Indicator,{}),(0,t.jsx)(w.Alert.Description,{children:a})]}):(0,t.jsx)(t.Fragment,{}),u.length>0&&(0,t.jsx)(C.ScreenshotDataGrid,{style:{blockSize:"auto",maxHeight:"100%",overflow:"auto",fontSize:"10pt",borderWidth:1},columns:c,rows:u,renderers:{noRowsFallback:(0,t.jsx)(C.EmptyRowsRenderer,{})},className:"rdg-light",ref:o,rowKeyGetter:t=>{let n=e?.id;return`${n}-${t.name}`},selectedRows:f,onSelectedRowsChange:()=>{},onCellClick:async e=>{await h(e.row.name)},rowClass:()=>void 0!==s?"row-normal row-selectable":"row-normal"})]})});e.s(["SchemaView",0,S,"SingleEnvSchemaView",0,k],637418);var _=e.i(64805),R=e.i(757085),M=e.i(242413),I=e.i(686813),E=e.i(68768),N=e.i(286568),D=e.i(138848);e.s(["NodeSqlView",0,({node:e})=>{let{open:o,onOpen:r,onClose:a}=(0,M.useDisclosure)(),[l,c]=(0,n.useState)(!1),{data:u,isLoading:g}=(0,N.useRecceServerFlag)(),h=u?.single_env_onboarding;if(g)return(0,t.jsx)(t.Fragment,{});if("model"!==e.data.resourceType&&"snapshot"!==e.data.resourceType)return"Not available";let p={readOnly:!0,lineNumbers:"on",automaticLayout:!0,renderOverviewRuler:!1,wordWrap:"off",minimap:{enabled:!1}},f={readOnly:!0,lineNumbers:"on",automaticLayout:!0,wordWrap:"off",minimap:{enabled:!1}},m=e.data.data.base?.raw_code,x=e.data.data.current?.raw_code,y=e.data.data.base?.name??e.data.data.current?.name??"";return(0,t.jsxs)(i.Box,{className:"no-track-pii-safe",style:{position:"relative"},height:"100%",onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},children:[h?(0,t.jsx)(D.default,{language:"sql",theme:"light",value:m??"",options:f}):(0,t.jsx)(I.DiffEditor,{language:"sql",theme:"light",original:m,modified:x,keepCurrentOriginalModel:!0,keepCurrentModifiedModel:!0,options:{...p,renderSideBySide:!1}}),(0,t.jsx)(s.IconButton,{onClick:r,size:"md","aria-label":"Expand",variant:"ghost",style:{position:"absolute",top:"5px",right:"20px",opacity:l?.5:.1,transition:"opacity 0.3s ease-in-out"},children:(0,t.jsx)(E.FaExpandArrowsAlt,{})}),(0,t.jsx)(R.Dialog.Root,{open:o,onOpenChange:a,size:"xl",children:(0,t.jsxs)(d.Portal,{children:[(0,t.jsx)(R.Dialog.Backdrop,{}),(0,t.jsx)(R.Dialog.Positioner,{children:(0,t.jsxs)(R.Dialog.Content,{overflowY:"auto",height:"75%",children:[(0,t.jsxs)(R.Dialog.Header,{children:[h?(0,t.jsxs)(R.Dialog.Title,{children:[(0,t.jsx)("code",{children:y})," Model Code"]}):(0,t.jsxs)(R.Dialog.Title,{children:[(0,t.jsx)("code",{children:y})," Model Code Diff"]}),(0,t.jsx)(R.Dialog.CloseTrigger,{asChild:!0,children:(0,t.jsx)(_.CloseButton,{size:"sm"})})]}),(0,t.jsx)(R.Dialog.Body,{children:h?(0,t.jsx)(I.Editor,{language:"sql",theme:"light",value:m??"",options:{...f,fontSize:16}}):(0,t.jsx)(I.DiffEditor,{language:"sql",theme:"light",original:m,modified:x,options:{...p,fontSize:16}})})]})})]})})]})}],634513)},581435,e=>{"use strict";var t=e.i(487122),n=e.i(868422);function o(e,o){return(0,n.formatDistance)(e,(0,t.constructFrom)(e,Date.now()),o)}e.s(["formatDistanceToNow",()=>o],581435)},302061,e=>{"use strict";var t=e.i(209482),n=e.i(672235),o=e.i(960503),i=e.i(362896),r=e.i(312295),a=e.i(176609),s=e.i(480322),l=e.i(407275),d=e.i(220116),c=e.i(339583),u=e.i(785546),g=e.i(280998),h=e.i(277078),p=e.i(523043),f=e.i(805995),m=e.i(838208),x=e.i(124352),y=e.i(377855),b=e.i(953131),w=e.i(323194),v=e.i(987923),j=e.i(2216),C=e.i(203158),S=e.i(862754),k=e.i(916955),_=e.i(29134),R=e.i(912007),M=e.i(224882),I=e.i(505251),E=e.i(453330),N=e.i(269324),D=e.i(435843),T=e.i(525519),P=e.i(88515),L=e.i(166598),z=e.i(632951),B=e.i(904451),A=e.i(676502),O=e.i(592355),F=e.i(81167),V=e.i(187726),$=e.i(739145),H=e.i(428537),G=e.i(224779),W=e.i(64805),K=e.i(487798),Z=e.i(944751),Q=e.i(862744),q=e.i(464503),U=e.i(808676),X=e.i(706249),Y=e.i(121001),J=e.i(242413),ee=e.i(284827),et=e.i(913369),en=e.i(746798),eo=e.i(765996),ei=e.i(832421),er=e.i(475119),ea=e.i(400905),es=e.i(727653),el=e.i(372230),ed=e.i(637418),ec=e.i(634513),eu=e.i(636819),eg=e.i(846783),eh=e.i(757085),ep=e.i(983849),ef=e.i(740280),em=e.i(221534),ex=e.i(686813),ey=e.i(581435),eb=e.i(830818);function ew(e){return(0,eb.GenIcon)({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 472a40 40 0 1 0 80 0 40 40 0 1 0-80 0zm367 352.9L696.3 352V178H768v-68H256v68h71.7v174L145 824.9c-2.8 7.4-4.3 15.2-4.3 23.1 0 35.3 28.7 64 64 64h614.6c7.9 0 15.7-1.5 23.1-4.3 33-12.7 49.4-49.8 36.6-82.8zM395.7 364.7V180h232.6v184.7L719.2 600c-20.7-5.3-42.1-8-63.9-8-61.2 0-119.2 21.5-165.3 60a188.78 188.78 0 0 1-121.3 43.9c-32.7 0-64.1-8.3-91.8-23.7l118.8-307.5zM210.5 844l41.7-107.8c35.7 18.1 75.4 27.8 116.6 27.8 61.2 0 119.2-21.5 165.3-60 33.9-28.2 76.3-43.9 121.3-43.9 35 0 68.4 9.5 97.6 27.1L813.5 844h-603z"},child:[]}]})(e)}var ev=e.i(954307),ej=e.i(507524),eC=e.i(638337),eS=e.i(461566),ek=e.i(705353),e_=e.i(39115);function eR({description:e,onLike:n,onDislike:o,onClickLink:i,externalLink:a,externalLinkText:s}){return(0,t.jsxs)(r.Flex,{gap:4,justifyContent:"center",alignContent:"center",alignItems:"center",children:[e,(0,t.jsx)(ep.IconButton,{"aria-label":"thumbs up",variant:"ghost",width:"32px",height:"32px",onClick:n,children:(0,t.jsx)(ef.Image,{src:"/imgs/feedback/thumbs-up.png",alt:"like"})}),(0,t.jsx)(ep.IconButton,{"aria-label":"thumbs down",variant:"ghost",width:"32px",height:"32px",onClick:o,children:(0,t.jsx)(ef.Image,{src:"/imgs/feedback/thumbs-down.png",alt:"dislike"})}),a&&s&&(0,t.jsxs)(ek.Link,{href:a,target:"_blank",textDecoration:"underline",onClick:i,children:[s," ",(0,t.jsx)(e_.LuExternalLink,{})]})]})}var eM=e.i(286568),eI=e.i(65089),eE=e.i(182809),eN=e.i(170660);function eD({current:e,primaryKeys:i,setPrimaryKeys:s,onRunResultOpen:l,runQuery:c,isPending:u}){return(0,t.jsxs)(r.Flex,{justifyContent:"right",alignItems:"center",padding:"4pt 8pt",gap:"5px",height:"54px",borderBottom:"1px solid lightgray",flex:"0 0 54px",children:[(0,t.jsxs)(n.Box,{children:[(0,t.jsxs)(Z.Heading,{as:"h2",size:"md",display:"flex",alignItems:"center",gap:"5px",children:[(0,t.jsx)(a.Icon,{as:ew,boxSize:"1.2em"}),"Sandbox"]}),(0,t.jsxs)(d.Text,{fontSize:"xs",color:"gray.500",children:["Compare the run results based on the modified SQL code of model"," ",(0,t.jsx)("b",{children:e?.name})]})]}),(0,t.jsx)(X.Spacer,{}),(0,t.jsx)(eE.QueryForm,{defaultPrimaryKeys:i,onPrimaryKeysChange:s}),(0,t.jsx)(en.Tooltip,{content:"Run diff to see the changes",children:(0,t.jsx)(o.Button,{size:"xs",marginTop:"16px",fontSize:"14px",onClick:()=>{l(),c()},colorPalette:"blue",loading:u,children:"Run Diff"})})]})}function eT({currentModelID:e,height:n="32px",flex:o="0 0 auto"}){let{lineageGraph:i,envInfo:a}=(0,k.useLineageGraphContext)(),s="0 16px",l=(0,eI.formatTimestamp)(a?.dbt?.current?.generated_at??""),c=(0,ey.formatDistanceToNow)(l,{addSuffix:!0}),u="N/A";if(i?.nodes[e]){let t=i.nodes[e];t.data.data.current?.schema&&(u=t.data.data.current.schema)}return(0,t.jsxs)(r.Flex,{gap:0,height:n,flex:o,fontSize:"14px",align:"center",margin:"0",backgroundColor:"#EDF2F880",children:[(0,t.jsx)(em.Stack,{width:"50%",children:(0,t.jsxs)(d.Text,{as:"b",margin:s,children:["ORIGINAL (Schema: ",u,", Last Updated: ",c,")"]})}),(0,t.jsx)(em.Stack,{width:"50%",children:(0,t.jsx)(d.Text,{as:"b",margin:s,children:"SANDBOX EDITOR"})})]})}function eP({current:e,onChange:o}){var i;let r,a=(i=e?.raw_code??"",r=(0,h.useRef)(null),(0,h.useEffect)(()=>{r.current&&i!==r.current.getValue()&&r.current.setValue(i)},[i]),{onMount(e){let t=e.getModifiedEditor();r.current=t,t.onDidChangeModelContent(()=>{o(t.getValue())})}});return(0,t.jsx)(n.Box,{flex:1,overflowY:"auto",children:(0,t.jsx)(ex.DiffEditor,{language:"sql",theme:"vs",original:e?.raw_code,modified:e?.raw_code,options:{readOnly:!1,fontSize:14,lineNumbers:"on",automaticLayout:!0,renderOverviewRuler:!1,minimap:{enabled:!0}},onMount:a.onMount})})}function eL({isOpen:e,onClose:o,current:i}){let{open:a,onClose:s,onOpen:l}=(0,J.useDisclosure)(),[d,c]=(0,h.useState)(i?.raw_code??""),[u,g]=(0,h.useState)(e),{showRunId:p,clearRunResult:m}=(0,_.useRecceActionContext)(),{primaryKeys:x,setPrimaryKeys:b}=(0,er.useRecceQueryContext)(),{data:w,isLoading:v}=(0,eM.useRecceServerFlag)(),j=async()=>{let e=ej.submitQueryDiff,t={current_model:i?.name??"",primary_keys:x,sql_template:d},{run_id:n}=await e(t,{nowait:!0});return p(n),await (0,eS.waitRun)(n)},{mutate:S,isPending:k}=(0,f.useMutation)({mutationFn:j,onSuccess(e){e.error?(0,C.trackPreviewChange)({action:"run",node:i?.name,status:"failure"}):((0,C.trackPreviewChange)({action:"run",node:i?.name,status:"success"}),setTimeout(()=>{R()},1e3),!v&&w?.single_env_onboarding&&setTimeout(()=>{I()},2e3))}}),{feedbackToast:R,closeToast:M}=function(e){let{feedbackId:n,description:o,onFeedbackSubmit:i,externalLink:r,externalLinkText:a}=e,[s,l]=(0,h.useState)(void 0);return{feedbackToast:function(e=!1){let d=localStorage.getItem(n);null!=s||("true"!==d||e)&&l(y.toaster.create({id:n,duration:void 0,type:"success",description:(0,t.jsx)(Q.HStack,{children:(0,t.jsx)(eR,{description:o,onLike:()=>{i("like"),y.toaster.dismiss(s),localStorage.setItem(n,"true")},onDislike:()=>{i("dislike"),y.toaster.dismiss(s),localStorage.setItem(n,"true")},externalLink:r,externalLinkText:a,onClickLink:()=>{i("link")}})})}))},closeToast:()=>{y.toaster.dismiss(s)}}}({feedbackId:eC.localStorageKeys.previewChangeFeedbackID,description:"Enjoy preview change?",onFeedbackSubmit:e=>{switch(e){case"like":(0,C.trackPreviewChangeFeedback)({feedback:"like",node:i?.name});break;case"dislike":(0,C.trackPreviewChangeFeedback)({feedback:"dislike",node:i?.name});break;case"link":(0,C.trackPreviewChangeFeedback)({feedback:"form",node:i?.name});break;default:console.log("Not support feedback type")}},externalLink:"https://docs.google.com/forms/d/e/1FAIpQLSd7Lei7Ijwo7MinWaI0K6rzZi_21gV1BKetmiNEX254kDziDA/viewform?usp=header",externalLinkText:"Give us feedback"}),{guideToast:I,closeGuideToast:E}=function(e){let[t,n]=(0,h.useState)(void 0),{guideId:o,description:i,externalLinkText:r,onExternalLinkClick:a}=e;return{guideToast:function(){null==t&&n(y.toaster.create({id:o,duration:3e3,type:"success",description:i,action:{label:r??"link",onClick:()=>{a&&a()}}}))},closeGuideToast:()=>{y.toaster.dismiss(t)}}}({guideId:eC.localStorageKeys.prepareEnvGuideID,description:"Want to compare data changes with production data?",externalLink:"https://docs.datarecce.io/get-started/#prepare-dbt-artifacts",externalLinkText:"Learn how.",onExternalLinkClick:()=>{(0,C.trackSingleEnvironment)({action:"external_link",from:"preview_changes",node:i?.name})}});return e!==u&&(g(e),e&&c(i?.raw_code??"")),(0,t.jsx)(eh.Dialog.Root,{open:e,size:"cover",onOpenChange:()=>{o(),s(),m(),M(),E(),(0,C.trackPreviewChange)({action:"close",node:i?.name})},children:(0,t.jsxs)(U.Portal,{children:[(0,t.jsx)(eh.Dialog.Backdrop,{}),(0,t.jsx)(eh.Dialog.Positioner,{children:(0,t.jsxs)(eh.Dialog.Content,{height:"100%",children:[(0,t.jsxs)(eh.Dialog.Header,{height:"40px",bg:"rgb(77, 209, 176)",px:0,py:4,children:[(0,t.jsxs)(r.Flex,{alignItems:"center",height:"100%",gap:"10px",children:[(0,t.jsx)(ef.Image,{boxSize:"20px",ml:"18px",src:"/logo/recce-logo-white.png",alt:"recce-logo-white"}),(0,t.jsx)(eh.Dialog.Title,{as:"h1",fontFamily:'"Montserrat", sans-serif',fontSize:"lg",color:"white",children:"RECCE"}),(0,t.jsx)(eg.Badge,{fontSize:"sm",color:"white/80",variant:"outline",children:"Experiment"})]}),(0,t.jsx)(eh.Dialog.CloseTrigger,{asChild:!0,children:(0,t.jsx)(W.CloseButton,{size:"sm"})})]}),(0,t.jsx)(eh.Dialog.Body,{p:0,children:(0,t.jsxs)(D.VSplit,{sizes:a?[50,50]:[100,0],minSize:100*!!a,gutterSize:5*!!a,style:{flex:"1",contain:"size",height:"100%"},children:[(0,t.jsxs)(r.Flex,{direction:"column",height:"100%",m:0,p:0,children:[(0,t.jsx)(eD,{current:i,primaryKeys:x??[],setPrimaryKeys:b,onRunResultOpen:l,runQuery:S,isPending:k}),(0,t.jsx)(eT,{height:"32pxs",flex:"0 0 auto",currentModelID:i?.id??""}),(0,t.jsx)(eP,{current:i,onChange:c})]}),a?(0,t.jsx)(eN.RunResultPane,{onClose:s,disableAddToChecklist:!0}):(0,t.jsx)(n.Box,{})]})}),(0,t.jsx)(n.Box,{position:"fixed",bottom:"4",right:"4",opacity:.5,children:(0,t.jsx)(en.Tooltip,{content:"Give us feedback",children:(0,t.jsx)(ep.IconButton,{"aria-label":"feedback",variant:"ghost",size:"md",onClick:()=>{R(!0)},children:(0,t.jsx)(ev.VscFeedback,{})})})})]})})]})})}function ez({node:e,onCloseNode:o}){let i="model"===e.data.resourceType||"seed"===e.data.resourceType||"source"===e.data.resourceType||"snapshot"===e.data.resourceType,{open:r,onOpen:a,onClose:s}=(0,J.useDisclosure)(),{open:l,onClose:c}=(0,J.useDisclosure)({defaultOpen:!0}),{runAction:u}=(0,_.useRecceActionContext)(),{isActionAvailable:g}=(0,k.useLineageGraphContext)(),h=()=>{u("row_count",{node_names:[e.data.name]},{showForm:!1,showLast:!1})},p=()=>{u("row_count_diff",{node_names:[e.data.name]},{showForm:!1,showLast:!1})},{singleEnv:f}=(0,R.useRecceInstanceContext)(),m=(e,t)=>e?eo.DisableTooltipMessages.add_or_remove:g(t)?"":"This action is not supported yet.",x=Object.keys(e.data.data.base?.columns??{}),y=Object.keys(e.data.data.current?.columns??{});return(0,t.jsxs)(K.Grid,{height:"100%",templateRows:"auto auto 1fr",children:[(0,t.jsxs)(Q.HStack,{children:[(0,t.jsx)(n.Box,{flex:"0 1 20%",p:"16px",children:(0,t.jsx)(Z.Heading,{size:"sm",className:"no-track-pii-safe",children:e.data.name})}),(0,t.jsx)(X.Spacer,{}),f?(0,t.jsx)(eB,{node:e,baseColumns:x,currentColumns:y,refetchRowCount:h,disableReason:m}):(0,t.jsx)(eA,{node:e,baseColumns:x,currentColumns:y,disableReason:m,refetchRowCountDiff:p,onSandboxOpen:a}),(0,t.jsx)(n.Box,{flex:"0 1 1%",children:(0,t.jsx)(W.CloseButton,{size:"2xs",onClick:o})})]}),(0,t.jsx)(n.Box,{color:"gray",paddingLeft:"16px",children:(0,t.jsxs)(Q.HStack,{gap:"8px",children:[(0,t.jsx)(eu.ResourceTypeTag,{node:e}),("model"===e.data.resourceType||"snapshot"===e.data.resourceType||"seed"===e.data.resourceType)&&(f?(0,t.jsx)(eu.RowCountTag,{node:e,onRefresh:h}):(0,t.jsx)(eu.RowCountDiffTag,{node:e,onRefresh:p}))]})}),i&&(0,t.jsxs)(Y.Tabs.Root,{defaultValue:"columns",overflow:"auto",children:[f&&l&&(0,t.jsx)(n.Box,{p:"12px",children:(0,t.jsx)(es.RecceNotification,{onClose:c,align:"flex-start",children:(0,t.jsxs)(d.Text,{children:["Enable the Recce Checklist and start adding checks for better data validation and review.",(0,t.jsx)("br",{}),(0,t.jsx)(es.LearnHowLink,{})]})})}),(0,t.jsxs)(Y.Tabs.List,{children:[(0,t.jsx)(Y.Tabs.Trigger,{value:"columns",children:"Columns"}),(0,t.jsx)(Y.Tabs.Trigger,{value:"code",children:"Code"})]}),(0,t.jsxs)(Y.Tabs.ContentGroup,{overflow:"auto",height:"calc(100% - 42px)",children:[(0,t.jsx)(Y.Tabs.Content,{value:"columns",p:0,overflowY:"auto",height:"100%",children:f?(0,t.jsx)(ed.SingleEnvSchemaView,{current:e.data.data.current}):(0,t.jsx)(ed.SchemaView,{base:e.data.data.base,current:e.data.data.current})}),(0,t.jsx)(Y.Tabs.Content,{value:"code",height:"100%",p:0,children:(0,t.jsx)(ec.NodeSqlView,{node:e})})]})]}),(0,t.jsx)(eL,{isOpen:r,onClose:s,current:e.data.data.current})]})}function eB({node:e,baseColumns:n,currentColumns:i,refetchRowCount:r,disableReason:s}){let[,l]=(0,I.useAppLocation)(),{setSqlQuery:d}=(0,er.useRecceQueryContext)(),{runAction:c}=(0,_.useRecceActionContext)(),{envInfo:u}=(0,k.useLineageGraphContext)(),g="added"===e.data.changeStatus||"removed"===e.data.changeStatus,h=(0,ei.formatSelectColumns)(n,i),p=`select * from {{ ref("${e.data.name}") }}`;return(h.length&&(p=`select 
  ${h.join("\n  ")}
from {{ ref("${e.data.name}") }}`),"model"===e.data.resourceType||"seed"===e.data.resourceType||"snapshot"===e.data.resourceType)?(0,t.jsxs)(q.Menu.Root,{children:[(0,t.jsx)(q.Menu.Trigger,{asChild:!0,children:(0,t.jsxs)(o.Button,{size:"xs",variant:"outline",children:["Explore ",(0,t.jsx)(ee.PiCaretDown,{})]})}),(0,t.jsx)(U.Portal,{children:(0,t.jsx)(q.Menu.Positioner,{children:(0,t.jsxs)(q.Menu.Content,{children:[(0,t.jsxs)(q.Menu.Item,{value:"label",fontSize:"14px",onClick:()=>{u?.adapterType==="dbt"?d(p):u?.adapterType==="sqlmesh"&&d(`select * from ${e.data.name}`),l("/query")},children:[(0,t.jsx)(a.Icon,{as:(0,el.findByRunType)("query").icon})," Query"]}),(0,t.jsxs)(q.Menu.Item,{value:"row-count",fontSize:"14px",onClick:()=>{r()},children:[(0,t.jsx)(a.Icon,{as:(0,el.findByRunType)("row_count").icon})," Row Count"]}),(0,t.jsx)(en.Tooltip,{content:s(g,"profile"),positioning:{placement:"left"},children:(0,t.jsxs)(q.Menu.Item,{value:"profile",fontSize:"14px",disabled:g,onClick:()=>{c("profile",{model:e.data.name},{showForm:!0,showLast:!1})},children:[(0,t.jsx)(a.Icon,{as:(0,el.findByRunType)("profile").icon})," Profile"]})})]})})})]}):(0,t.jsx)(t.Fragment,{})}function eA({node:e,baseColumns:n,currentColumns:i,disableReason:r,onSandboxOpen:s,refetchRowCountDiff:l}){let[,d]=(0,I.useAppLocation)(),{runAction:c}=(0,_.useRecceActionContext)(),{setSqlQuery:u,setPrimaryKeys:g}=(0,er.useRecceQueryContext)(),{envInfo:p,isActionAvailable:f}=(0,k.useLineageGraphContext)(),{featureToggles:m}=(0,R.useRecceInstanceContext)(),{primaryKey:x}=(0,ea.default)(e.data.name),y="metadata only"===m.mode,b="added"===e.data.changeStatus||"removed"===e.data.changeStatus,w=(0,h.useCallback)(async()=>{let t=e.id,n=await (0,v.createSchemaDiffCheck)({node_id:t});d(`/checks/?id=${n.check_id}`)},[e,d]),j=(0,ei.formatSelectColumns)(n,i),S=`select * from {{ ref("${e.data.name}") }}`;j.length&&(S=`select 
  ${j.join("\n  ")}
from {{ ref("${e.data.name}") }}`);let M=(e,n)=>{if(y)return(0,t.jsx)(et.default,{display:!0,children:e});let o=r(b,n);return(0,t.jsx)(en.Tooltip,{disabled:""===o,content:o,positioning:{placement:"left"},children:e})};return"model"===e.data.resourceType||"seed"===e.data.resourceType||"snapshot"===e.data.resourceType?(0,t.jsxs)(q.Menu.Root,{children:[(0,t.jsx)(q.Menu.Trigger,{asChild:!0,children:(0,t.jsxs)(o.Button,{size:"2xs",variant:"outline",disabled:m.disableNodeActionDropdown,children:["Explore ",(0,t.jsx)(ee.PiCaretDown,{})]})}),(0,t.jsx)(U.Portal,{children:(0,t.jsx)(q.Menu.Positioner,{children:(0,t.jsxs)(q.Menu.Content,{children:[(0,t.jsx)(et.default,{display:y,children:(0,t.jsxs)(q.Menu.Item,{value:"query",fontSize:"14px",disabled:m.disableDatabaseQuery,onClick:()=>{p?.adapterType==="dbt"?u(S):p?.adapterType==="sqlmesh"&&u(`select * from ${e.data.name}`),f("query_diff_with_primary_key")&&g(void 0!==x?[x]:void 0),d("/query")},children:[(0,t.jsx)(a.Icon,{as:(0,el.findByRunType)("query_diff").icon})," Query"]})}),(0,t.jsx)(et.default,{display:y,children:(0,t.jsxs)(q.Menu.Item,{value:"sandbox",fontSize:"14px",disabled:m.disableDatabaseQuery,onClick:()=>{f("query_diff_with_primary_key")&&g(void 0!==x?[x]:void 0),s(),(0,C.trackPreviewChange)({action:"explore",node:e.data.name})},children:[(0,t.jsx)(a.Icon,{as:(0,el.findByRunType)("sandbox").icon})," Sandbox (Experiment)"]})}),(0,t.jsx)(q.Menu.Separator,{}),(0,t.jsxs)(q.Menu.ItemGroup,{m:"0",p:"0",children:[(0,t.jsx)(q.Menu.ItemGroupLabel,{children:"Diff"}),(0,t.jsx)(et.default,{display:y,children:(0,t.jsxs)(q.Menu.Item,{value:"row-count-diff",fontSize:"14px",disabled:m.disableDatabaseQuery,onClick:()=>{l()},children:[(0,t.jsx)(a.Icon,{as:(0,el.findByRunType)("row_count_diff").icon})," Row Count Diff"]})}),M((0,t.jsxs)(q.Menu.Item,{value:"profile-diff",fontSize:"14px",disabled:b||m.disableDatabaseQuery,onClick:()=>{c("profile_diff",{model:e.data.name},{showForm:!0,showLast:!1})},children:[(0,t.jsx)(a.Icon,{as:(0,el.findByRunType)("profile_diff").icon})," Profile Diff"]}),"profile_diff"),M((0,t.jsxs)(q.Menu.Item,{value:"value-diff",fontSize:"14px",disabled:b||m.disableDatabaseQuery,onClick:()=>{c("value_diff",{model:e.data.name},{showForm:!0,showLast:!1})},children:[(0,t.jsx)(a.Icon,{as:(0,el.findByRunType)("value_diff").icon})," Value Diff"]}),"value_diff"),M((0,t.jsxs)(q.Menu.Item,{value:"top-k-diff",fontSize:"14px",disabled:b||m.disableDatabaseQuery,onClick:()=>{c("top_k_diff",{model:e.data.name,column_name:"",k:50},{showForm:!0})},children:[(0,t.jsx)(a.Icon,{as:(0,el.findByRunType)("top_k_diff").icon})," Top-K Diff"]}),"top_k_diff"),M((0,t.jsxs)(q.Menu.Item,{value:"histogram-diff",fontSize:"14px",disabled:b||m.disableDatabaseQuery,onClick:()=>{c("histogram_diff",{model:e.data.name,column_name:"",column_type:""},{showForm:!0})},children:[(0,t.jsx)(a.Icon,{as:(0,el.findByRunType)("histogram_diff").icon})," Histogram Diff"]}),"histogram_diff")]}),(0,t.jsx)(q.Menu.Separator,{}),(0,t.jsxs)(q.Menu.ItemGroup,{m:"0",p:"4px 12px",children:[(0,t.jsx)(q.Menu.ItemGroupLabel,{children:"Add to Checklist"}),(0,t.jsxs)(q.Menu.Item,{value:"schema-diff",fontSize:"14px",onClick:()=>{w()},children:[(0,t.jsx)(a.Icon,{as:(0,el.findByRunType)("schema_diff").icon})," Schema Diff"]})]})]})})})]}):(0,t.jsx)(t.Fragment,{})}var eO=e.i(272875),eF=e.i(407101),eV=e.i(109624),e$=e.i(373921);function eH(){let{featureToggles:e}=(0,R.useRecceInstanceContext)(),{data:n}=(0,eO.useQuery)({queryKey:eF.cacheKeys.instanceInfo(),queryFn:eV.getRecceInstanceInfo});return"metadata only"!==e.mode?null:(0,t.jsx)("div",{className:"flex items-center w-full px-2 py-0.5 bg-cyan-50",children:(0,t.jsxs)(Q.HStack,{flex:"1",fontSize:"sm",color:"cyan.600",children:[(0,t.jsx)(ee.PiInfo,{}),(0,t.jsx)(d.Text,{children:"Query functions disabled without a data warehouse connection."}),(0,t.jsx)(o.Button,{bgColor:"iochmara.400",size:"2xs",onClick:()=>{window.open((0,e$.getSettingsUrl)(n),"_blank")},children:"Connect to Data Warehouse"})]})})}var eG=e.i(783586),eW=e.i(248859);let eK={mode:"per_node",status:"pending",completed:0,total:0,actions:{}},eZ=function(){let{open:e,onOpen:i,onClose:a}=(0,J.useDisclosure)(),[s,l]=(0,h.useState)(0),[d,c]=(0,h.useState)(),u=(0,h.useRef)(null),g=(0,h.useCallback)(e=>(l(e),new Promise(e=>{c(()=>e),i()})),[i]),p=()=>{d?.(!1),a()};return{confirm:g,AlertDialog:(0,t.jsx)(eh.Dialog.Root,{size:"xl",open:e,role:"alertdialog",initialFocusEl:()=>u.current,onOpenChange:p,children:(0,t.jsxs)(U.Portal,{children:[(0,t.jsx)(eh.Dialog.Backdrop,{}),(0,t.jsx)(eh.Dialog.Positioner,{children:(0,t.jsxs)(eh.Dialog.Content,{children:[(0,t.jsx)(eh.Dialog.Header,{fontSize:"lg",fontWeight:"bold",children:(0,t.jsxs)(eh.Dialog.Title,{children:["Value Diff on ",s," nodes"]})}),(0,t.jsx)(eh.Dialog.Body,{gap:"20px",as:r.Flex,direction:"column",children:(0,t.jsxs)(n.Box,{children:["Value diff will be executed on ",s," nodes in the Lineage, which can add extra costs to your bill."]})}),(0,t.jsxs)(eh.Dialog.Footer,{gap:1,children:[(0,t.jsx)(o.Button,{ref:u,onClick:p,variant:"outline",colorPalette:"gray",children:"Cancel"}),(0,t.jsx)(o.Button,{colorPalette:"iochmara",onClick:()=>{d?.(!0),a()},ml:3,children:"Execute"})]}),(0,t.jsx)(eh.Dialog.CloseTrigger,{asChild:!0,children:(0,t.jsx)(W.CloseButton,{size:"sm"})})]})})]})})}},eQ={lineageGraphNode:O.GraphNode,lineageGraphColumnNode:B.GraphColumnNode},eq=[],eU={lineageGraphEdge:A.default},eX=e=>e.data.changeStatus?(0,eW.getIconForChangeStatus)(e.data.changeStatus).hexColor:"lightgray",eY=(0,h.forwardRef)(function({interactive:e=!1,...B},A){var O;let W,K=(0,u.useReactFlow)(),Z=(0,h.useRef)(null),{successToast:Q,failToast:q}=(0,E.useClipBoardToast)(),{copyToClipboard:U,ImageDownloadModal:X,ref:Y}=(0,M.useCopyToClipboard)({renderLibrary:"html-to-image",imageType:"png",shadowEffect:!0,backgroundColor:"white",ignoreElements:e=>{try{return e.classList.contains(M.IGNORE_SCREENSHOT_CLASS)}catch{if(e.className)return e.className.includes(M.IGNORE_SCREENSHOT_CLASS);return!1}},onSuccess:()=>{Q("Copied the Lineage View as an image to clipboard")},onError:e=>{console.error("Error taking screenshot",e),q("Failed to copy image to clipboard",e)}}),[J,ee,et]=(0,u.useNodesState)(eq),[en,eo,ei]=(0,u.useEdgesState)([]),{lineageGraph:er,retchLineageGraph:ea,isLoading:es,error:el,refetchRunsAggregated:ed}=(0,k.useLineageGraphContext)(),{featureToggles:ec,singleEnv:eu}=(0,R.useRecceInstanceContext)(),{runId:eg,showRunId:eh,closeRunResult:ep,runAction:ef,isRunResultOpen:em}=(0,_.useRecceActionContext)(),{run:ex}=(0,N.useRun)(eg),[ey,eb]=(0,h.useState)({...B.viewOptions}),ew=(0,h.useRef)([]).current,[ev,ej]=(0,h.useState)(void 0),eC=(0,f.useMutation)({mutationFn:b.getCll}),[ek,e_]=(0,h.useState)({}),eR=(0,h.useCallback)(e=>J.filter(p.isLineageGraphNode).find(t=>t.data.name===e),[J]);(0,h.useImperativeHandle)(A,()=>({copyToClipboard:U}));let eM=(0,h.useMemo)(()=>!!(er&&er.modifiedSet.length>0),[er]),eI=ey.view_mode??"changed_models",eE=(0,h.useMemo)(()=>J.filter(e=>"lineageGraphNode"===e.type).map(e=>e.id),[J]),eN=(0,h.useMemo)(()=>er?eE.map(e=>er.nodes[e]):[],[er,eE]),[eD,eT]=(0,h.useState)(),eP=eD?er?.nodes[eD]:void 0,[eL,eB]=(0,h.useState)(),[eA,eO]=(0,h.useState)(new Set),eF=(0,h.useMemo)(()=>er?Array.from(eA).map(e=>er.nodes[e]):[],[er,eA]),eV=((e,{onActionStarted:t,onActionNodeUpdated:n,onActionCompleted:o})=>{let i=(0,h.useRef)({...eK}).current,{showRunId:r}=(0,_.useRecceActionContext)(),a=async(a,s,l)=>{i.mode="multi_nodes",i.actions={};let d=i.mode,c=i.actions;t(),i.status="running";let u=[];for(let t of e){let e=s(t);e?(c[t.id]={mode:d,status:"skipped",skipReason:e},n(t)):(c[t.id]={mode:d,status:"pending"},u.push(t))}let g=l(u);try{let{run_id:e}=await (0,eS.submitRun)(a,g,{nowait:!0});for(r(e),i.currentRun={run_id:e},i.total=1;;){let t=await (0,eS.waitRun)(e,2);i.currentRun=t;let o=t.error?"failure":t.result?"success":"running";for(let e of u)c[e.id]={mode:d,status:o,run:t},n(e);if(t.error||t.result)break}}catch(e){}if(i.completed=1,"canceling"===i.status){i.status="canceled",o();return}i.status="completed",o()},s=async(r,a)=>{i.mode="per_node",i.actions={};let s=i.mode,l=i.actions;for(let o of(t(),i.status="running",e))l[o.id]={mode:s,status:"pending"},n(o);for(let t of(i.completed=0,i.total=e.length,e)){let{params:e,skipReason:d}=a(t);if(d)l[t.id]={mode:s,status:"skipped",skipReason:d},n(t);else try{let{run_id:o}=await (0,eS.submitRun)(r,e,{nowait:!0});for(i.currentRun={run_id:o},l[t.id]={mode:s,status:"running"},n(t);;){let e=await (0,eS.waitRun)(o,2);i.currentRun=e;let r=e.error?"failure":e.result?"success":"running";if(l[t.id]={mode:s,status:r,run:e},n(t),e.error||e.result)break}}catch(e){}finally{i.currentRun=void 0}if(i.completed++,"canceling"===i.status){i.status="canceled",o();return}}i.status="completed",o()},l=async()=>{let t=[];for(let o of e)"model"!==o.data.resourceType?(i.actions[o.id]={mode:"multi_nodes",status:"skipped",skipReason:"Not a model"},n(o)):t.push(o.data.name);await a("row_count",e=>{if("model"!==e.data.resourceType)return"Not a model"},e=>({node_names:e.map(e=>e.data.name)}))},d=async()=>{let t=[];for(let o of e)"model"!==o.data.resourceType?(i.actions[o.id]={mode:"multi_nodes",status:"skipped",skipReason:"Not a model"},n(o)):t.push(o.data.name);await a("row_count_diff",e=>{if("model"!==e.data.resourceType)return"Not a model"},e=>({node_names:e.map(e=>e.data.name)}))},c=async()=>{i.status="canceling",i.currentRun?.run_id&&await (0,eS.cancelRun)(i.currentRun.run_id)};return{actionState:i,runRowCount:l,runRowCountDiff:d,runValueDiff:async()=>{await s("value_diff",e=>{let t=e.data.data.current?.primary_key;return t?{params:{model:e.data.name,primary_key:t}}:{skipReason:"No primary key found. The first unique column is used as primary key."}})},addLineageDiffCheck:async()=>{let t=e.map(e=>e.id);return await (0,w.createLineageDiffCheck)({node_ids:t})},addSchemaDiffCheck:async()=>{let t;if(1===e.length)t=await (0,v.createSchemaDiffCheck)({node_id:e[0].id});else{let n=e.map(e=>e.id);t=await (0,v.createSchemaDiffCheck)({node_id:n})}return t},cancel:c,reset:()=>{Object.assign(i,eK)}}})(eF.length>0?eF:eN,{onActionStarted:()=>{eB("action_result")},onActionNodeUpdated:e=>{ee(t=>t.map(t=>t.id===e.id?{...t}:t))},onActionCompleted:()=>{}}),e$=(0,h.useMemo)(()=>{if(!er)return new Set;let e=new Set;if(ev){for(let[t,n]of Object.entries(ev.current.nodes))!1!==n.impacted&&e.add(t);for(let t of Object.keys(ev.current.columns))e.add(t)}else e="action_result"===eL?new Set(Object.keys(eV.actionState.actions)):eP?(0,F.union)((0,p.selectUpstream)(er,[eP.id]),(0,p.selectDownstream)(er,[eP.id])):eM?(0,p.selectDownstream)(er,er.modifiedSet):new Set(eE);return new Set(e)},[er,ev,eL,eP,eM,eV.actionState.actions,eE]),eW=(0,$.useLineageViewContextMenu)(),eY=()=>{eW.closeContextMenu()};(0,h.useLayoutEffect)(()=>{(async()=>{let e,t;if(!er)return;if(ey.node_ids)t=ey.node_ids;else{let e=er.manifestMetadata.current?.project_name,n={view_mode:ey.view_mode??(eM?"changed_models":"all"),packages:e?[e]:void 0,...B.viewOptions};try{t=(await (0,j.select)({select:n.select,exclude:n.exclude,packages:n.packages,view_mode:n.view_mode})).nodes}catch(e){n.view_mode="all",t=(await (0,j.select)({select:n.select,exclude:n.exclude,packages:n.packages,view_mode:n.view_mode})).nodes}eb(n)}if(ey.column_level_lineage)try{e=await eC.mutateAsync(ey.column_level_lineage)}catch(e){if(e instanceof m.AxiosError)return void y.toaster.create({title:"Column Level Lineage error",description:e.response?.data.detail??e.message,type:"error",closable:!0})}let[n,o,i]=(0,p.toReactFlow)(er,{selectedNodes:t,cll:e});(0,p.layout)(n,o),ee(n),eo(o),e_(i),ej(e)})()},[er]);let eJ=()=>{eT(void 0)},e0=async e=>{let t=J.find(t=>t.id===e);if(t){if(t.parentId){let e=t.parentId;t=J.find(t=>t.id===e)??t}if(null!=t.measured){let{width:e,height:n}=t.measured;if(e&&n){let o=t.position.x+e/2,i=t.position.y+n/2,r=K.getZoom();await K.setCenter(o,i,{zoom:r,duration:200})}}}},e1=(()=>{let[,e]=(0,I.useAppLocation)();return(0,h.useCallback)(t=>{t.check_id&&e(`/checks/?id=${t.check_id}`)},[e])})();O=async()=>{"selecting"!==eL&&(eD?await e0(eD):await K.fitView({nodes:J,duration:200}))},W=(0,h.useRef)({width:0,height:0}),(0,h.useEffect)(()=>{let e=Z.current,t=new ResizeObserver(e=>{for(let t of e){let e=t.contentRect.width,n=t.contentRect.height;(Math.abs(n-W.current.height)>10||Math.abs(e-W.current.width)>10)&&W.current.height>0&&n>0&&W.current.width>0&&e>0&&O(),W.current={width:e,height:n}}});return e&&t.observe(e),()=>{e&&t.unobserve(e)}},[O,Z]);let e2=async(e,t=!1)=>{let n=ey.column_level_lineage;await e8({...ey,column_level_lineage:e},!1),t||ew.push(n),e?.node_id?eT(e.node_id):eT(void 0)},e3=async e=>{if(e){if(0===ew.length)return;let e=ew.pop();e?await e2(e,!0):await e2(void 0,!0)}else await e2(void 0,!0)},e5=(t,n)=>{if(e&&er){if((0,p.isLineageGraphColumnNode)(n))return void(!eL&&e2({node_id:n.data.node.id,column:n.data.column}));if(eY(),eL)if("action_result"===eL){let e=eV.actionState.actions[n.id];e.run?.run_id&&eh(e.run.run_id),eT(n.id)}else{let e=new Set(eA);eA.has(n.id)?e.delete(n.id):e.add(n.id),eO(e),0===e.size&&eB(void 0)}else eT(n.id)}},e4=async e=>{let t,n,{viewOptions:o=ey}=e,{fitView:i}=e;if(!er)return;if(ey.select!==o.select||ey.exclude!==o.exclude||ey.packages!==o.packages||ey.view_mode!==o.view_mode){try{let e=await (0,j.select)({select:o.select,exclude:o.exclude,packages:o.packages,view_mode:o.view_mode});o={...o,column_level_lineage:void 0},t=e.nodes}catch(e){e instanceof m.AxiosError&&y.toaster.create({title:"Select node error",description:e.response?.data.detail??e.message,type:"error",closable:!0});return}eT(void 0)}else t=J.map(e=>e.id);if(o.column_level_lineage)try{n=await eC.mutateAsync(o.column_level_lineage)}catch(e){if(e instanceof m.AxiosError)return void y.toaster.create({title:"Column Level Lineage error",description:e.response?.data.detail??e.message,type:"error",closable:!0})}let[r,a,s]=(0,p.toReactFlow)(er,{selectedNodes:t,cll:n});ee(r),eo(a),e_(s),ej(n),ex&&((0,S.isTopKDiffRun)(ex)||(0,S.isProfileDiffRun)(ex)||(0,S.isHistogramDiffRun)(ex)||(0,S.isValueDiffRun)(ex)||(0,S.isValueDiffDetailRun)(ex))&&ex.params?.model&&!eR(ex.params.model)&&ep(),i&&(await new Promise(e=>setTimeout(e,1)),K.fitView({nodes:r,duration:200}))},e8=async(e,t=!0)=>{eb(e),await e4({viewOptions:e,fitView:t})},e6=eZ();(0,h.useEffect)(()=>{let t=ex?.type;if(e&&em&&!(!t||["query_diff","query","row_count"].includes(t))&&!eL){let e;((0,S.isTopKDiffRun)(ex)||(0,S.isProfileDiffRun)(ex)||(0,S.isHistogramDiffRun)(ex)||(0,S.isValueDiffRun)(ex)||(0,S.isValueDiffDetailRun)(ex))&&(e=ex.params?.model);let t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});if(e){let n=eR(e);n?(0,p.isLineageGraphNode)(n)&&eP!==n.data.data&&e5(t,n):e8({...ey,view_mode:"all"})}else eJ()}},[ex,ey,em,eL,eR,eP,e]);let e7=(t,n)=>{if(!e||"action_result"===eL)return;t.preventDefault();let o=Y.current,i=o.getBoundingClientRect(),r=t.clientX-i.left,a=t.clientY-i.top+o.offsetTop;eW.showContextMenu(r,a,n)},e9=()=>{eB(void 0),eO(new Set),eT(void 0),ep(),ed?.()},te={interactive:e,nodes:J,focusedNode:eP,selectedNodes:eF,viewOptions:ey,showContextMenu:e7,onViewOptionsChanged:e8,selectMode:eL,selectNode:e=>{if(eL){if("selecting"===eL){let t=new Set(eA);eA.has(e)?t.delete(e):t.add(e),eO(t),0===t.size&&eB(void 0)}}else er&&(eO(new Set([e])),eB("selecting"),eT(void 0),eV.reset())},selectParentNodes:(e,t=1e3)=>{if("action_result"===eL||void 0===er)return;!eL&&(eB("selecting"),eV.reset(),ey.column_level_lineage&&e8({...ey,column_level_lineage:void 0}));let n=(0,p.selectUpstream)(er,[e],t);eO((0,F.union)(eA,n))},selectChildNodes:(e,t=1e3)=>{if("action_result"===eL||void 0===er)return;!eL&&(eB("selecting"),eV.reset(),ey.column_level_lineage&&e8({...ey,column_level_lineage:void 0}));let n=(0,p.selectDownstream)(er,[e],t);eO((0,F.union)(eA,n))},deselect:e9,isNodeHighlighted:e=>e$.has(e),isNodeSelected:e=>eA.has(e),isEdgeHighlighted:(e,t)=>ev?e in ev.current.parent_map&&t in ev.current.parent_map[e]:e$.has(e)&&e$.has(t),isNodeShowingChangeAnalysis:e=>{if(!er)return!1;let t=e in er.nodes?er.nodes[e]:void 0;if(ey.column_level_lineage?.change_analysis){let n=ey.column_level_lineage;return n.node_id&&!n.column?n.node_id===e&&!!t?.data.changeStatus:!!t?.data.changeStatus}return!1},getNodeAction:e=>eV.actionState.actions[e],getNodeColumnSet:e=>e in ek?new Set(ek[e]):new Set,runRowCount:async()=>{"selecting"===eL?(await eV.runRowCount(),(0,C.trackMultiNodesAction)({type:"row_count",selected:"multi"})):eP?(ef("row_count",{node_names:[eP.data.name]},{showForm:!1,showLast:!1}),(0,C.trackMultiNodesAction)({type:"row_count",selected:"single"})):(ef("row_count",{select:ey.select,exclude:ey.exclude,packages:ey.packages,view_mode:ey.view_mode}),(0,C.trackMultiNodesAction)({type:"row_count",selected:"none"}))},runRowCountDiff:async()=>{"selecting"===eL?(await eV.runRowCountDiff(),(0,C.trackMultiNodesAction)({type:"row_count_diff",selected:"multi"})):eP?(ef("row_count_diff",{node_names:[eP.data.name]},{showForm:!1,showLast:!1}),(0,C.trackMultiNodesAction)({type:"row_count_diff",selected:"single"})):(ef("row_count_diff",{select:ey.select,exclude:ey.exclude,packages:ey.packages,view_mode:ey.view_mode}),(0,C.trackMultiNodesAction)({type:"row_count_diff",selected:"none"}))},runValueDiff:async()=>{if(eP)ef("value_diff",{model:eP.data.name},{showForm:!0,showLast:!1}),(0,C.trackMultiNodesAction)({type:"value_diff",selected:"single"});else{let e="selecting"===eL?eF.length:eE.length;await e6.confirm(e)&&(await eV.runValueDiff(),(0,C.trackMultiNodesAction)({type:"value_diff",selected:"selecting"===eL?"multi":"none"}))}},addLineageDiffCheck:async()=>{let e;"selecting"===eL?(e=await eV.addLineageDiffCheck(),e9(),(0,C.trackMultiNodesAction)({type:"lineage_diff",selected:"multi"})):eP||(e=await (0,w.createLineageDiffCheck)(ey),(0,C.trackMultiNodesAction)({type:"lineage_diff",selected:"none"})),e&&e1(e)},addSchemaDiffCheck:async()=>{let e;"selecting"===eL?eF.length>0&&(e=await eV.addSchemaDiffCheck(),e9(),(0,C.trackMultiNodesAction)({type:"schema_diff",selected:"multi"})):eP?(e=await (0,v.createSchemaDiffCheck)({node_id:eP.id}),(0,C.trackMultiNodesAction)({type:"schema_diff",selected:"single"})):(e=await (0,v.createSchemaDiffCheck)({select:ey.select,exclude:ey.exclude,packages:ey.packages,view_mode:ey.view_mode}),(0,C.trackMultiNodesAction)({type:"schema_diff",selected:"none"})),e&&e1(e)},cancel:eV.cancel,actionState:eV.actionState,centerNode:e0,cll:ev,showColumnLevelLineage:e2,resetColumnLevelLineage:e3};return es?(0,t.jsx)(r.Flex,{width:"100%",height:"100%",alignItems:"center",justifyContent:"center",children:(0,t.jsx)(s.Spinner,{size:"xl"})}):el?(0,t.jsx)(i.Center,{h:"100%",children:(0,t.jsxs)(c.VStack,{children:[(0,t.jsx)(n.Box,{children:"Failed to load lineage data. This could be because the server has been terminated or there is a network error."}),(0,t.jsxs)(n.Box,{children:["[Reason: ",el,"]"]}),(0,t.jsx)(o.Button,{colorPalette:"blue",onClick:()=>{ea&&ea()},children:"Retry"})]})}):er&&J!=eq?"changed_models"!==eI||er.modifiedSet.length?(0,t.jsxs)(V.LineageViewContext.Provider,{value:te,children:[(0,t.jsxs)(D.HSplit,{sizes:eP?[70,30]:[100,0],minSize:400*!!eP,gutterSize:5*!!eP,style:{height:"100%",width:"100%"},children:[(0,t.jsxs)(c.VStack,{ref:Z,separator:(0,t.jsx)(l.StackSeparator,{borderColor:"gray.200"}),gap:0,style:{contain:"strict"},position:"relative",children:[e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(G.LineageViewTopBar,{}),"metadata only"===ec.mode&&(0,t.jsx)(eH,{})]}),(0,t.jsxs)(u.ReactFlow,{proOptions:{hideAttribution:!0},nodeTypes:eQ,edgeTypes:eU,nodes:J,edges:en,onNodesChange:et,onEdgesChange:ei,onNodeClick:e5,onNodeContextMenu:e7,onClick:eY,onInit:async()=>{if(eM)await K.fitView();else{let e=(0,g.getNodesBounds)(J,{});await K.setCenter(e.x+e.width/2,e.y+e.height/2,{zoom:1})}},maxZoom:1,minZoom:.1,nodesDraggable:e,ref:Y,children:[(0,t.jsx)(u.Background,{color:"#ccc"}),(0,t.jsx)(u.Controls,{showInteractive:!1,position:"top-right",className:M.IGNORE_SCREENSHOT_CLASS,children:(0,t.jsx)(u.ControlButton,{title:"copy image",onClick:async()=>{await U(),(0,C.trackCopyToClipboard)({type:eI,from:"lineage_view"})},children:(0,t.jsx)(a.Icon,{as:x.FiCopy})})}),(0,t.jsx)(X,{}),(0,t.jsx)(u.Panel,{position:"bottom-left",children:(0,t.jsxs)(r.Flex,{direction:"column",gap:"5px",children:[eM&&(0,t.jsx)(P.ChangeStatusLegend,{}),ey.column_level_lineage&&(0,t.jsx)(z.ColumnLevelLineageLegend,{})]})}),(0,t.jsx)(u.Panel,{position:"top-center",children:(0,t.jsx)(H.LineageViewNotification,{notification:eu?(0,t.jsx)(eG.BaseEnvironmentSetupNotification,{}):null,type:"info"})}),(0,t.jsx)(u.Panel,{position:"top-left",children:(0,t.jsxs)(r.Flex,{direction:"column",gap:"5px",children:[(0,t.jsx)(L.ColumnLevelLineageControl,{action:eC}),0==J.length&&(0,t.jsx)(d.Text,{fontSize:"xl",color:"grey",opacity:.5,children:"No nodes"})]})}),(0,t.jsx)(u.MiniMap,{nodeColor:eX,nodeStrokeWidth:3,zoomable:!0,pannable:!0}),"action_result"===eL&&(0,t.jsx)(u.Panel,{position:"bottom-center",className:M.IGNORE_SCREENSHOT_CLASS,children:(0,t.jsx)(T.ActionControl,{onClose:()=>{e9()}})})]}),(0,t.jsx)($.LineageViewContextMenu,{...eW.props})]}),eP?(0,t.jsx)(n.Box,{borderLeft:"solid 1px lightgray",height:"100%",children:(0,t.jsx)(ez,{node:eP,onCloseNode:eJ})}):(0,t.jsx)(n.Box,{})]}),e6.AlertDialog]}):(0,t.jsx)(i.Center,{h:"100%",children:(0,t.jsxs)(c.VStack,{children:[(0,t.jsx)(t.Fragment,{children:"No change detected"}),(0,t.jsx)(o.Button,{colorPalette:"blue",onClick:async()=>{await e8({...ey,view_mode:"all"})},children:"Show all nodes"})]})}):(0,t.jsx)(t.Fragment,{})});e.s(["LineageView",0,eY],302061)}]);