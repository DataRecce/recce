(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,581435,e=>{"use strict";var t=e.i(487122),n=e.i(868422);function o(e,o){return(0,n.formatDistance)(e,(0,t.constructFrom)(e,Date.now()),o)}e.s(["formatDistanceToNow",()=>o],581435)},107983,(e,t,n)=>{"use strict";var o=e.r(187725),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},r=o.useState,a=o.useEffect,s=o.useLayoutEffect,l=o.useDebugValue;function d(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(e){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),o=r({inst:{value:n,getSnapshot:t}}),i=o[0].inst,c=o[1];return s(function(){i.value=n,i.getSnapshot=t,d(i)&&c({inst:i})},[e,n,t]),a(function(){return d(i)&&c({inst:i}),e(function(){d(i)&&c({inst:i})})},[e]),l(n),n};n.useSyncExternalStore=void 0!==o.useSyncExternalStore?o.useSyncExternalStore:c},33347,(e,t,n)=>{"use strict";t.exports=e.r(107983)},683842,(e,t,n)=>{"use strict";var o=e.r(187725),i=e.r(33347),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=i.useSyncExternalStore,s=o.useRef,l=o.useEffect,d=o.useMemo,c=o.useDebugValue;n.useSyncExternalStoreWithSelector=function(e,t,n,o,i){var u=s(null);if(null===u.current){var g={hasValue:!1,value:null};u.current=g}else g=u.current;var h=a(e,(u=d(function(){function e(e){if(!l){if(l=!0,a=e,e=o(e),void 0!==i&&g.hasValue){var t=g.value;if(i(t,e))return s=t}return s=e}if(t=s,r(a,e))return t;var n=o(e);return void 0!==i&&i(t,n)?(a=e,t):(a=e,s=n)}var a,s,l=!1,d=void 0===n?null:n;return[function(){return e(t())},null===d?void 0:function(){return e(d())}]},[t,n,o,i]))[0],u[1]);return l(function(){g.hasValue=!0,g.value=h},[h]),c(h),h}},551165,(e,t,n)=>{"use strict";t.exports=e.r(683842)},918132,953131,323194,987923,2216,525519,248859,88515,166598,904451,632951,676502,163669,636819,592355,832421,739145,428537,224779,765996,637418,634513,e=>{"use strict";e.i(316575);var t,n,o=e.i(19483),i=e.i(187725);function r(e){if("string"==typeof e||"number"==typeof e)return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)""!==(o=r(e[n]))&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var a=e.i(292002),s=e.i(551165);let l={get url(){return`file://${e.P("node_modules/.pnpm/zustand@4.5.7_@types+react@19.2.7_react@19.2.3/node_modules/zustand/esm/vanilla.mjs")}`}},d=e=>{let t,n=new Set,o=(e,o)=>{let i="function"==typeof e?e(t):e;if(!Object.is(i,t)){let e=t;t=(null!=o?o:"object"!=typeof i||null===i)?i:Object.assign({},t,i),n.forEach(n=>n(t,e))}},i=()=>t,r={setState:o,getState:i,getInitialState:()=>a,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{(l.env?l.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},a=t=e(o,i,r);return r},{useDebugValue:c}=i.default,{useSyncExternalStoreWithSelector:u}=s.default,g=e=>e;function h(e,t=g,n){let o=u(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return c(o),o}let p=(e,t)=>{let n=e?d(e):d,o=(e,o=t)=>h(n,e,o);return Object.assign(o,n),o};function f(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[n,o]of e)if(!Object.is(o,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}let n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}e.i(316245);let m=(0,i.createContext)(null),x=m.Provider,y=a.errorMessages.error001();function b(e,t){let n=(0,i.useContext)(m);if(null===n)throw Error(y);return h(n,e,t)}function w(){let e=(0,i.useContext)(m);if(null===e)throw Error(y);return(0,i.useMemo)(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}let C={display:"none"},v={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},S="react-flow__node-desc",j="react-flow__edge-desc",_=e=>e.ariaLiveMessage,k=e=>e.ariaLabelConfig;function E({rfId:e}){let t=b(_);return(0,o.jsx)("div",{id:`react-flow__aria-live-${e}`,"aria-live":"assertive","aria-atomic":"true",style:v,children:t})}function R({rfId:e,disableKeyboardA11y:t}){let n=b(k);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{id:`${S}-${e}`,style:C,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),(0,o.jsx)("div",{id:`${j}-${e}`,style:C,children:n["edge.a11yDescription.default"]}),!t&&(0,o.jsx)(E,{rfId:e})]})}let N=(0,i.forwardRef)(({position:e="top-left",children:t,className:n,style:i,...a},s)=>{let l=`${e}`.split("-");return(0,o.jsx)("div",{className:r(["react-flow__panel",n,...l]),style:i,ref:s,...a,children:t})});function I({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:(0,o.jsx)(N,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:(0,o.jsx)("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}N.displayName="Panel";let M=e=>{let t=[],n=[];for(let[,n]of e.nodeLookup)n.selected&&t.push(n.internals.userNode);for(let[,t]of e.edgeLookup)t.selected&&n.push(t);return{selectedNodes:t,selectedEdges:n}},T=e=>e.id;function D(e,t){return f(e.selectedNodes.map(T),t.selectedNodes.map(T))&&f(e.selectedEdges.map(T),t.selectedEdges.map(T))}function L({onSelectionChange:e}){let t=w(),{selectedNodes:n,selectedEdges:o}=b(M,D);return(0,i.useEffect)(()=>{let i={nodes:n,edges:o};e?.(i),t.getState().onSelectionChangeHandlers.forEach(e=>e(i))},[n,o,e]),null}let P=e=>!!e.onSelectionChangeHandlers;function O({onSelectionChange:e}){let t=b(P);return e||t?(0,o.jsx)(L,{onSelectionChange:e}):null}let A=[0,0],z={x:0,y:0,zoom:1},B=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode","rfId"],F=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),V={translateExtent:a.infiniteExtent,nodeOrigin:A,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function $(e){let{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:r,setTranslateExtent:s,setNodeExtent:l,reset:d,setDefaultNodesAndEdges:c}=b(F,f),u=w();(0,i.useEffect)(()=>(c(e.defaultNodes,e.defaultEdges),()=>{g.current=V,d()}),[]);let g=(0,i.useRef)(V);return(0,i.useEffect)(()=>{for(let i of B){let d=e[i];d!==g.current[i]&&void 0!==e[i]&&("nodes"===i?t(d):"edges"===i?n(d):"minZoom"===i?o(d):"maxZoom"===i?r(d):"translateExtent"===i?s(d):"nodeExtent"===i?l(d):"ariaLabelConfig"===i?u.setState({ariaLabelConfig:(0,a.mergeAriaLabelConfig)(d)}):"fitView"===i?u.setState({fitViewQueued:d}):"fitViewOptions"===i?u.setState({fitViewOptions:d}):u.setState({[i]:d}))}g.current=e},B.map(t=>e[t])),null}function H(){return"undefined"!=typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null}let G="undefined"!=typeof document?document:null;function U(e=null,t={target:G,actInsideInputWithModifier:!0}){let[n,o]=(0,i.useState)(!1),r=(0,i.useRef)(!1),s=(0,i.useRef)(new Set([])),[l,d]=(0,i.useMemo)(()=>{if(null!==e){let t=(Array.isArray(e)?e:[e]).filter(e=>"string"==typeof e).map(e=>e.replace("+","\n").replace("\n\n","\n+").split("\n")),n=t.reduce((e,t)=>e.concat(...t),[]);return[t,n]}return[[],[]]},[e]);return(0,i.useEffect)(()=>{let n=t?.target??G,i=t?.actInsideInputWithModifier??!0;if(null!==e){let e=e=>{if(r.current=e.ctrlKey||e.metaKey||e.shiftKey||e.altKey,(!r.current||r.current&&!i)&&(0,a.isInputDOMNode)(e))return!1;let n=W(e.code,d);if(s.current.add(e[n]),X(l,s.current,!1)){let n=e.composedPath?.()?.[0]||e.target,i=n?.nodeName==="BUTTON"||n?.nodeName==="A";!1!==t.preventDefault&&(r.current||!i)&&e.preventDefault(),o(!0)}},c=e=>{let t=W(e.code,d);X(l,s.current,!0)?(o(!1),s.current.clear()):s.current.delete(e[t]),"Meta"===e.key&&s.current.clear(),r.current=!1},u=()=>{s.current.clear(),o(!1)};return n?.addEventListener("keydown",e),n?.addEventListener("keyup",c),window.addEventListener("blur",u),window.addEventListener("contextmenu",u),()=>{n?.removeEventListener("keydown",e),n?.removeEventListener("keyup",c),window.removeEventListener("blur",u),window.removeEventListener("contextmenu",u)}}},[e,o]),n}function X(e,t,n){return e.filter(e=>n||e.length===t.size).some(e=>e.every(e=>t.has(e)))}function W(e,t){return t.includes(e)?"code":"key"}function K(e,t){let n=[],o=new Map,i=[];for(let t of e)if("add"===t.type){i.push(t);continue}else if("remove"===t.type||"replace"===t.type)o.set(t.id,[t]);else{let e=o.get(t.id);e?e.push(t):o.set(t.id,[t])}for(let e of t){let t=o.get(e.id);if(!t){n.push(e);continue}if("remove"===t[0].type)continue;if("replace"===t[0].type){n.push({...t[0].item});continue}let i={...e};for(let e of t){var r=e,a=i;switch(r.type){case"select":a.selected=r.selected;break;case"position":void 0!==r.position&&(a.position=r.position),void 0!==r.dragging&&(a.dragging=r.dragging);break;case"dimensions":void 0!==r.dimensions&&(a.measured={...r.dimensions},r.setAttributes&&((!0===r.setAttributes||"width"===r.setAttributes)&&(a.width=r.dimensions.width),(!0===r.setAttributes||"height"===r.setAttributes)&&(a.height=r.dimensions.height))),"boolean"==typeof r.resizing&&(a.resizing=r.resizing)}}n.push(i)}return i.length&&i.forEach(e=>{void 0!==e.index?n.splice(e.index,0,{...e.item}):n.push({...e.item})}),n}function Z(e,t){return{id:e,type:"select",selected:t}}function Q(e,t=new Set,n=!1){let o=[];for(let[i,r]of e){let e=t.has(i);(void 0!==r.selected||e)&&r.selected!==e&&(n&&(r.selected=e),o.push(Z(r.id,e)))}return o}function q({items:e=[],lookup:t}){let n=[],o=new Map(e.map(e=>[e.id,e]));for(let[o,i]of e.entries()){let e=t.get(i.id),r=e?.internals?.userNode??e;void 0!==r&&r!==i&&n.push({id:i.id,item:i,type:"replace"}),void 0===r&&n.push({item:i,type:"add",index:o})}for(let[e]of t)void 0===o.get(e)&&n.push({id:e,type:"remove"});return n}function Y(e){return{id:e.id,type:"remove"}}let J=e=>(0,a.isNodeBase)(e);function ee(e){return(0,i.forwardRef)(e)}let et="undefined"!=typeof window?i.useLayoutEffect:i.useEffect;function en(e){let[t,n]=(0,i.useState)(BigInt(0)),[o]=(0,i.useState)(()=>{var e;let t;return e=()=>n(e=>e+BigInt(1)),t=[],{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}});return et(()=>{let t=o.get();t.length&&(e(t),o.reset())},[t]),o}let eo=(0,i.createContext)(null);function ei({children:e}){let t=w(),n=en((0,i.useCallback)(e=>{let{nodes:n=[],setNodes:o,hasDefaultNodes:i,onNodesChange:r,nodeLookup:a,fitViewQueued:s,onNodesChangeMiddlewareMap:l}=t.getState(),d=n;for(let t of e)d="function"==typeof t?t(d):t;let c=q({items:d,lookup:a});for(let e of l.values())c=e(c);i&&o(d),c.length>0?r?.(c):s&&window.requestAnimationFrame(()=>{let{fitViewQueued:e,nodes:n,setNodes:o}=t.getState();e&&o(n)})},[])),r=en((0,i.useCallback)(e=>{let{edges:n=[],setEdges:o,hasDefaultEdges:i,onEdgesChange:r,edgeLookup:a}=t.getState(),s=n;for(let t of e)s="function"==typeof t?t(s):t;i?o(s):r&&r(q({items:s,lookup:a}))},[])),a=(0,i.useMemo)(()=>({nodeQueue:n,edgeQueue:r}),[]);return(0,o.jsx)(eo.Provider,{value:a,children:e})}let er=e=>!!e.panZoom;function ea(){let e,t=(e=w(),(0,i.useMemo)(()=>({zoomIn:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{let{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{let{transform:[o,i,r],panZoom:a}=e.getState();return a?(await a.setViewport({x:t.x??o,y:t.y??i,zoom:t.zoom??r},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{let[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{let{width:o,height:i,minZoom:r,maxZoom:s,panZoom:l}=e.getState(),d=(0,a.getViewportForBounds)(t,o,i,r,s,n?.padding??.1);return l?(await l.setViewport(d,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{let{transform:o,snapGrid:i,snapToGrid:r,domNode:s}=e.getState();if(!s)return t;let{x:l,y:d}=s.getBoundingClientRect(),c={x:t.x-l,y:t.y-d},u=n.snapGrid??i,g=n.snapToGrid??r;return(0,a.pointToRendererPoint)(c,o,g,u)},flowToScreenPosition:t=>{let{transform:n,domNode:o}=e.getState();if(!o)return t;let{x:i,y:r}=o.getBoundingClientRect(),s=(0,a.rendererPointToPoint)(t,n);return{x:s.x+i,y:s.y+r}}}),[])),n=w(),o=function(){let e=(0,i.useContext)(eo);if(!e)throw Error("useBatchContext must be used within a BatchProvider");return e}(),r=b(er),s=(0,i.useMemo)(()=>{let e=e=>n.getState().nodeLookup.get(e),t=e=>{o.nodeQueue.push(e)},i=e=>{o.edgeQueue.push(e)},r=e=>{let{nodeLookup:t,nodeOrigin:o}=n.getState(),i=J(e)?e:t.get(e.id),r=i.parentId?(0,a.evaluateAbsolutePosition)(i.position,i.measured,i.parentId,t,o):i.position,s={...i,position:r,width:i.measured?.width??i.width,height:i.measured?.height??i.height};return(0,a.nodeToRect)(s)},s=(e,n,o={replace:!1})=>{t(t=>t.map(t=>{if(t.id===e){let e="function"==typeof n?n(t):n;return o.replace&&J(e)?e:{...t,...e}}return t}))},l=(e,t,n={replace:!1})=>{i(o=>o.map(o=>{if(o.id===e){let e="function"==typeof t?t(o):t;return n.replace&&(0,a.isEdgeBase)(e)?e:{...o,...e}}return o}))};return{getNodes:()=>n.getState().nodes.map(e=>({...e})),getNode:t=>e(t)?.internals.userNode,getInternalNode:e,getEdges:()=>{let{edges:e=[]}=n.getState();return e.map(e=>({...e}))},getEdge:e=>n.getState().edgeLookup.get(e),setNodes:t,setEdges:i,addNodes:e=>{let t=Array.isArray(e)?e:[e];o.nodeQueue.push(e=>[...e,...t])},addEdges:e=>{let t=Array.isArray(e)?e:[e];o.edgeQueue.push(e=>[...e,...t])},toObject:()=>{let{nodes:e=[],edges:t=[],transform:o}=n.getState(),[i,r,a]=o;return{nodes:e.map(e=>({...e})),edges:t.map(e=>({...e})),viewport:{x:i,y:r,zoom:a}}},deleteElements:async({nodes:e=[],edges:t=[]})=>{let{nodes:o,edges:i,onNodesDelete:r,onEdgesDelete:s,triggerNodeChanges:l,triggerEdgeChanges:d,onDelete:c,onBeforeDelete:u}=n.getState(),{nodes:g,edges:h}=await (0,a.getElementsToRemove)({nodesToRemove:e,edgesToRemove:t,nodes:o,edges:i,onBeforeDelete:u}),p=h.length>0,f=g.length>0;if(p){let e=h.map(Y);s?.(h),d(e)}if(f){let e=g.map(Y);r?.(g),l(e)}return(f||p)&&c?.({nodes:g,edges:h}),{deletedNodes:g,deletedEdges:h}},getIntersectingNodes:(e,t=!0,o)=>{let i=(0,a.isRectObject)(e),s=i?e:r(e),l=void 0!==o;return s?(o||n.getState().nodes).filter(o=>{let r=n.getState().nodeLookup.get(o.id);if(r&&!i&&(o.id===e.id||!r.internals.positionAbsolute))return!1;let d=(0,a.nodeToRect)(l?o:r),c=(0,a.getOverlappingArea)(d,s);return t&&c>0||c>=d.width*d.height||c>=s.width*s.height}):[]},isNodeIntersecting:(e,t,n=!0)=>{let o=(0,a.isRectObject)(e)?e:r(e);if(!o)return!1;let i=(0,a.getOverlappingArea)(o,t);return n&&i>0||i>=t.width*t.height||i>=o.width*o.height},updateNode:s,updateNodeData:(e,t,n={replace:!1})=>{s(e,e=>{let o="function"==typeof t?t(e):t;return n.replace?{...e,data:o}:{...e,data:{...e.data,...o}}},n)},updateEdge:l,updateEdgeData:(e,t,n={replace:!1})=>{l(e,e=>{let o="function"==typeof t?t(e):t;return n.replace?{...e,data:o}:{...e,data:{...e.data,...o}}},n)},getNodesBounds:e=>{let{nodeLookup:t,nodeOrigin:o}=n.getState();return(0,a.getNodesBounds)(e,{nodeLookup:t,nodeOrigin:o})},getHandleConnections:({type:e,id:t,nodeId:o})=>Array.from(n.getState().connectionLookup.get(`${o}-${e}${t?`-${t}`:""}`)?.values()??[]),getNodeConnections:({type:e,handleId:t,nodeId:o})=>Array.from(n.getState().connectionLookup.get(`${o}${e?t?`-${e}-${t}`:`-${e}`:""}`)?.values()??[]),fitView:async e=>{let t=n.getState().fitViewResolver??(0,a.withResolvers)();return n.setState({fitViewQueued:!0,fitViewOptions:e,fitViewResolver:t}),o.nodeQueue.push(e=>[...e]),t.promise}}},[]);return(0,i.useMemo)(()=>({...s,...t,viewportInitialized:r}),[r])}let es=e=>e.selected,el="undefined"!=typeof window?window:void 0,ed={position:"absolute",width:"100%",height:"100%",top:0,left:0},ec=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function eu({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:s=.5,panOnScrollMode:l=a.PanOnScrollMode.Free,zoomOnDoubleClick:d=!0,panOnDrag:c=!0,defaultViewport:u,translateExtent:g,minZoom:h,maxZoom:p,zoomActivationKeyCode:m,preventScrolling:x=!0,children:y,noWheelClassName:C,noPanClassName:v,onViewportChange:S,isControlledViewport:j,paneClickDistance:_,selectionOnDrag:k}){let E,R=w(),N=(0,i.useRef)(null),{userSelectionActive:I,lib:M,connectionInProgress:T}=b(ec,f),D=U(m),L=(0,i.useRef)();E=w(),(0,i.useEffect)(()=>{let e=()=>{if(!N.current||!(N.current.checkVisibility?.()??!0))return!1;let e=(0,a.getDimensions)(N.current);(0===e.height||0===e.width)&&E.getState().onError?.("004",a.errorMessages.error004()),E.setState({width:e.width||500,height:e.height||500})};if(N.current){e(),window.addEventListener("resize",e);let t=new ResizeObserver(()=>e());return t.observe(N.current),()=>{window.removeEventListener("resize",e),t&&N.current&&t.unobserve(N.current)}}},[]);let P=(0,i.useCallback)(e=>{S?.({x:e[0],y:e[1],zoom:e[2]}),j||R.setState({transform:e})},[S,j]);return(0,i.useEffect)(()=>{if(N.current){L.current=(0,a.XYPanZoom)({domNode:N.current,minZoom:h,maxZoom:p,translateExtent:g,viewport:u,onDraggingChange:e=>R.setState({paneDragging:e}),onPanZoomStart:(e,t)=>{let{onViewportChangeStart:n,onMoveStart:o}=R.getState();o?.(e,t),n?.(t)},onPanZoom:(e,t)=>{let{onViewportChange:n,onMove:o}=R.getState();o?.(e,t),n?.(t)},onPanZoomEnd:(e,t)=>{let{onViewportChangeEnd:n,onMoveEnd:o}=R.getState();o?.(e,t),n?.(t)}});let{x:e,y:t,zoom:n}=L.current.getViewport();return R.setState({panZoom:L.current,transform:[e,t,n],domNode:N.current.closest(".react-flow")}),()=>{L.current?.destroy()}}},[]),(0,i.useEffect)(()=>{L.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:s,panOnScrollMode:l,zoomOnDoubleClick:d,panOnDrag:c,zoomActivationKeyPressed:D,preventScrolling:x,noPanClassName:v,userSelectionActive:I,noWheelClassName:C,lib:M,onTransformChange:P,connectionInProgress:T,selectionOnDrag:k,paneClickDistance:_})},[e,t,n,r,s,l,d,c,D,x,v,I,C,M,P,T,k,_]),(0,o.jsx)("div",{className:"react-flow__renderer",ref:N,style:ed,children:y})}let eg=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function eh(){let{userSelectionActive:e,userSelectionRect:t}=b(eg,f);return e&&t?(0,o.jsx)("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}let ep=(e,t)=>n=>{n.target===t.current&&e?.(n)},ef=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function em({isSelecting:e,selectionKeyPressed:t,selectionMode:n=a.SelectionMode.Full,panOnDrag:s,paneClickDistance:l,selectionOnDrag:d,onSelectionStart:c,onSelectionEnd:u,onPaneClick:g,onPaneContextMenu:h,onPaneScroll:p,onPaneMouseEnter:m,onPaneMouseMove:x,onPaneMouseLeave:y,children:C}){let v=w(),{userSelectionActive:S,elementsSelectable:j,dragging:_,connectionInProgress:k}=b(ef,f),E=j&&(e||S),R=(0,i.useRef)(null),N=(0,i.useRef)(),I=(0,i.useRef)(new Set),M=(0,i.useRef)(new Set),T=(0,i.useRef)(!1),D=e=>{if(T.current||k){T.current=!1;return}g?.(e),v.getState().resetSelectedElements(),v.setState({nodesSelectionActive:!1})},L=!0===s||Array.isArray(s)&&s.includes(0);return(0,o.jsxs)("div",{className:r(["react-flow__pane",{draggable:L,dragging:_,selection:e}]),onClick:E?void 0:ep(D,R),onContextMenu:ep(e=>{Array.isArray(s)&&s?.includes(2)?e.preventDefault():h?.(e)},R),onWheel:ep(p?e=>p(e):void 0,R),onPointerEnter:E?void 0:m,onPointerMove:E?e=>{let{userSelectionRect:o,transform:i,nodeLookup:r,edgeLookup:s,connectionLookup:d,triggerNodeChanges:u,triggerEdgeChanges:g,defaultEdgeOptions:h,resetSelectedElements:p}=v.getState();if(!N.current||!o)return;let{x:f,y:m}=(0,a.getEventPosition)(e.nativeEvent,N.current),{startX:x,startY:y}=o;if(!T.current){if(Math.hypot(f-x,m-y)<=(t?0:l))return;p(),c?.(e)}T.current=!0;let b={startX:x,startY:y,x:f<x?f:x,y:m<y?m:y,width:Math.abs(f-x),height:Math.abs(m-y)},w=I.current,C=M.current;I.current=new Set((0,a.getNodesInside)(r,b,i,n===a.SelectionMode.Partial,!0).map(e=>e.id)),M.current=new Set;let S=h?.selectable??!0;for(let e of I.current){let t=d.get(e);if(t)for(let{edgeId:e}of t.values()){let t=s.get(e);t&&(t.selectable??S)&&M.current.add(e)}}(0,a.areSetsEqual)(w,I.current)||u(Q(r,I.current,!0)),(0,a.areSetsEqual)(C,M.current)||g(Q(s,M.current)),v.setState({userSelectionRect:b,userSelectionActive:!0,nodesSelectionActive:!1})}:x,onPointerUp:E?e=>{0===e.button&&(e.target?.releasePointerCapture?.(e.pointerId),!S&&e.target===R.current&&v.getState().userSelectionRect&&D?.(e),v.setState({userSelectionActive:!1,userSelectionRect:null}),T.current&&(u?.(e),v.setState({nodesSelectionActive:I.current.size>0})))}:void 0,onPointerDownCapture:E?n=>{let{domNode:o}=v.getState();if(N.current=o?.getBoundingClientRect(),!N.current)return;let i=n.target===R.current;if(!i&&n.target.closest(".nokey")||!e||!(d&&i||t)||0!==n.button||!n.isPrimary)return;n.target?.setPointerCapture?.(n.pointerId),T.current=!1;let{x:r,y:s}=(0,a.getEventPosition)(n.nativeEvent,N.current);v.setState({userSelectionRect:{width:0,height:0,startX:r,startY:s,x:r,y:s}}),i||(n.stopPropagation(),n.preventDefault())}:void 0,onClickCapture:E?e=>{T.current&&(e.stopPropagation(),T.current=!1)}:void 0,onPointerLeave:y,ref:R,style:ed,children:[C,(0,o.jsx)(eh,{})]})}function ex({id:e,store:t,unselect:n=!1,nodeRef:o}){let{addSelectedNodes:i,unselectNodesAndEdges:r,multiSelectionActive:s,nodeLookup:l,onError:d}=t.getState(),c=l.get(e);c?(t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&s)&&(r({nodes:[c],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):i([e])):d?.("012",a.errorMessages.error012(e))}function ey({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:s,nodeClickDistance:l}){let d=w(),[c,u]=(0,i.useState)(!1),g=(0,i.useRef)();return(0,i.useEffect)(()=>{g.current=(0,a.XYDrag)({getStoreItems:()=>d.getState(),onNodeMouseDown:t=>{ex({id:t,store:d,nodeRef:e})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),(0,i.useEffect)(()=>{if(t)g.current?.destroy();else if(e.current)return g.current?.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:s,nodeId:r,nodeClickDistance:l}),()=>{g.current?.destroy()}},[n,o,t,s,e,r]),c}function eb(){let e=w();return(0,i.useCallback)(t=>{let{nodeExtent:n,snapToGrid:o,snapGrid:i,nodesDraggable:r,onError:s,updateNodePositions:l,nodeLookup:d,nodeOrigin:c}=e.getState(),u=new Map,g=e=>e.selected&&(e.draggable||r&&void 0===e.draggable),h=o?i[0]:5,p=o?i[1]:5,f=t.direction.x*h*t.factor,m=t.direction.y*p*t.factor;for(let[,e]of d){if(!g(e))continue;let t={x:e.internals.positionAbsolute.x+f,y:e.internals.positionAbsolute.y+m};o&&(t=(0,a.snapPosition)(t,i));let{position:r,positionAbsolute:l}=(0,a.calculateNodePosition)({nodeId:e.id,nextPosition:t,nodeLookup:d,nodeExtent:n,nodeOrigin:c,onError:s});e.position=r,e.internals.positionAbsolute=l,u.set(e.id,e)}l(u)},[])}let ew=(0,i.createContext)(null),eC=ew.Provider;ew.Consumer;let ev=()=>(0,i.useContext)(ew),eS=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),ej=(0,i.memo)(ee(function({type:e="source",position:t=a.Position.Top,isValidConnection:n,isConnectable:i=!0,isConnectableStart:s=!0,isConnectableEnd:l=!0,id:d,onConnect:c,children:u,className:g,onMouseDown:h,onTouchStart:p,...m},x){let y=d||null,C="target"===e,v=w(),S=ev(),{connectOnClick:j,noPanClassName:_,rfId:k}=b(eS,f),{connectingFrom:E,connectingTo:R,clickConnecting:N,isPossibleEndHandle:I,connectionInProcess:M,clickConnectionInProcess:T,valid:D}=b(t=>{let{connectionClickStartHandle:n,connectionMode:o,connection:i}=t,{fromHandle:r,toHandle:s,isValid:l}=i,d=s?.nodeId===S&&s?.id===y&&s?.type===e;return{connectingFrom:r?.nodeId===S&&r?.id===y&&r?.type===e,connectingTo:d,clickConnecting:n?.nodeId===S&&n?.id===y&&n?.type===e,isPossibleEndHandle:o===a.ConnectionMode.Strict?r?.type!==e:S!==r?.nodeId||y!==r?.id,connectionInProcess:!!r,clickConnectionInProcess:!!n,valid:d&&l}},f);S||v.getState().onError?.("010",a.errorMessages.error010());let L=e=>{let{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:o}=v.getState(),i={...t,...e};if(o){let{edges:e,setEdges:t}=v.getState();t((0,a.addEdge)(i,e))}n?.(i),c?.(i)},P=e=>{if(!S)return;let t=(0,a.isMouseEvent)(e.nativeEvent);if(s&&(t&&0===e.button||!t)){let t=v.getState();a.XYHandle.onPointerDown(e.nativeEvent,{handleDomNode:e.currentTarget,autoPanOnConnect:t.autoPanOnConnect,connectionMode:t.connectionMode,connectionRadius:t.connectionRadius,domNode:t.domNode,nodeLookup:t.nodeLookup,lib:t.lib,isTarget:C,handleId:y,nodeId:S,flowId:t.rfId,panBy:t.panBy,cancelConnection:t.cancelConnection,onConnectStart:t.onConnectStart,onConnectEnd:t.onConnectEnd,updateConnection:t.updateConnection,onConnect:L,isValidConnection:n||t.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:t.autoPanSpeed,dragThreshold:t.connectionDragThreshold})}t?h?.(e):p?.(e)};return(0,o.jsx)("div",{"data-handleid":y,"data-nodeid":S,"data-handlepos":t,"data-id":`${k}-${S}-${y}-${e}`,className:r(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",_,g,{source:!C,target:C,connectable:i,connectablestart:s,connectableend:l,clickconnecting:N,connectingfrom:E,connectingto:R,valid:D,connectionindicator:i&&(!M||I)&&(M||T?l:s)}]),onMouseDown:P,onTouchStart:P,onClick:j?t=>{let{onClickConnectStart:o,onClickConnectEnd:i,connectionClickStartHandle:r,connectionMode:l,isValidConnection:d,lib:c,rfId:u,nodeLookup:g,connection:h}=v.getState();if(!S||!r&&!s)return;if(!r){o?.(t.nativeEvent,{nodeId:S,handleId:y,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:S,type:e,id:y}});return}let p=(0,a.getHostForElement)(t.target),f=n||d,{connection:m,isValid:x}=a.XYHandle.isValid(t.nativeEvent,{handle:{nodeId:S,id:y,type:e},connectionMode:l,fromNodeId:r.nodeId,fromHandleId:r.id||null,fromType:r.type,isValidConnection:f,flowId:u,doc:p,lib:c,nodeLookup:g});x&&m&&L(m);let b=structuredClone(h);delete b.inProgress,b.toPosition=b.toHandle?b.toHandle.position:null,i?.(t,b),v.setState({connectionClickStartHandle:null})}:void 0,ref:x,...m,children:u})})),e_={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},ek={input:function({data:e,isConnectable:t,sourcePosition:n=a.Position.Bottom}){return(0,o.jsxs)(o.Fragment,{children:[e?.label,(0,o.jsx)(ej,{type:"source",position:n,isConnectable:t})]})},default:function({data:e,isConnectable:t,targetPosition:n=a.Position.Top,sourcePosition:i=a.Position.Bottom}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ej,{type:"target",position:n,isConnectable:t}),e?.label,(0,o.jsx)(ej,{type:"source",position:i,isConnectable:t})]})},output:function({data:e,isConnectable:t,targetPosition:n=a.Position.Top}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ej,{type:"target",position:n,isConnectable:t}),e?.label]})},group:function(){return null}},eE=e=>{let{width:t,height:n,x:o,y:i}=(0,a.getInternalNodesBounds)(e.nodeLookup,{filter:e=>!!e.selected});return{width:(0,a.isNumeric)(t)?t:null,height:(0,a.isNumeric)(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${i}px)`}};function eR({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){let a=w(),{width:s,height:l,transformString:d,userSelectionActive:c}=b(eE,f),u=eb(),g=(0,i.useRef)(null);if((0,i.useEffect)(()=>{n||g.current?.focus({preventScroll:!0})},[n]),ey({nodeRef:g}),c||!s||!l)return null;let h=e?t=>{e(t,a.getState().nodes.filter(e=>e.selected))}:void 0;return(0,o.jsx)("div",{className:r(["react-flow__nodesselection","react-flow__container",t]),style:{transform:d},children:(0,o.jsx)("div",{ref:g,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:e=>{Object.prototype.hasOwnProperty.call(e_,e.key)&&(e.preventDefault(),u({direction:e_[e.key],factor:e.shiftKey?4:1}))},style:{width:s,height:l}})})}let eN="undefined"!=typeof window?window:void 0,eI=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function eM({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:s,onPaneScroll:l,paneClickDistance:d,deleteKeyCode:c,selectionKeyCode:u,selectionOnDrag:g,selectionMode:h,onSelectionStart:p,onSelectionEnd:m,multiSelectionKeyCode:x,panActivationKeyCode:y,zoomActivationKeyCode:C,elementsSelectable:v,zoomOnScroll:S,zoomOnPinch:j,panOnScroll:_,panOnScrollSpeed:k,panOnScrollMode:E,zoomOnDoubleClick:R,panOnDrag:N,defaultViewport:I,translateExtent:M,minZoom:T,maxZoom:D,preventScrolling:L,onSelectionContextMenu:P,noWheelClassName:O,noPanClassName:A,disableKeyboardA11y:z,onViewportChange:B,isControlledViewport:F}){let{nodesSelectionActive:V,userSelectionActive:$}=b(eI,f),H=U(u,{target:eN}),G=U(y,{target:eN}),X=G||N,W=G||_,K=g&&!0!==X,Z=H||$||K;return!function({deleteKeyCode:e,multiSelectionKeyCode:t}){let n=w(),{deleteElements:o}=ea(),r=U(e,{actInsideInputWithModifier:!1}),a=U(t,{target:el});(0,i.useEffect)(()=>{if(r){let{edges:e,nodes:t}=n.getState();o({nodes:t.filter(es),edges:e.filter(es)}),n.setState({nodesSelectionActive:!1})}},[r]),(0,i.useEffect)(()=>{n.setState({multiSelectionActive:a})},[a])}({deleteKeyCode:c,multiSelectionKeyCode:x}),(0,o.jsx)(eu,{onPaneContextMenu:s,elementsSelectable:v,zoomOnScroll:S,zoomOnPinch:j,panOnScroll:W,panOnScrollSpeed:k,panOnScrollMode:E,zoomOnDoubleClick:R,panOnDrag:!H&&X,defaultViewport:I,translateExtent:M,minZoom:T,maxZoom:D,zoomActivationKeyCode:C,preventScrolling:L,noWheelClassName:O,noPanClassName:A,onViewportChange:B,isControlledViewport:F,paneClickDistance:d,selectionOnDrag:K,children:(0,o.jsxs)(em,{onSelectionStart:p,onSelectionEnd:m,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:s,onPaneScroll:l,panOnDrag:X,isSelecting:!!Z,selectionMode:h,selectionKeyPressed:H,paneClickDistance:d,selectionOnDrag:K,children:[e,V&&(0,o.jsx)(eR,{onSelectionContextMenu:P,noPanClassName:A,disableKeyboardA11y:z})]})})}eM.displayName="FlowRenderer";let eT=(0,i.memo)(eM),eD=e=>e.updateNodeInternals;var eL=(0,i.memo)(function({id:e,onClick:t,onMouseEnter:n,onMouseMove:s,onMouseLeave:l,onContextMenu:d,onDoubleClick:c,nodesDraggable:u,elementsSelectable:g,nodesConnectable:h,nodesFocusable:p,resizeObserver:m,noDragClassName:x,noPanClassName:y,disableKeyboardA11y:C,rfId:v,nodeTypes:j,nodeClickDistance:_,onError:k}){let{node:E,internals:R,isParent:N}=b(t=>{let n=t.nodeLookup.get(e),o=t.parentLookup.has(e);return{node:n,internals:n.internals,isParent:o}},f),I=E.type||"default",M=j?.[I]||ek[I];void 0===M&&(k?.("003",a.errorMessages.error003(I)),I="default",M=j?.default||ek.default);let T=!!(E.draggable||u&&void 0===E.draggable),D=!!(E.selectable||g&&void 0===E.selectable),L=!!(E.connectable||h&&void 0===E.connectable),P=!!(E.focusable||p&&void 0===E.focusable),O=w(),A=(0,a.nodeHasDimensions)(E),z=function({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){let r=w(),a=(0,i.useRef)(null),s=(0,i.useRef)(null),l=(0,i.useRef)(e.sourcePosition),d=(0,i.useRef)(e.targetPosition),c=(0,i.useRef)(t),u=n&&!!e.internals.handleBounds;return(0,i.useEffect)(()=>{!a.current||e.hidden||u&&s.current===a.current||(s.current&&o?.unobserve(s.current),o?.observe(a.current),s.current=a.current)},[u,e.hidden]),(0,i.useEffect)(()=>()=>{s.current&&(o?.unobserve(s.current),s.current=null)},[]),(0,i.useEffect)(()=>{if(a.current){let n=c.current!==t,o=l.current!==e.sourcePosition,i=d.current!==e.targetPosition;(n||o||i)&&(c.current=t,l.current=e.sourcePosition,d.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:a.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),a}({node:E,nodeType:I,hasDimensions:A,resizeObserver:m}),B=ey({nodeRef:z,disabled:E.hidden||!T,noDragClassName:x,handleSelector:E.dragHandle,nodeId:e,isSelectable:D,nodeClickDistance:_}),F=eb();if(E.hidden)return null;let V=(0,a.getNodeDimensions)(E),$=void 0===E.internals.handleBounds?{width:E.width??E.initialWidth??E.style?.width,height:E.height??E.initialHeight??E.style?.height}:{width:E.width??E.style?.width,height:E.height??E.style?.height},H=D||T||t||n||s||l,G=n?e=>n(e,{...R.userNode}):void 0,U=s?e=>s(e,{...R.userNode}):void 0,X=l?e=>l(e,{...R.userNode}):void 0,W=d?e=>d(e,{...R.userNode}):void 0,K=c?e=>c(e,{...R.userNode}):void 0;return(0,o.jsx)("div",{className:r(["react-flow__node",`react-flow__node-${I}`,{[y]:T},E.className,{selected:E.selected,selectable:D,parent:N,draggable:T,dragging:B}]),ref:z,style:{zIndex:R.z,transform:`translate(${R.positionAbsolute.x}px,${R.positionAbsolute.y}px)`,pointerEvents:H?"all":"none",visibility:A?"visible":"hidden",...E.style,...$},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:G,onMouseMove:U,onMouseLeave:X,onContextMenu:W,onClick:n=>{let{selectNodesOnDrag:o,nodeDragThreshold:i}=O.getState();D&&(!o||!T||i>0)&&ex({id:e,store:O,nodeRef:z}),t&&t(n,{...R.userNode})},onDoubleClick:K,onKeyDown:P?t=>{if(!(0,a.isInputDOMNode)(t.nativeEvent)&&!C){if(a.elementSelectionKeys.includes(t.key)&&D)ex({id:e,store:O,unselect:"Escape"===t.key,nodeRef:z});else if(T&&E.selected&&Object.prototype.hasOwnProperty.call(e_,t.key)){t.preventDefault();let{ariaLabelConfig:e}=O.getState();O.setState({ariaLiveMessage:e["node.a11yDescription.ariaLiveMessage"]({direction:t.key.replace("Arrow","").toLowerCase(),x:~~R.positionAbsolute.x,y:~~R.positionAbsolute.y})}),F({direction:e_[t.key],factor:t.shiftKey?4:1})}}}:void 0,tabIndex:P?0:void 0,onFocus:P?()=>{if(C||!z.current?.matches(":focus-visible"))return;let{transform:t,width:n,height:o,autoPanOnNodeFocus:i,setCenter:r}=O.getState();!i||(0,a.getNodesInside)(new Map([[e,E]]),{x:0,y:0,width:n,height:o},t,!0).length>0||r(E.position.x+V.width/2,E.position.y+V.height/2,{zoom:t[2]})}:void 0,role:E.ariaRole??(P?"group":void 0),"aria-roledescription":"node","aria-describedby":C?void 0:`${S}-${v}`,"aria-label":E.ariaLabel,...E.domAttributes,children:(0,o.jsx)(eC,{value:e,children:(0,o.jsx)(M,{id:e,data:E.data,type:I,positionAbsoluteX:R.positionAbsolute.x,positionAbsoluteY:R.positionAbsolute.y,selected:E.selected??!1,selectable:D,draggable:T,deletable:E.deletable??!0,isConnectable:L,sourcePosition:E.sourcePosition,targetPosition:E.targetPosition,dragging:B,dragHandle:E.dragHandle,zIndex:R.z,parentId:E.parentId,...V})})})});let eP=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function eO(e){var t;let{nodesDraggable:n,nodesConnectable:r,nodesFocusable:s,elementsSelectable:l,onError:d}=b(eP,f),c=(t=e.onlyRenderVisibleElements,b((0,i.useCallback)(e=>t?(0,a.getNodesInside)(e.nodeLookup,{x:0,y:0,width:e.width,height:e.height},e.transform,!0).map(e=>e.id):Array.from(e.nodeLookup.keys()),[t]),f)),u=function(){let e=b(eD),[t]=(0,i.useState)(()=>"undefined"==typeof ResizeObserver?null:new ResizeObserver(t=>{let n=new Map;t.forEach(e=>{let t=e.target.getAttribute("data-id");n.set(t,{id:t,nodeElement:e.target,force:!0})}),e(n)}));return(0,i.useEffect)(()=>()=>{t?.disconnect()},[t]),t}();return(0,o.jsx)("div",{className:"react-flow__nodes",style:ed,children:c.map(t=>(0,o.jsx)(eL,{id:t,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:u,nodesDraggable:n,nodesConnectable:r,nodesFocusable:s,elementsSelectable:l,nodeClickDistance:e.nodeClickDistance,onError:d},t))})}eO.displayName="NodeRenderer";let eA=(0,i.memo)(eO),ez={[a.MarkerType.Arrow]:({color:e="none",strokeWidth:t=1})=>{let n={strokeWidth:t,...e&&{stroke:e}};return(0,o.jsx)("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},[a.MarkerType.ArrowClosed]:({color:e="none",strokeWidth:t=1})=>{let n={strokeWidth:t,...e&&{stroke:e,fill:e}};return(0,o.jsx)("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})}},eB=({id:e,type:t,color:n,width:r=12.5,height:s=12.5,markerUnits:l="strokeWidth",strokeWidth:d,orient:c="auto-start-reverse"})=>{let u,g=(u=w(),(0,i.useMemo)(()=>Object.prototype.hasOwnProperty.call(ez,t)?ez[t]:(u.getState().onError?.("009",a.errorMessages.error009(t)),null),[t]));return g?(0,o.jsx)("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:l,orient:c,refX:"0",refY:"0",children:(0,o.jsx)(g,{color:n,strokeWidth:d})}):null},eF=({defaultColor:e,rfId:t})=>{let n=b(e=>e.edges),r=b(e=>e.defaultEdgeOptions),s=(0,i.useMemo)(()=>(0,a.createMarkerIds)(n,{id:t,defaultColor:e,defaultMarkerStart:r?.markerStart,defaultMarkerEnd:r?.markerEnd}),[n,r,t,e]);return s.length?(0,o.jsx)("svg",{className:"react-flow__marker","aria-hidden":"true",children:(0,o.jsx)("defs",{children:s.map(e=>(0,o.jsx)(eB,{id:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient},e.id))})}):null};eF.displayName="MarkerDefinitions";var eV=(0,i.memo)(eF);function e$({x:e,y:t,label:n,labelStyle:a,labelShowBg:s=!0,labelBgStyle:l,labelBgPadding:d=[2,4],labelBgBorderRadius:c=2,children:u,className:g,...h}){let[p,f]=(0,i.useState)({x:1,y:0,width:0,height:0}),m=r(["react-flow__edge-textwrapper",g]),x=(0,i.useRef)(null);return((0,i.useEffect)(()=>{if(x.current){let e=x.current.getBBox();f({x:e.x,y:e.y,width:e.width,height:e.height})}},[n]),n)?(0,o.jsxs)("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:m,visibility:p.width?"visible":"hidden",...h,children:[s&&(0,o.jsx)("rect",{width:p.width+2*d[0],x:-d[0],y:-d[1],height:p.height+2*d[1],className:"react-flow__edge-textbg",style:l,rx:c,ry:c}),(0,o.jsx)("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:x,style:a,children:n}),u]}):null}e$.displayName="EdgeText";let eH=(0,i.memo)(e$);function eG({path:e,labelX:t,labelY:n,label:i,labelStyle:s,labelShowBg:l,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:u,interactionWidth:g=20,...h}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{...h,d:e,fill:"none",className:r(["react-flow__edge-path",h.className])}),g?(0,o.jsx)("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}):null,i&&(0,a.isNumeric)(t)&&(0,a.isNumeric)(n)?(0,o.jsx)(eH,{x:t,y:n,label:i,labelStyle:s,labelShowBg:l,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:u}):null]})}function eU({pos:e,x1:t,y1:n,x2:o,y2:i}){return e===a.Position.Left||e===a.Position.Right?[.5*(t+o),n]:[t,.5*(n+i)]}function eX({sourceX:e,sourceY:t,sourcePosition:n=a.Position.Bottom,targetX:o,targetY:i,targetPosition:r=a.Position.Top}){let[s,l]=eU({pos:n,x1:e,y1:t,x2:o,y2:i}),[d,c]=eU({pos:r,x1:o,y1:i,x2:e,y2:t}),[u,g,h,p]=(0,a.getBezierEdgeCenter)({sourceX:e,sourceY:t,targetX:o,targetY:i,sourceControlX:s,sourceControlY:l,targetControlX:d,targetControlY:c});return[`M${e},${t} C${s},${l} ${d},${c} ${o},${i}`,u,g,h,p]}function eW(e){return(0,i.memo)(({id:t,sourceX:n,sourceY:i,targetX:r,targetY:a,sourcePosition:s,targetPosition:l,label:d,labelStyle:c,labelShowBg:u,labelBgStyle:g,labelBgPadding:h,labelBgBorderRadius:p,style:f,markerEnd:m,markerStart:x,interactionWidth:y})=>{let[b,w,C]=eX({sourceX:n,sourceY:i,sourcePosition:s,targetX:r,targetY:a,targetPosition:l}),v=e.isInternal?void 0:t;return(0,o.jsx)(eG,{id:v,path:b,labelX:w,labelY:C,label:d,labelStyle:c,labelShowBg:u,labelBgStyle:g,labelBgPadding:h,labelBgBorderRadius:p,style:f,markerEnd:m,markerStart:x,interactionWidth:y})})}let eK=eW({isInternal:!1}),eZ=eW({isInternal:!0});function eQ(e){return(0,i.memo)(({id:t,sourceX:n,sourceY:i,targetX:r,targetY:s,label:l,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:g,labelBgBorderRadius:h,style:p,sourcePosition:f=a.Position.Bottom,targetPosition:m=a.Position.Top,markerEnd:x,markerStart:y,pathOptions:b,interactionWidth:w})=>{let[C,v,S]=(0,a.getSmoothStepPath)({sourceX:n,sourceY:i,sourcePosition:f,targetX:r,targetY:s,targetPosition:m,borderRadius:b?.borderRadius,offset:b?.offset,stepPosition:b?.stepPosition}),j=e.isInternal?void 0:t;return(0,o.jsx)(eG,{id:j,path:C,labelX:v,labelY:S,label:l,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:g,labelBgBorderRadius:h,style:p,markerEnd:x,markerStart:y,interactionWidth:w})})}eK.displayName="SimpleBezierEdge",eZ.displayName="SimpleBezierEdgeInternal";let eq=eQ({isInternal:!1}),eY=eQ({isInternal:!0});function eJ(e){return(0,i.memo)(({id:t,...n})=>{let r=e.isInternal?void 0:t;return(0,o.jsx)(eq,{...n,id:r,pathOptions:(0,i.useMemo)(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}eq.displayName="SmoothStepEdge",eY.displayName="SmoothStepEdgeInternal";let e0=eJ({isInternal:!1}),e1=eJ({isInternal:!0});function e2(e){return(0,i.memo)(({id:t,sourceX:n,sourceY:i,targetX:r,targetY:s,label:l,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:g,labelBgBorderRadius:h,style:p,markerEnd:f,markerStart:m,interactionWidth:x})=>{let[y,b,w]=(0,a.getStraightPath)({sourceX:n,sourceY:i,targetX:r,targetY:s}),C=e.isInternal?void 0:t;return(0,o.jsx)(eG,{id:C,path:y,labelX:b,labelY:w,label:l,labelStyle:d,labelShowBg:c,labelBgStyle:u,labelBgPadding:g,labelBgBorderRadius:h,style:p,markerEnd:f,markerStart:m,interactionWidth:x})})}e0.displayName="StepEdge",e1.displayName="StepEdgeInternal";let e3=e2({isInternal:!1}),e5=e2({isInternal:!0});function e4(e){return(0,i.memo)(({id:t,sourceX:n,sourceY:i,targetX:r,targetY:s,sourcePosition:l=a.Position.Bottom,targetPosition:d=a.Position.Top,label:c,labelStyle:u,labelShowBg:g,labelBgStyle:h,labelBgPadding:p,labelBgBorderRadius:f,style:m,markerEnd:x,markerStart:y,pathOptions:b,interactionWidth:w})=>{let[C,v,S]=(0,a.getBezierPath)({sourceX:n,sourceY:i,sourcePosition:l,targetX:r,targetY:s,targetPosition:d,curvature:b?.curvature}),j=e.isInternal?void 0:t;return(0,o.jsx)(eG,{id:j,path:C,labelX:v,labelY:S,label:c,labelStyle:u,labelShowBg:g,labelBgStyle:h,labelBgPadding:p,labelBgBorderRadius:f,style:m,markerEnd:x,markerStart:y,interactionWidth:w})})}e3.displayName="StraightEdge",e5.displayName="StraightEdgeInternal";let e6=e4({isInternal:!1}),e8=e4({isInternal:!0});e6.displayName="BezierEdge",e8.displayName="BezierEdgeInternal";let e7={default:e8,straight:e5,step:e1,smoothstep:eY,simplebezier:eZ},e9={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},te="react-flow__edgeupdater";function tt({position:e,centerX:t,centerY:n,radius:i=10,onMouseDown:s,onMouseEnter:l,onMouseOut:d,type:c}){return(0,o.jsx)("circle",{onMouseDown:s,onMouseEnter:l,onMouseOut:d,className:r([te,`${te}-${c}`]),cx:e===a.Position.Left?t-i:e===a.Position.Right?t+i:t,cy:e===a.Position.Top?n-i:e===a.Position.Bottom?n+i:n,r:i,stroke:"transparent",fill:"transparent"})}function tn({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:i,sourceY:r,targetX:s,targetY:l,sourcePosition:d,targetPosition:c,onReconnect:u,onReconnectStart:g,onReconnectEnd:h,setReconnecting:p,setUpdateHover:f}){let m=w(),x=(e,t)=>{if(0!==e.button)return;let{autoPanOnConnect:o,domNode:i,isValidConnection:r,connectionMode:s,connectionRadius:l,lib:d,onConnectStart:c,onConnectEnd:f,cancelConnection:x,nodeLookup:y,rfId:b,panBy:w,updateConnection:C}=m.getState(),v="target"===t.type;a.XYHandle.onPointerDown(e.nativeEvent,{autoPanOnConnect:o,connectionMode:s,connectionRadius:l,domNode:i,handleId:t.id,nodeId:t.nodeId,nodeLookup:y,isTarget:v,edgeUpdaterType:t.type,lib:d,flowId:b,cancelConnection:x,panBy:w,isValidConnection:r,onConnect:e=>u?.(n,e),onConnectStart:(o,i)=>{p(!0),g?.(e,n,t.type),c?.(o,i)},onConnectEnd:f,onReconnectEnd:(e,o)=>{p(!1),h?.(e,n,t.type,o)},updateConnection:C,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle,dragThreshold:m.getState().connectionDragThreshold,handleDomNode:e.currentTarget})},y=()=>f(!0),b=()=>f(!1);return(0,o.jsxs)(o.Fragment,{children:[(!0===e||"source"===e)&&(0,o.jsx)(tt,{position:d,centerX:i,centerY:r,radius:t,onMouseDown:e=>x(e,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),onMouseEnter:y,onMouseOut:b,type:"source"}),(!0===e||"target"===e)&&(0,o.jsx)(tt,{position:c,centerX:s,centerY:l,radius:t,onMouseDown:e=>x(e,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),onMouseEnter:y,onMouseOut:b,type:"target"})]})}var to=(0,i.memo)(function({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:s,onClick:l,onDoubleClick:d,onContextMenu:c,onMouseEnter:u,onMouseMove:g,onMouseLeave:h,reconnectRadius:p,onReconnect:m,onReconnectStart:x,onReconnectEnd:y,rfId:C,edgeTypes:v,noPanClassName:S,onError:_,disableKeyboardA11y:k}){let E=b(t=>t.edgeLookup.get(e)),R=b(e=>e.defaultEdgeOptions),N=(E=R?{...R,...E}:E).type||"default",I=v?.[N]||e7[N];void 0===I&&(_?.("011",a.errorMessages.error011(N)),N="default",I=v?.default||e7.default);let M=!!(E.focusable||t&&void 0===E.focusable),T=void 0!==m&&(E.reconnectable||n&&void 0===E.reconnectable),D=!!(E.selectable||s&&void 0===E.selectable),L=(0,i.useRef)(null),[P,O]=(0,i.useState)(!1),[A,z]=(0,i.useState)(!1),B=w(),{zIndex:F,sourceX:V,sourceY:$,targetX:H,targetY:G,sourcePosition:U,targetPosition:X}=b((0,i.useCallback)(t=>{let n=t.nodeLookup.get(E.source),o=t.nodeLookup.get(E.target);if(!n||!o)return{zIndex:E.zIndex,...e9};let i=(0,a.getEdgePosition)({id:e,sourceNode:n,targetNode:o,sourceHandle:E.sourceHandle||null,targetHandle:E.targetHandle||null,connectionMode:t.connectionMode,onError:_});return{zIndex:(0,a.getElevatedEdgeZIndex)({selected:E.selected,zIndex:E.zIndex,sourceNode:n,targetNode:o,elevateOnSelect:t.elevateEdgesOnSelect,zIndexMode:t.zIndexMode}),...i||e9}},[E.source,E.target,E.sourceHandle,E.targetHandle,E.selected,E.zIndex]),f),W=(0,i.useMemo)(()=>E.markerStart?`url('#${(0,a.getMarkerId)(E.markerStart,C)}')`:void 0,[E.markerStart,C]),K=(0,i.useMemo)(()=>E.markerEnd?`url('#${(0,a.getMarkerId)(E.markerEnd,C)}')`:void 0,[E.markerEnd,C]);if(E.hidden||null===V||null===$||null===H||null===G)return null;let Z=d?e=>{d(e,{...E})}:void 0,Q=c?e=>{c(e,{...E})}:void 0,q=u?e=>{u(e,{...E})}:void 0,Y=g?e=>{g(e,{...E})}:void 0,J=h?e=>{h(e,{...E})}:void 0;return(0,o.jsx)("svg",{style:{zIndex:F},children:(0,o.jsxs)("g",{className:r(["react-flow__edge",`react-flow__edge-${N}`,E.className,S,{selected:E.selected,animated:E.animated,inactive:!D&&!l,updating:P,selectable:D}]),onClick:t=>{let{addSelectedEdges:n,unselectNodesAndEdges:o,multiSelectionActive:i}=B.getState();D&&(B.setState({nodesSelectionActive:!1}),E.selected&&i?(o({nodes:[],edges:[E]}),L.current?.blur()):n([e])),l&&l(t,E)},onDoubleClick:Z,onContextMenu:Q,onMouseEnter:q,onMouseMove:Y,onMouseLeave:J,onKeyDown:M?t=>{if(!k&&a.elementSelectionKeys.includes(t.key)&&D){let{unselectNodesAndEdges:n,addSelectedEdges:o}=B.getState();"Escape"===t.key?(L.current?.blur(),n({edges:[E]})):o([e])}}:void 0,tabIndex:M?0:void 0,role:E.ariaRole??(M?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":null===E.ariaLabel?void 0:E.ariaLabel||`Edge from ${E.source} to ${E.target}`,"aria-describedby":M?`${j}-${C}`:void 0,ref:L,...E.domAttributes,children:[!A&&(0,o.jsx)(I,{id:e,source:E.source,target:E.target,type:E.type,selected:E.selected,animated:E.animated,selectable:D,deletable:E.deletable??!0,label:E.label,labelStyle:E.labelStyle,labelShowBg:E.labelShowBg,labelBgStyle:E.labelBgStyle,labelBgPadding:E.labelBgPadding,labelBgBorderRadius:E.labelBgBorderRadius,sourceX:V,sourceY:$,targetX:H,targetY:G,sourcePosition:U,targetPosition:X,data:E.data,style:E.style,sourceHandleId:E.sourceHandle,targetHandleId:E.targetHandle,markerStart:W,markerEnd:K,pathOptions:"pathOptions"in E?E.pathOptions:void 0,interactionWidth:E.interactionWidth}),T&&(0,o.jsx)(tn,{edge:E,isReconnectable:T,reconnectRadius:p,onReconnect:m,onReconnectStart:x,onReconnectEnd:y,sourceX:V,sourceY:$,targetX:H,targetY:G,sourcePosition:U,targetPosition:X,setUpdateHover:O,setReconnecting:z})]})})});let ti=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function tr({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:s,onReconnect:l,onEdgeContextMenu:d,onEdgeMouseEnter:c,onEdgeMouseMove:u,onEdgeMouseLeave:g,onEdgeClick:h,reconnectRadius:p,onEdgeDoubleClick:m,onReconnectStart:x,onReconnectEnd:y,disableKeyboardA11y:w}){let{edgesFocusable:C,edgesReconnectable:v,elementsSelectable:S,onError:j}=b(ti,f),_=b((0,i.useCallback)(e=>{if(!t)return e.edges.map(e=>e.id);let n=[];if(e.width&&e.height)for(let t of e.edges){let o=e.nodeLookup.get(t.source),i=e.nodeLookup.get(t.target);o&&i&&(0,a.isEdgeVisible)({sourceNode:o,targetNode:i,width:e.width,height:e.height,transform:e.transform})&&n.push(t.id)}return n},[t]),f);return(0,o.jsxs)("div",{className:"react-flow__edges",children:[(0,o.jsx)(eV,{defaultColor:e,rfId:n}),_.map(e=>(0,o.jsx)(to,{id:e,edgesFocusable:C,edgesReconnectable:v,elementsSelectable:S,noPanClassName:s,onReconnect:l,onContextMenu:d,onMouseEnter:c,onMouseMove:u,onMouseLeave:g,onClick:h,reconnectRadius:p,onDoubleClick:m,onReconnectStart:x,onReconnectEnd:y,rfId:n,onError:j,edgeTypes:r,disableKeyboardA11y:w},e))]})}tr.displayName="EdgeRenderer";let ta=(0,i.memo)(tr),ts=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function tl({children:e}){let t=b(ts);return(0,o.jsx)("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}let td=e=>e.panZoom?.syncViewport;function tc(e){return e.connection.inProgress?{...e.connection,to:(0,a.pointToRendererPoint)(e.connection.to,e.transform)}:{...e.connection}}let tu=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function tg({containerStyle:e,style:t,type:n,component:i}){let{nodesConnectable:s,width:l,height:d,isValid:c,inProgress:u}=b(tu,f);return l&&s&&u?(0,o.jsx)("svg",{style:e,width:l,height:d,className:"react-flow__connectionline react-flow__container",children:(0,o.jsx)("g",{className:r(["react-flow__connection",(0,a.getConnectionStatus)(c)]),children:(0,o.jsx)(th,{style:t,type:n,CustomComponent:i,isValid:c})})}):null}let th=({style:e,type:t=a.ConnectionLineType.Bezier,CustomComponent:n,isValid:i})=>{let{inProgress:r,from:s,fromNode:l,fromHandle:d,fromPosition:c,to:u,toNode:g,toHandle:h,toPosition:p,pointer:m}=b(tc,f);if(!r)return;if(n)return(0,o.jsx)(n,{connectionLineType:t,connectionLineStyle:e,fromNode:l,fromHandle:d,fromX:s.x,fromY:s.y,toX:u.x,toY:u.y,fromPosition:c,toPosition:p,connectionStatus:(0,a.getConnectionStatus)(i),toNode:g,toHandle:h,pointer:m});let x="",y={sourceX:s.x,sourceY:s.y,sourcePosition:c,targetX:u.x,targetY:u.y,targetPosition:p};switch(t){case a.ConnectionLineType.Bezier:[x]=(0,a.getBezierPath)(y);break;case a.ConnectionLineType.SimpleBezier:[x]=eX(y);break;case a.ConnectionLineType.Step:[x]=(0,a.getSmoothStepPath)({...y,borderRadius:0});break;case a.ConnectionLineType.SmoothStep:[x]=(0,a.getSmoothStepPath)(y);break;default:[x]=(0,a.getStraightPath)(y)}return(0,o.jsx)("path",{d:x,fill:"none",className:"react-flow__connection-path",style:e})};th.displayName="ConnectionLine";let tp={};function tf(e=tp){(0,i.useRef)(e),w(),(0,i.useEffect)(()=>{},[e])}function tm({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:a,onNodeDoubleClick:s,onEdgeDoubleClick:l,onNodeMouseEnter:d,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:g,onSelectionContextMenu:h,onSelectionStart:p,onSelectionEnd:f,connectionLineType:m,connectionLineStyle:x,connectionLineComponent:y,connectionLineContainerStyle:C,selectionKeyCode:v,selectionOnDrag:S,selectionMode:j,multiSelectionKeyCode:_,panActivationKeyCode:k,zoomActivationKeyCode:E,deleteKeyCode:R,onlyRenderVisibleElements:N,elementsSelectable:I,defaultViewport:M,translateExtent:T,minZoom:D,maxZoom:L,preventScrolling:P,defaultMarkerColor:O,zoomOnScroll:A,zoomOnPinch:z,panOnScroll:B,panOnScrollSpeed:F,panOnScrollMode:V,zoomOnDoubleClick:$,panOnDrag:H,onPaneClick:G,onPaneMouseEnter:U,onPaneMouseMove:X,onPaneMouseLeave:W,onPaneScroll:K,onPaneContextMenu:Z,paneClickDistance:Q,nodeClickDistance:q,onEdgeContextMenu:Y,onEdgeMouseEnter:J,onEdgeMouseMove:ee,onEdgeMouseLeave:et,reconnectRadius:en,onReconnect:eo,onReconnectStart:ei,onReconnectEnd:er,noDragClassName:es,noWheelClassName:el,noPanClassName:ed,disableKeyboardA11y:ec,nodeExtent:eu,rfId:eg,viewport:eh,onViewportChange:ep}){let ef,em,ex,ey;return tf(e),tf(t),w(),(0,i.useRef)(!1),(0,i.useEffect)(()=>{},[]),ef=ea(),em=(0,i.useRef)(!1),(0,i.useEffect)(()=>{!em.current&&ef.viewportInitialized&&n&&(setTimeout(()=>n(ef),1),em.current=!0)},[n,ef.viewportInitialized]),ex=b(td),ey=w(),(0,i.useEffect)(()=>{eh&&(ex?.(eh),ey.setState({transform:[eh.x,eh.y,eh.zoom]}))},[eh,ex]),(0,o.jsx)(eT,{onPaneClick:G,onPaneMouseEnter:U,onPaneMouseMove:X,onPaneMouseLeave:W,onPaneContextMenu:Z,onPaneScroll:K,paneClickDistance:Q,deleteKeyCode:R,selectionKeyCode:v,selectionOnDrag:S,selectionMode:j,onSelectionStart:p,onSelectionEnd:f,multiSelectionKeyCode:_,panActivationKeyCode:k,zoomActivationKeyCode:E,elementsSelectable:I,zoomOnScroll:A,zoomOnPinch:z,zoomOnDoubleClick:$,panOnScroll:B,panOnScrollSpeed:F,panOnScrollMode:V,panOnDrag:H,defaultViewport:M,translateExtent:T,minZoom:D,maxZoom:L,onSelectionContextMenu:h,preventScrolling:P,noDragClassName:es,noWheelClassName:el,noPanClassName:ed,disableKeyboardA11y:ec,onViewportChange:ep,isControlledViewport:!!eh,children:(0,o.jsxs)(tl,{children:[(0,o.jsx)(ta,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:l,onReconnect:eo,onReconnectStart:ei,onReconnectEnd:er,onlyRenderVisibleElements:N,onEdgeContextMenu:Y,onEdgeMouseEnter:J,onEdgeMouseMove:ee,onEdgeMouseLeave:et,reconnectRadius:en,defaultMarkerColor:O,noPanClassName:ed,disableKeyboardA11y:ec,rfId:eg}),(0,o.jsx)(tg,{style:x,type:m,component:y,containerStyle:C}),(0,o.jsx)("div",{className:"react-flow__edgelabel-renderer"}),(0,o.jsx)(eA,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:s,onNodeMouseEnter:d,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:g,nodeClickDistance:q,onlyRenderVisibleElements:N,noPanClassName:ed,noDragClassName:es,disableKeyboardA11y:ec,nodeExtent:eu,rfId:eg}),(0,o.jsx)("div",{className:"react-flow__viewport-portal"})]})})}tm.displayName="GraphView";let tx=(0,i.memo)(tm),ty=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:i,height:r,fitView:s,fitViewOptions:l,minZoom:d=.5,maxZoom:c=2,nodeOrigin:u,nodeExtent:g,zIndexMode:h="basic"}={})=>{let p=new Map,f=new Map,m=new Map,x=new Map,y=o??t??[],b=n??e??[],w=u??[0,0],C=g??a.infiniteExtent;(0,a.updateConnectionLookup)(m,x,y);let v=(0,a.adoptUserNodes)(b,p,f,{nodeOrigin:w,nodeExtent:C,zIndexMode:h}),S=[0,0,1];if(s&&i&&r){let e=(0,a.getInternalNodesBounds)(p,{filter:e=>!!((e.width||e.initialWidth)&&(e.height||e.initialHeight))}),{x:t,y:n,zoom:o}=(0,a.getViewportForBounds)(e,i,r,d,c,l?.padding??.1);S=[t,n,o]}return{rfId:"1",width:i??0,height:r??0,transform:S,nodes:b,nodesInitialized:v,nodeLookup:p,parentLookup:f,edges:y,edgeLookup:x,connectionLookup:m,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:void 0!==n,hasDefaultEdges:void 0!==o,panZoom:null,minZoom:d,maxZoom:c,translateExtent:a.infiniteExtent,nodeExtent:C,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:a.ConnectionMode.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:w,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:s??!1,fitViewOptions:l,fitViewResolver:null,connection:{...a.initialConnection},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:a.devWarn,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:a.defaultAriaLabelConfig,zIndexMode:h,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}};function tb({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:s,initialHeight:l,initialMinZoom:d,initialMaxZoom:c,initialFitViewOptions:u,fitView:g,nodeOrigin:h,nodeExtent:f,zIndexMode:m,children:y}){let[b]=(0,i.useState)(()=>(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:i,height:r,fitView:s,fitViewOptions:l,minZoom:d,maxZoom:c,nodeOrigin:u,nodeExtent:g,zIndexMode:h})=>{let f,m;return f=(p,f)=>{async function m(){let{nodeLookup:e,panZoom:t,fitViewOptions:n,fitViewResolver:o,width:i,height:r,minZoom:s,maxZoom:l}=f();t&&(await (0,a.fitViewport)({nodes:e,width:i,height:r,panZoom:t,minZoom:s,maxZoom:l},n),o?.resolve(!0),p({fitViewResolver:null}))}return{...ty({nodes:e,edges:t,width:i,height:r,fitView:s,fitViewOptions:l,minZoom:d,maxZoom:c,nodeOrigin:u,nodeExtent:g,defaultNodes:n,defaultEdges:o,zIndexMode:h}),setNodes:e=>{let{nodeLookup:t,parentLookup:n,nodeOrigin:o,elevateNodesOnSelect:i,fitViewQueued:r,zIndexMode:s}=f(),l=(0,a.adoptUserNodes)(e,t,n,{nodeOrigin:o,nodeExtent:g,elevateNodesOnSelect:i,checkEquality:!0,zIndexMode:s});r&&l?(m(),p({nodes:e,nodesInitialized:l,fitViewQueued:!1,fitViewOptions:void 0})):p({nodes:e,nodesInitialized:l})},setEdges:e=>{let{connectionLookup:t,edgeLookup:n}=f();(0,a.updateConnectionLookup)(t,n,e),p({edges:e})},setDefaultNodesAndEdges:(e,t)=>{if(e){let{setNodes:t}=f();t(e),p({hasDefaultNodes:!0})}if(t){let{setEdges:e}=f();e(t),p({hasDefaultEdges:!0})}},updateNodeInternals:e=>{let{triggerNodeChanges:t,nodeLookup:n,parentLookup:o,domNode:i,nodeOrigin:r,nodeExtent:s,debug:l,fitViewQueued:d,zIndexMode:c}=f(),{changes:u,updatedInternals:g}=(0,a.updateNodeInternals)(e,n,o,i,r,s,c);g&&((0,a.updateAbsolutePositions)(n,o,{nodeOrigin:r,nodeExtent:s,zIndexMode:c}),d?(m(),p({fitViewQueued:!1,fitViewOptions:void 0})):p({}),u?.length>0&&(l&&console.log("React Flow: trigger node changes",u),t?.(u)))},updateNodePositions:(e,t=!1)=>{let n=[],o=[],{nodeLookup:i,triggerNodeChanges:r,connection:s,updateConnection:l,onNodesChangeMiddlewareMap:d}=f();for(let[r,d]of e){let e=i.get(r),c=!!(e?.expandParent&&e?.parentId&&d?.position),u={id:r,type:"position",position:c?{x:Math.max(0,d.position.x),y:Math.max(0,d.position.y)}:d.position,dragging:t};if(e&&s.inProgress&&s.fromNode.id===e.id){let t=(0,a.getHandlePosition)(e,s.fromHandle,a.Position.Left,!0);l({...s,from:t})}c&&e.parentId&&n.push({id:r,parentId:e.parentId,rect:{...d.internals.positionAbsolute,width:d.measured.width??0,height:d.measured.height??0}}),o.push(u)}if(n.length>0){let{parentLookup:e,nodeOrigin:t}=f(),r=(0,a.handleExpandParent)(n,i,e,t);o.push(...r)}for(let e of d.values())o=e(o);r(o)},triggerNodeChanges:e=>{let{onNodesChange:t,setNodes:n,nodes:o,hasDefaultNodes:i,debug:r}=f();e?.length&&(i&&n(K(e,o)),r&&console.log("React Flow: trigger node changes",e),t?.(e))},triggerEdgeChanges:e=>{let{onEdgesChange:t,setEdges:n,edges:o,hasDefaultEdges:i,debug:r}=f();e?.length&&(i&&n(K(e,o)),r&&console.log("React Flow: trigger edge changes",e),t?.(e))},addSelectedNodes:e=>{let{multiSelectionActive:t,edgeLookup:n,nodeLookup:o,triggerNodeChanges:i,triggerEdgeChanges:r}=f();t?i(e.map(e=>Z(e,!0))):(i(Q(o,new Set([...e]),!0)),r(Q(n)))},addSelectedEdges:e=>{let{multiSelectionActive:t,edgeLookup:n,nodeLookup:o,triggerNodeChanges:i,triggerEdgeChanges:r}=f();t?r(e.map(e=>Z(e,!0))):(r(Q(n,new Set([...e]))),i(Q(o,new Set,!0)))},unselectNodesAndEdges:({nodes:e,edges:t}={})=>{let{edges:n,nodes:o,nodeLookup:i,triggerNodeChanges:r,triggerEdgeChanges:a}=f(),s=(e||o).map(e=>{let t=i.get(e.id);return t&&(t.selected=!1),Z(e.id,!1)}),l=(t||n).map(e=>Z(e.id,!1));r(s),a(l)},setMinZoom:e=>{let{panZoom:t,maxZoom:n}=f();t?.setScaleExtent([e,n]),p({minZoom:e})},setMaxZoom:e=>{let{panZoom:t,minZoom:n}=f();t?.setScaleExtent([n,e]),p({maxZoom:e})},setTranslateExtent:e=>{f().panZoom?.setTranslateExtent(e),p({translateExtent:e})},resetSelectedElements:()=>{let{edges:e,nodes:t,triggerNodeChanges:n,triggerEdgeChanges:o,elementsSelectable:i}=f();if(!i)return;let r=t.reduce((e,t)=>t.selected?[...e,Z(t.id,!1)]:e,[]),a=e.reduce((e,t)=>t.selected?[...e,Z(t.id,!1)]:e,[]);n(r),o(a)},setNodeExtent:e=>{let{nodes:t,nodeLookup:n,parentLookup:o,nodeOrigin:i,elevateNodesOnSelect:r,nodeExtent:s,zIndexMode:l}=f();(e[0][0]!==s[0][0]||e[0][1]!==s[0][1]||e[1][0]!==s[1][0]||e[1][1]!==s[1][1])&&((0,a.adoptUserNodes)(t,n,o,{nodeOrigin:i,nodeExtent:e,elevateNodesOnSelect:r,checkEquality:!1,zIndexMode:l}),p({nodeExtent:e}))},panBy:e=>{let{transform:t,width:n,height:o,panZoom:i,translateExtent:r}=f();return(0,a.panBy)({delta:e,panZoom:i,transform:t,translateExtent:r,width:n,height:o})},setCenter:async(e,t,n)=>{let{width:o,height:i,maxZoom:r,panZoom:a}=f();if(!a)return Promise.resolve(!1);let s=void 0!==n?.zoom?n.zoom:r;return await a.setViewport({x:o/2-e*s,y:i/2-t*s,zoom:s},{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{p({connection:{...a.initialConnection}})},updateConnection:e=>{p({connection:e})},reset:()=>p({...ty()})}},m=Object.is,f?p(f,m):p})({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:s,height:l,fitView:g,minZoom:d,maxZoom:c,fitViewOptions:u,nodeOrigin:h,nodeExtent:f,zIndexMode:m}));return(0,o.jsx)(x,{value:b,children:(0,o.jsx)(ei,{children:y})})}function tw({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:a,width:s,height:l,fitView:d,fitViewOptions:c,minZoom:u,maxZoom:g,nodeOrigin:h,nodeExtent:p,zIndexMode:f}){return(0,i.useContext)(m)?(0,o.jsx)(o.Fragment,{children:e}):(0,o.jsx)(tb,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:a,initialWidth:s,initialHeight:l,fitView:d,initialFitViewOptions:c,initialMinZoom:u,initialMaxZoom:g,nodeOrigin:h,nodeExtent:p,zIndexMode:f,children:e})}let tC={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};var tv=ee(function({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,className:l,nodeTypes:d,edgeTypes:c,onNodeClick:u,onEdgeClick:g,onInit:h,onMove:p,onMoveStart:f,onMoveEnd:m,onConnect:x,onConnectStart:y,onConnectEnd:b,onClickConnectStart:w,onClickConnectEnd:C,onNodeMouseEnter:v,onNodeMouseMove:S,onNodeMouseLeave:j,onNodeContextMenu:_,onNodeDoubleClick:k,onNodeDragStart:E,onNodeDrag:N,onNodeDragStop:M,onNodesDelete:T,onEdgesDelete:D,onDelete:L,onSelectionChange:P,onSelectionDragStart:B,onSelectionDrag:F,onSelectionDragStop:V,onSelectionContextMenu:G,onSelectionStart:U,onSelectionEnd:X,onBeforeDelete:W,connectionMode:K,connectionLineType:Z=a.ConnectionLineType.Bezier,connectionLineStyle:Q,connectionLineComponent:q,connectionLineContainerStyle:Y,deleteKeyCode:J="Backspace",selectionKeyCode:ee="Shift",selectionOnDrag:et=!1,selectionMode:en=a.SelectionMode.Full,panActivationKeyCode:eo="Space",multiSelectionKeyCode:ei=(0,a.isMacOs)()?"Meta":"Control",zoomActivationKeyCode:er=(0,a.isMacOs)()?"Meta":"Control",snapToGrid:ea,snapGrid:es,onlyRenderVisibleElements:el=!1,selectNodesOnDrag:ed,nodesDraggable:ec,autoPanOnNodeFocus:eu,nodesConnectable:eg,nodesFocusable:eh,nodeOrigin:ep=A,edgesFocusable:ef,edgesReconnectable:em,elementsSelectable:ex=!0,defaultViewport:ey=z,minZoom:eb=.5,maxZoom:ew=2,translateExtent:eC=a.infiniteExtent,preventScrolling:ev=!0,nodeExtent:eS,defaultMarkerColor:ej="#b1b1b7",zoomOnScroll:e_=!0,zoomOnPinch:ek=!0,panOnScroll:eE=!1,panOnScrollSpeed:eR=.5,panOnScrollMode:eN=a.PanOnScrollMode.Free,zoomOnDoubleClick:eI=!0,panOnDrag:eM=!0,onPaneClick:eT,onPaneMouseEnter:eD,onPaneMouseMove:eL,onPaneMouseLeave:eP,onPaneScroll:eO,onPaneContextMenu:eA,paneClickDistance:ez=1,nodeClickDistance:eB=0,children:eF,onReconnect:eV,onReconnectStart:e$,onReconnectEnd:eH,onEdgeContextMenu:eG,onEdgeDoubleClick:eU,onEdgeMouseEnter:eX,onEdgeMouseMove:eW,onEdgeMouseLeave:eK,reconnectRadius:eZ=10,onNodesChange:eQ,onEdgesChange:eq,noDragClassName:eY="nodrag",noWheelClassName:eJ="nowheel",noPanClassName:e0="nopan",fitView:e1,fitViewOptions:e2,connectOnClick:e3,attributionPosition:e5,proOptions:e4,defaultEdgeOptions:e6,elevateNodesOnSelect:e8=!0,elevateEdgesOnSelect:e7=!1,disableKeyboardA11y:e9=!1,autoPanOnConnect:te,autoPanOnNodeDrag:tt,autoPanSpeed:tn,connectionRadius:to,isValidConnection:ti,onError:tr,style:ta,id:ts,nodeDragThreshold:tl,connectionDragThreshold:td,viewport:tc,onViewportChange:tu,width:tg,height:th,colorMode:tp="light",debug:tf,onScroll:tm,ariaLabelConfig:ty,zIndexMode:tb="basic",...tv},tS){let tj=ts||"1",t_=function(e){let[t,n]=(0,i.useState)("system"===e?null:e);return(0,i.useEffect)(()=>{if("system"!==e)return void n(e);let t=H(),o=()=>n(t?.matches?"dark":"light");return o(),t?.addEventListener("change",o),()=>{t?.removeEventListener("change",o)}},[e]),null!==t?t:H()?.matches?"dark":"light"}(tp),tk=(0,i.useCallback)(e=>{e.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),tm?.(e)},[tm]);return(0,o.jsx)("div",{"data-testid":"rf__wrapper",...tv,onScroll:tk,style:{...ta,...tC},ref:tS,className:r(["react-flow",l,t_]),id:ts,role:"application",children:(0,o.jsxs)(tw,{nodes:e,edges:t,width:tg,height:th,fitView:e1,fitViewOptions:e2,minZoom:eb,maxZoom:ew,nodeOrigin:ep,nodeExtent:eS,zIndexMode:tb,children:[(0,o.jsx)(tx,{onInit:h,onNodeClick:u,onEdgeClick:g,onNodeMouseEnter:v,onNodeMouseMove:S,onNodeMouseLeave:j,onNodeContextMenu:_,onNodeDoubleClick:k,nodeTypes:d,edgeTypes:c,connectionLineType:Z,connectionLineStyle:Q,connectionLineComponent:q,connectionLineContainerStyle:Y,selectionKeyCode:ee,selectionOnDrag:et,selectionMode:en,deleteKeyCode:J,multiSelectionKeyCode:ei,panActivationKeyCode:eo,zoomActivationKeyCode:er,onlyRenderVisibleElements:el,defaultViewport:ey,translateExtent:eC,minZoom:eb,maxZoom:ew,preventScrolling:ev,zoomOnScroll:e_,zoomOnPinch:ek,zoomOnDoubleClick:eI,panOnScroll:eE,panOnScrollSpeed:eR,panOnScrollMode:eN,panOnDrag:eM,onPaneClick:eT,onPaneMouseEnter:eD,onPaneMouseMove:eL,onPaneMouseLeave:eP,onPaneScroll:eO,onPaneContextMenu:eA,paneClickDistance:ez,nodeClickDistance:eB,onSelectionContextMenu:G,onSelectionStart:U,onSelectionEnd:X,onReconnect:eV,onReconnectStart:e$,onReconnectEnd:eH,onEdgeContextMenu:eG,onEdgeDoubleClick:eU,onEdgeMouseEnter:eX,onEdgeMouseMove:eW,onEdgeMouseLeave:eK,reconnectRadius:eZ,defaultMarkerColor:ej,noDragClassName:eY,noWheelClassName:eJ,noPanClassName:e0,rfId:tj,disableKeyboardA11y:e9,nodeExtent:eS,viewport:tc,onViewportChange:tu}),(0,o.jsx)($,{nodes:e,edges:t,defaultNodes:n,defaultEdges:s,onConnect:x,onConnectStart:y,onConnectEnd:b,onClickConnectStart:w,onClickConnectEnd:C,nodesDraggable:ec,autoPanOnNodeFocus:eu,nodesConnectable:eg,nodesFocusable:eh,edgesFocusable:ef,edgesReconnectable:em,elementsSelectable:ex,elevateNodesOnSelect:e8,elevateEdgesOnSelect:e7,minZoom:eb,maxZoom:ew,nodeExtent:eS,onNodesChange:eQ,onEdgesChange:eq,snapToGrid:ea,snapGrid:es,connectionMode:K,translateExtent:eC,connectOnClick:e3,defaultEdgeOptions:e6,fitView:e1,fitViewOptions:e2,onNodesDelete:T,onEdgesDelete:D,onDelete:L,onNodeDragStart:E,onNodeDrag:N,onNodeDragStop:M,onSelectionDrag:F,onSelectionDragStart:B,onSelectionDragStop:V,onMove:p,onMoveStart:f,onMoveEnd:m,noPanClassName:e0,nodeOrigin:ep,rfId:tj,autoPanOnConnect:te,autoPanOnNodeDrag:tt,autoPanSpeed:tn,onError:tr,connectionRadius:to,isValidConnection:ti,selectNodesOnDrag:ed,nodeDragThreshold:tl,connectionDragThreshold:td,onBeforeDelete:W,debug:tf,ariaLabelConfig:ty,zIndexMode:tb}),(0,o.jsx)(O,{onSelectionChange:P}),eF,(0,o.jsx)(I,{proOptions:e4,position:e5}),(0,o.jsx)(R,{rfId:tj,disableKeyboardA11y:e9})]})})});function tS(e){let[t,n]=(0,i.useState)(e),o=(0,i.useCallback)(e=>n(t=>K(e,t)),[]);return[t,n,o]}function tj(e){let[t,n]=(0,i.useState)(e),o=(0,i.useCallback)(e=>n(t=>K(e,t)),[]);return[t,n,o]}function t_({dimensions:e,lineWidth:t,variant:n,className:i}){return(0,o.jsx)("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:r(["react-flow__background-pattern",n,i])})}function tk({radius:e,className:t}){return(0,o.jsx)("circle",{cx:e,cy:e,r:e,className:r(["react-flow__background-pattern","dots",t])})}a.errorMessages.error014(),(t=n||(n={})).Lines="lines",t.Dots="dots",t.Cross="cross";let tE={[n.Dots]:1,[n.Lines]:1,[n.Cross]:6},tR=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function tN({id:e,variant:t=n.Dots,gap:a=20,size:s,lineWidth:l=1,offset:d=0,color:c,bgColor:u,style:g,className:h,patternClassName:p}){let m=(0,i.useRef)(null),{transform:x,patternId:y}=b(tR,f),w=s||tE[t],C=t===n.Dots,v=t===n.Cross,S=Array.isArray(a)?a:[a,a],j=[S[0]*x[2]||1,S[1]*x[2]||1],_=w*x[2],k=Array.isArray(d)?d:[d,d],E=v?[_,_]:j,R=[k[0]*x[2]||1+E[0]/2,k[1]*x[2]||1+E[1]/2],N=`${y}${e||""}`;return(0,o.jsxs)("svg",{className:r(["react-flow__background",h]),style:{...g,...ed,"--xy-background-color-props":u,"--xy-background-pattern-color-props":c},ref:m,"data-testid":"rf__background",children:[(0,o.jsx)("pattern",{id:N,x:x[0]%j[0],y:x[1]%j[1],width:j[0],height:j[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${R[0]},-${R[1]})`,children:C?(0,o.jsx)(tk,{radius:_/2,className:p}):(0,o.jsx)(t_,{dimensions:E,lineWidth:l,variant:t,className:p})}),(0,o.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${N})`})]})}tN.displayName="Background";let tI=(0,i.memo)(tN);function tM(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:(0,o.jsx)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function tT(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:(0,o.jsx)("path",{d:"M0 0h32v4.2H0z"})})}function tD(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:(0,o.jsx)("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function tL(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,o.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function tP(){return(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,o.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function tO({children:e,className:t,...n}){return(0,o.jsx)("button",{type:"button",className:r(["react-flow__controls-button",t]),...n,children:e})}let tA=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function tz({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:i=!0,fitViewOptions:a,onZoomIn:s,onZoomOut:l,onFitView:d,onInteractiveChange:c,className:u,children:g,position:h="bottom-left",orientation:p="vertical","aria-label":m}){let x=w(),{isInteractive:y,minZoomReached:C,maxZoomReached:v,ariaLabelConfig:S}=b(tA,f),{zoomIn:j,zoomOut:_,fitView:k}=ea();return(0,o.jsxs)(N,{className:r(["react-flow__controls","horizontal"===p?"horizontal":"vertical",u]),position:h,style:e,"data-testid":"rf__controls","aria-label":m??S["controls.ariaLabel"],children:[t&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tO,{onClick:()=>{j(),s?.()},className:"react-flow__controls-zoomin",title:S["controls.zoomIn.ariaLabel"],"aria-label":S["controls.zoomIn.ariaLabel"],disabled:v,children:(0,o.jsx)(tM,{})}),(0,o.jsx)(tO,{onClick:()=>{_(),l?.()},className:"react-flow__controls-zoomout",title:S["controls.zoomOut.ariaLabel"],"aria-label":S["controls.zoomOut.ariaLabel"],disabled:C,children:(0,o.jsx)(tT,{})})]}),n&&(0,o.jsx)(tO,{className:"react-flow__controls-fitview",onClick:()=>{k(a),d?.()},title:S["controls.fitView.ariaLabel"],"aria-label":S["controls.fitView.ariaLabel"],children:(0,o.jsx)(tD,{})}),i&&(0,o.jsx)(tO,{className:"react-flow__controls-interactive",onClick:()=>{x.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),c?.(!y)},title:S["controls.interactive.ariaLabel"],"aria-label":S["controls.interactive.ariaLabel"],children:y?(0,o.jsx)(tP,{}):(0,o.jsx)(tL,{})}),g]})}tz.displayName="Controls";let tB=(0,i.memo)(tz),tF=(0,i.memo)(function({id:e,x:t,y:n,width:i,height:a,style:s,color:l,strokeColor:d,strokeWidth:c,className:u,borderRadius:g,shapeRendering:h,selected:p,onClick:f}){let{background:m,backgroundColor:x}=s||{};return(0,o.jsx)("rect",{className:r(["react-flow__minimap-node",{selected:p},u]),x:t,y:n,rx:g,ry:g,width:i,height:a,style:{fill:l||m||x,stroke:d,strokeWidth:c},shapeRendering:h,onClick:f?t=>f(t,e):void 0})}),tV=e=>e.nodes.map(e=>e.id),t$=e=>e instanceof Function?e:()=>e,tH=(0,i.memo)(function({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:i,nodeBorderRadius:r,nodeStrokeWidth:s,shapeRendering:l,NodeComponent:d,onClick:c}){let{node:u,x:g,y:h,width:p,height:m}=b(t=>{let{internals:n}=t.nodeLookup.get(e),o=n.userNode,{x:i,y:r}=n.positionAbsolute,{width:s,height:l}=(0,a.getNodeDimensions)(o);return{node:o,x:i,y:r,width:s,height:l}},f);return u&&!u.hidden&&(0,a.nodeHasDimensions)(u)?(0,o.jsx)(d,{x:g,y:h,width:p,height:m,style:u.style,selected:!!u.selected,className:i(u),color:t(u),borderRadius:r,strokeColor:n(u),strokeWidth:s,shapeRendering:l,onClick:c,id:u.id}):null});var tG=(0,i.memo)(function({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:i=5,nodeStrokeWidth:r,nodeComponent:a=tF,onClick:s}){let l=b(tV,f),d=t$(t),c=t$(e),u=t$(n),g="undefined"==typeof window||window.chrome?"crispEdges":"geometricPrecision";return(0,o.jsx)(o.Fragment,{children:l.map(e=>(0,o.jsx)(tH,{id:e,nodeColorFunc:d,nodeStrokeColorFunc:c,nodeClassNameFunc:u,nodeBorderRadius:i,nodeStrokeWidth:r,NodeComponent:a,onClick:s,shapeRendering:g},e))})});let tU=e=>!e.hidden,tX=e=>{let t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?(0,a.getBoundsOfRects)((0,a.getInternalNodesBounds)(e.nodeLookup,{filter:tU}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}};function tW({style:e,className:t,nodeStrokeColor:n,nodeColor:s,nodeClassName:l="",nodeBorderRadius:d=5,nodeStrokeWidth:c,nodeComponent:u,bgColor:g,maskColor:h,maskStrokeColor:p,maskStrokeWidth:m,position:x="bottom-right",onClick:y,onNodeClick:C,pannable:v=!1,zoomable:S=!1,ariaLabel:j,inversePan:_,zoomStep:k=1,offsetScale:E=5}){let R=w(),I=(0,i.useRef)(null),{boundingRect:M,viewBB:T,rfId:D,panZoom:L,translateExtent:P,flowWidth:O,flowHeight:A,ariaLabelConfig:z}=b(tX,f),B=e?.width??200,F=e?.height??150,V=Math.max(M.width/B,M.height/F),$=V*B,H=V*F,G=E*V,U=M.x-($-M.width)/2-G,X=M.y-(H-M.height)/2-G,W=$+2*G,K=H+2*G,Z=`react-flow__minimap-desc-${D}`,Q=(0,i.useRef)(0),q=(0,i.useRef)();Q.current=V,(0,i.useEffect)(()=>{if(I.current&&L)return q.current=(0,a.XYMinimap)({domNode:I.current,panZoom:L,getTransform:()=>R.getState().transform,getViewScale:()=>Q.current}),()=>{q.current?.destroy()}},[L]),(0,i.useEffect)(()=>{q.current?.update({translateExtent:P,width:O,height:A,inversePan:_,pannable:v,zoomStep:k,zoomable:S})},[v,S,_,k,P,O,A]);let Y=y?e=>{let[t,n]=q.current?.pointer(e)||[0,0];y(e,{x:t,y:n})}:void 0,J=C?(0,i.useCallback)((e,t)=>{C(e,R.getState().nodeLookup.get(t).internals.userNode)},[]):void 0,ee=j??z["minimap.ariaLabel"];return(0,o.jsx)(N,{position:x,style:{...e,"--xy-minimap-background-color-props":"string"==typeof g?g:void 0,"--xy-minimap-mask-background-color-props":"string"==typeof h?h:void 0,"--xy-minimap-mask-stroke-color-props":"string"==typeof p?p:void 0,"--xy-minimap-mask-stroke-width-props":"number"==typeof m?m*V:void 0,"--xy-minimap-node-background-color-props":"string"==typeof s?s:void 0,"--xy-minimap-node-stroke-color-props":"string"==typeof n?n:void 0,"--xy-minimap-node-stroke-width-props":"number"==typeof c?c:void 0},className:r(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:(0,o.jsxs)("svg",{width:B,height:F,viewBox:`${U} ${X} ${W} ${K}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Z,ref:I,onClick:Y,children:[ee&&(0,o.jsx)("title",{id:Z,children:ee}),(0,o.jsx)(tG,{onClick:J,nodeColor:s,nodeStrokeColor:n,nodeBorderRadius:d,nodeClassName:l,nodeStrokeWidth:c,nodeComponent:u}),(0,o.jsx)("path",{className:"react-flow__minimap-mask",d:`M${U-G},${X-G}h${W+2*G}v${K+2*G}h${-W-2*G}z
        M${T.x},${T.y}h${T.width}v${T.height}h${-T.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}tW.displayName="MiniMap";let tK=(0,i.memo)(tW),tZ={[a.ResizeControlVariant.Line]:"right",[a.ResizeControlVariant.Handle]:"bottom-right"};(0,i.memo)(function({nodeId:e,position:t,variant:n=a.ResizeControlVariant.Handle,className:s,style:l,children:d,color:c,minWidth:u=10,minHeight:g=10,maxWidth:h=Number.MAX_VALUE,maxHeight:p=Number.MAX_VALUE,keepAspectRatio:m=!1,resizeDirection:x,autoScale:y=!0,shouldResize:C,onResizeStart:v,onResize:S,onResizeEnd:j}){let _,k=ev(),E="string"==typeof e?e:k,R=w(),N=(0,i.useRef)(null),I=n===a.ResizeControlVariant.Handle,M=b((0,i.useCallback)((_=I&&y,e=>_?`${Math.max(1/e.transform[2],1)}`:void 0),[I,y]),f),T=(0,i.useRef)(null),D=t??tZ[n];(0,i.useEffect)(()=>{if(N.current&&E)return T.current||(T.current=(0,a.XYResizer)({domNode:N.current,nodeId:E,getStoreItems:()=>{let{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:o,nodeOrigin:i,domNode:r}=R.getState();return{nodeLookup:e,transform:t,snapGrid:n,snapToGrid:o,nodeOrigin:i,paneDomNode:r}},onChange:(e,t)=>{let{triggerNodeChanges:n,nodeLookup:o,parentLookup:i,nodeOrigin:r}=R.getState(),s=[],l={x:e.x,y:e.y},d=o.get(E);if(d&&d.expandParent&&d.parentId){let t=d.origin??r,n=e.width??d.measured.width??0,c=e.height??d.measured.height??0,u={id:d.id,parentId:d.parentId,rect:{width:n,height:c,...(0,a.evaluateAbsolutePosition)({x:e.x??d.position.x,y:e.y??d.position.y},{width:n,height:c},d.parentId,o,t)}},g=(0,a.handleExpandParent)([u],o,i,r);s.push(...g),l.x=e.x?Math.max(t[0]*n,e.x):void 0,l.y=e.y?Math.max(t[1]*c,e.y):void 0}if(void 0!==l.x&&void 0!==l.y){let e={id:E,type:"position",position:{...l}};s.push(e)}if(void 0!==e.width&&void 0!==e.height){let t={id:E,type:"dimensions",resizing:!0,setAttributes:!x||("horizontal"===x?"width":"height"),dimensions:{width:e.width,height:e.height}};s.push(t)}for(let e of t){let t={...e,type:"position"};s.push(t)}n(s)},onEnd:({width:e,height:t})=>{R.getState().triggerNodeChanges([{id:E,type:"dimensions",resizing:!1,dimensions:{width:e,height:t}}])}})),T.current.update({controlPosition:D,boundaries:{minWidth:u,minHeight:g,maxWidth:h,maxHeight:p},keepAspectRatio:m,resizeDirection:x,onResizeStart:v,onResize:S,onResizeEnd:j,shouldResize:C}),()=>{T.current?.destroy()}},[D,u,g,h,p,m,v,S,j,C]);let L=D.split("-");return(0,o.jsx)("div",{className:r(["react-flow__resize-control","nodrag",...L,n,s]),ref:N,style:{...l,scale:M,...c&&{[I?"backgroundColor":"borderColor"]:c}},children:d})}),e.s(["Background",()=>tI,"BaseEdge",()=>eG,"ControlButton",()=>tO,"Controls",()=>tB,"Handle",()=>ej,"MiniMap",()=>tK,"Panel",()=>N,"ReactFlow",()=>tv,"ReactFlowProvider",()=>tb,"useEdgesState",()=>tj,"useNodesState",()=>tS,"useReactFlow",()=>ea,"useStore",()=>b],918132);var tQ=e.i(705443);async function tq(e){return(await tQ.axiosClient.post("/api/cll",e)).data}async function tY(e){return(await tQ.axiosClient.post("/api/checks",{type:"lineage_diff",params:{},view_options:e})).data}async function tJ(e){return(await tQ.axiosClient.post("/api/checks",{type:"schema_diff",params:e})).data}async function t0(e){return(await tQ.axiosClient.post("/api/select",e)).data}e.s(["getCll",()=>tq],953131),e.s(["createLineageDiffCheck",()=>tY],323194),e.s(["createSchemaDiffCheck",()=>tJ],987923),e.s(["select",()=>t0],2216),e.i(715841);var t1=e.i(667828),t2=e.i(415790),t3=e.i(539579),t5=e.i(187726);function t4({onClose:e}){let{cancel:t,actionState:n}=(0,t5.useLineageViewContextSafe)();return(0,o.jsx)(t1.Box,{bg:"white",rounded:"md",shadow:"dark-lg",children:(0,o.jsxs)(t3.HStack,{p:"5px 15px",mt:"4",separator:(0,o.jsx)(t3.StackSeparator,{borderColor:"gray.200"}),gap:4,children:[(0,o.jsxs)(t1.Box,{fontSize:"10pt",children:["Progress: ","per_node"===n.mode?`${n.completed} / ${n.total}`:n.currentRun?.progress?.percentage?`${100*n.currentRun.progress.percentage}%`:"completed"===n.status?"100%":"0%"," ","canceled"===n.status?" (canceled)":""]}),"running"===n.status||"canceling"===n.status?(0,o.jsx)(t2.Button,{size:"xs",variant:"outline",onClick:t,loading:"canceling"===n.status,loadingText:"Canceling",children:"Cancel"}):(0,o.jsx)(t3.HStack,{children:(0,o.jsx)(t2.Button,{size:"xs",variant:"outline",onClick:e,children:"Close"})})]})})}e.s(["ActionControl",()=>t4],525519);var t6=e.i(625961),t8=e.i(731645);e.i(134115);var t7=e.i(940999),t9=e.i(569210),ne=e.i(65086),nt=e.i(224378),nn=e.i(599180);let no=nt.VscDiffAdded,ni=nt.VscDiffRemoved,nr=nt.VscDiffModified;function na(e){return"added"===e?{color:"green.solid",hexColor:String(nn.system.token("colors.green.solid")),backgroundColor:"green.subtle",hexBackgroundColor:String(nn.system.token("colors.green.subtle")),icon:no}:"removed"===e?{color:"red.solid",hexColor:String(nn.system.token("colors.red.solid")),backgroundColor:"red.subtle",hexBackgroundColor:String(nn.system.token("colors.red.subtle")),icon:ni}:"modified"===e?{color:"orange.emphasized",hexColor:String(nn.system.token("colors.orange.emphasized")),backgroundColor:"orange.subtle",hexBackgroundColor:String(nn.system.token("colors.orange.subtle")),icon:nr}:{color:"gray.focusRing",hexColor:String(nn.system.token("colors.gray.focusRing")),backgroundColor:"white",hexBackgroundColor:String(nn.system.token("colors.white")),icon:void 0}}function ns(e){if("model"===e)return{color:String(nn.system.token("colors.cyan.subtle")),icon:t9.FaCube};if("metric"===e)return{color:String(nn.system.token("colors.rose.subtle")),icon:ne.FaChartSimple};if("source"===e)return{color:String(nn.system.token("colors.green.muted")),icon:t9.FaDatabase};if("exposure"===e)return{color:String(nn.system.token("colors.rose.subtle")),icon:ne.FaGauge};if("semantic_model"===e)return{color:String(nn.system.token("colors.rose.focusRing")),icon:ne.FaCircleNodes};else if("seed"===e)return{color:String(nn.system.token("colors.green.emphasized")),icon:t9.FaSeedling};else if("snapshot"===e)return{color:String(nn.system.token("colors.green.emphasized")),icon:t9.FaCamera};else return{color:"inherit",icon:void 0}}function nl(){return(0,o.jsx)(t1.Box,{sx:{bgcolor:"white",padding:"12px",border:"1px solid",borderColor:"grey.200",fontSize:"sm"},children:Object.entries({added:["Added","Added resource"],removed:["Removed","Removed resource"],modified:["Modified","Modified resource"]}).map(([e,[t,n]])=>{let{icon:i,color:r}=na(e);return(0,o.jsx)(t7.Tooltip,{content:n,positioning:{placement:"right"},children:(0,o.jsxs)(t6.Flex,{sx:{alignItems:"center",gap:"6px",mb:"2px"},children:[(0,o.jsx)(t8.Icon,{color:r,as:i})," ",t]})},e)})})}e.s(["getIconForChangeStatus",()=>na,"getIconForResourceType",()=>ns],248859),e.s(["ChangeStatusLegend",()=>nl],88515);var nd=e.i(388797),nc=e.i(489821),nu=e.i(653491);e.i(489622),e.i(61109);var ng=e.i(911288),nh=e.i(336567),np=e.i(255677),nf=e.i(916955),nm=e.i(286568);let nx=()=>{let{lineageGraph:e}=(0,nf.useLineageGraphContext)(),{centerNode:t,viewOptions:n}=(0,t5.useLineageViewContextSafe)(),i=n.column_level_lineage;if(!e)return(0,o.jsx)(o.Fragment,{});if(!i)return"Default View";if(void 0===i.node_id)return(0,o.jsx)(np.Text,{as:"span",children:"Impact Radius for All Changed Models"});let r=i.node_id in e.nodes?e.nodes[i.node_id].data.name:i.node_id;if(i.column){let e=`${i.node_id}_${i.column}`;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(np.Text,{as:"span",mr:"5px",children:["Column Lineage for"," "]}),(0,o.jsxs)(nc.Code,{onClick:()=>{t(e)},cursor:"pointer",children:[r,".",i.column]})]})}{let e=i.node_id;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(np.Text,{as:"span",mr:"5px",children:"Impact Radius for"}),(0,o.jsx)(nc.Code,{onClick:()=>{t(e)},cursor:"pointer",children:r})]})}};e.s(["ColumnLevelLineageControl",0,({action:e})=>{let{showColumnLevelLineage:t,resetColumnLevelLineage:n,interactive:i,viewOptions:r}=(0,t5.useLineageViewContextSafe)(),{data:a}=(0,nm.useRecceServerFlag)(),s=a?.single_env_onboarding??!1,{lineageGraph:l}=(0,nf.useLineageGraphContext)(),d=!l?.catalogMetadata.current;return(0,o.jsxs)(t6.Flex,{direction:"row",gap:"5px",children:[!s&&(0,o.jsx)(t1.Box,{borderRadius:"md",boxShadow:"md",border:"1px solid",borderColor:"gray.200",bg:"white",children:(0,o.jsx)(t7.Tooltip,{openDelay:50,content:"Please provide catalog.json to enable Impact Radius",disabled:!d,positioning:{placement:"top"},children:(0,o.jsxs)(t2.Button,{size:"sm",variant:"ghost",whiteSpace:"nowrap",display:"inline-flex",disabled:!i||d,onClick:()=>{t({no_upstream:!0,change_analysis:!0})},children:[(0,o.jsx)(t9.FaRegDotCircle,{})," Impact Radius"]})})}),r.column_level_lineage&&(0,o.jsxs)(t6.Flex,{borderRadius:"md",boxShadow:"md",border:"1px solid",borderColor:"gray.200",bg:"white",fontSize:"0.8rem",p:"0 0.625rem",alignItems:"center",children:[(0,o.jsx)(nx,{}),e.isError&&(0,o.jsx)(t7.Tooltip,{content:`Error: ${e.error.message}`,positioning:{placement:"bottom"},children:(0,o.jsx)(np.Text,{as:"span",color:"red.500",ml:"2px",display:"inline-flex",alignItems:"center",children:(0,o.jsx)(t8.Icon,{as:nd.PiInfo,color:"red.500",boxSize:"14px"})})}),e.isPending?(0,o.jsx)(nh.Spinner,{size:"xs",ml:"2px"}):(0,o.jsx)(nu.IconButton,{variant:"ghost",size:"xs",ml:"2px","aria-label":"Reset Column Level Lineage",onClick:()=>{n()},children:(0,o.jsx)(nd.PiX,{size:"10px"})})]})]})}],166598);var ny=e.i(56606),nb=e.i(100377),nw=e.i(523043);let nC=({changeStatus:e})=>{if(!e)return(0,o.jsx)(o.Fragment,{});let{color:t,icon:n}=na(e);return(0,o.jsx)(t8.Icon,{boxSize:"14px",display:"inline-flex",color:t,as:n})},nv=({transformationType:e,legend:t})=>{let n="U",i="red";return("passthrough"===e?(n="P",i="gray"):"renamed"===e?(n="R",i="orange"):"derived"===e?(n="D",i="orange"):"source"===e?(n="S",i="blue"):(n="U",i="red"),e)?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(nb.Tag.Root,{fontSize:"8pt",size:"sm",colorPalette:i,borderRadius:"full",paddingX:"4px",children:(0,o.jsx)(nb.Tag.Label,{children:n})})}):(0,o.jsx)(o.Fragment,{})};function nS(e){let{id:t,data:n}=e,{id:r}=n.node,{column:s,type:l,transformationType:d,changeStatus:c}=n,u=b(e=>e.transform[2]>.3),{viewOptions:g,showContextMenu:h,isNodeHighlighted:p,isNodeShowingChangeAnalysis:f}=(0,t5.useLineageViewContextSafe)(),m=g.column_level_lineage?.node_id,x=s===g.column_level_lineage?.column&&r===m,[y,w]=i.default.useState(!1),C=p(t),v=f(r);return u?(0,o.jsxs)(t6.Flex,{width:"280px",padding:"0px 10px",border:"1px solid gray",backgroundColor:x?"#f0f0f0":"inherit",_hover:{backgroundColor:"#f0f0f0"},onMouseEnter:()=>{w(!0)},onMouseLeave:()=>{w(!1)},filter:C?"none":"opacity(0.2) grayscale(50%)",cursor:"pointer",children:[(0,o.jsxs)(t6.Flex,{fontSize:"11px",color:"black",width:"100%",gap:"3px",alignItems:"center",height:`${nw.COLUMN_HEIGHT-1}px`,children:[v&&c?(0,o.jsx)(nC,{changeStatus:c}):(0,o.jsx)(nv,{transformationType:d}),(0,o.jsx)(t1.Box,{height:`${nw.COLUMN_HEIGHT+1}px`,children:s}),(0,o.jsx)(ny.Spacer,{}),y?(0,o.jsx)(t8.Icon,{as:nt.VscKebabVertical,boxSize:"14px",display:"inline-flex",cursor:"pointer",_hover:{color:"black"},onClick:t=>{t.preventDefault(),t.stopPropagation(),h(t,e)}}):(0,o.jsx)(t1.Box,{height:`${nw.COLUMN_HEIGHT+1} px`,children:l})]}),(0,o.jsx)(ej,{type:"target",position:a.Position.Left,isConnectable:!1,style:{left:0,visibility:"hidden"}}),(0,o.jsx)(ej,{type:"source",position:a.Position.Right,isConnectable:!1,style:{right:0,visibility:"hidden"}})]}):(0,o.jsx)(o.Fragment,{})}function nj(){return(0,o.jsx)(t1.Box,{sx:{bgcolor:"white",padding:"12px",border:"1px solid",borderColor:"grey.200",fontSize:"sm"},children:Object.entries({passthrough:["Pass Through","The column is directly selected from the upstream table."],renamed:["Renamed","The column is selected from the upstream table but with a different name."],derived:["Derived","The column is created through transformations applied to upstream columns, such as calculations, conditions, functions, or aggregations."],source:["Source","The column is not derived from any upstream data. It may originate from a seed/source node, literal value, or data generation function."],unknown:["Unknown","We have no information about the transformation type. This could be due to a parse error, or other unknown reason."]}).map(([e,[t,n]])=>(0,o.jsx)(t7.Tooltip,{content:n,positioning:{placement:"right"},children:(0,o.jsxs)(t6.Flex,{sx:{alignItems:"center",gap:"6px",mb:"2px"},children:[(0,o.jsx)(nv,{legend:!0,transformationType:e})," ",t]})},e))})}function n_(e){let{source:t,target:n,sourceX:i,sourceY:r,targetX:s,targetY:l,sourcePosition:d,targetPosition:c,style:u={},markerEnd:g,data:h}=e,p={...u},{isEdgeHighlighted:f}=(0,t5.useLineageViewContextSafe)();h?.changeStatus&&(p.stroke=na(h.changeStatus).hexColor,p.strokeDasharray="5"),f(t,n)||(p.filter="opacity(0.2) grayscale(50%)");let[m]=(0,a.getBezierPath)({sourceX:i,sourceY:r,sourcePosition:d,targetX:s,targetY:l,targetPosition:c});return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(eG,{path:m,markerEnd:g,style:{...p,...u}})})}e.s(["GraphColumnNode",()=>nS,"TransformationType",0,nv],904451),e.s(["ColumnLevelLineageLegend",()=>nj],632951),e.s(["default",()=>n_],676502);var nk=e.i(138920),nE=e.i(652058),nR=e.i(372230);function nN(e,t){if(!e||!t)return;let n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!0;for(let e=0;e<n.length;e++)if(n[e]!==o[e])return!0;for(let n of o)if(!e[n]||e[n].type!==t[n]?.type)return!0;return!1}e.s(["isSchemaChanged",()=>nN],163669);var nI=e.i(886634),nM=e.i(862754),nT=e.i(84723),nD=e.i(42409),nL=e.i(913369),nP=e.i(902669),nO=e.i(912007);function nA({node:e}){let{icon:t}=ns(e.data.resourceType);return(0,o.jsx)(t7.Tooltip,{showArrow:!0,content:"Type of resource",children:(0,o.jsxs)(nb.Tag.Root,{children:[t&&(0,o.jsx)(nb.Tag.StartElement,{children:(0,o.jsx)(t,{})}),(0,o.jsx)(nb.Tag.Label,{children:e.data.resourceType})]})})}function nz({rowCount:e}){let t=e.base,n=e.curr,i=null===e.base?"N/A":`${e.base} rows`,r=null===e.curr?"N/A":`${e.curr} rows`;return null===t&&null===n?(0,o.jsx)(o.Fragment,{children:" Failed to load"}):null===t||null===n?(0,o.jsxs)(t3.HStack,{children:[(0,o.jsx)(np.Text,{children:i}),(0,o.jsx)(t8.Icon,{as:nT.FiArrowRight}),(0,o.jsx)(np.Text,{children:r})]}):t===n?(0,o.jsxs)(t3.HStack,{children:[(0,o.jsx)(np.Text,{children:r}),(0,o.jsx)(t8.Icon,{as:nD.RiSwapLine,color:"gray.500"}),(0,o.jsx)(np.Text,{color:"gray.500",children:"No Change"})]}):t<n?(0,o.jsxs)(t3.HStack,{children:[(0,o.jsx)(np.Text,{children:r}),(0,o.jsx)(t8.Icon,{as:nD.RiArrowUpSFill,color:"green.500"}),(0,o.jsx)(np.Text,{color:"green.500",children:(0,nE.deltaPercentageString)(t,n)})]}):(0,o.jsxs)(t3.HStack,{children:[(0,o.jsx)(np.Text,{children:r}),(0,o.jsx)(t8.Icon,{as:nD.RiArrowDownSFill,color:"red.500"}),(0,o.jsx)(np.Text,{color:"red.500",children:(0,nE.deltaPercentageString)(t,n)})]})}function nB({rowCount:e,node:t,onRefresh:n,isFetching:i}){let{featureToggles:r}=(0,nO.useRecceInstanceContext)(),{runsAggregated:a}=(0,nf.useLineageGraphContext)(),s=a?.[t.id]?.row_count_diff.result,l=(0,nR.findByRunType)("row_count_diff").icon,d=e??s,c=d?`${d.base??"N/A"} -> ${d.curr??"N/A"} rows`:"";return(0,o.jsx)(t7.Tooltip,{content:c,children:(0,o.jsx)(nL.default,{display:"metadata only"===r.mode,children:(0,o.jsx)(nb.Tag.Root,{asChild:!0,children:(0,o.jsxs)(t6.Flex,{direction:"row",alignItems:"center",gap:"1",children:[(0,o.jsx)(l,{}),null!=d||i?(0,o.jsx)(nP.SkeletonText,{loading:!1,noOfLines:1,minWidth:"30px",fontSize:"xs",children:null!=d?(0,o.jsx)(nz,{rowCount:d}):"row count"}):(0,o.jsx)(np.Text,{fontSize:"xs",children:"row count"}),n&&(0,o.jsx)(nu.IconButton,{loading:i,"aria-label":"Query Row Count",size:"2xs",p:"0",variant:"ghost",onClick:n,disabled:r.disableDatabaseQuery,children:(0,o.jsx)(nd.PiRepeat,{})})]})})})})}function nF({rowCount:e,node:t,onRefresh:n,isFetching:i}){let r,{runsAggregated:a}=(0,nf.useLineageGraphContext)(),s=a?.[t.id]?.row_count.result,l=(0,nR.findByRunType)("row_count").icon,d=e??s;if(d){let e=d.curr??"N/A";r=`${e} rows`}return(0,o.jsxs)(nb.Tag.Root,{children:[(0,o.jsx)(nb.Tag.StartElement,{children:(0,o.jsx)(l,{})}),(0,o.jsx)(nb.Tag.Label,{children:d||i?(0,o.jsx)(nP.SkeletonText,{loading:i,lineClamp:1,height:2,minWidth:"30px",children:d?`${r}`:"row count"}):(0,o.jsx)(o.Fragment,{children:"row count"})}),n&&(0,o.jsx)(nu.IconButton,{loading:i,"aria-label":"Query Row Count",size:"2xs",p:"0",variant:"ghost",onClick:n,disabled:"base"===t.data.from,children:(0,o.jsx)(nd.PiRepeat,{})})]})}e.s(["ResourceTypeTag",()=>nA,"RowCountDiffTag",()=>nB,"RowCountTag",()=>nF],636819);let nV=({node:e,action:t})=>{let{status:n,skipReason:i,run:r}=t;if("pending"===n)return(0,o.jsx)(nI.ProgressCircle.Root,{value:0,size:"xs",children:(0,o.jsxs)(nI.ProgressCircle.Circle,{children:[(0,o.jsx)(nI.ProgressCircle.Track,{}),(0,o.jsx)(nI.ProgressCircle.Range,{})]})});if("skipped"===n)return(0,o.jsx)(nb.Tag.Root,{backgroundColor:"grey.100",children:(0,o.jsx)(nb.Tag.Label,{children:(0,o.jsxs)(t6.Flex,{sx:{fontSize:"10pt",color:"grey.500",alignItems:"center",gap:"3px"},children:[(0,o.jsx)(t1.Box,{children:"Skipped"}),i&&(0,o.jsx)(t7.Tooltip,{content:i,children:(0,o.jsx)(nd.PiInfo,{})})]})})});if(!r)return(0,o.jsx)(nI.ProgressCircle.Root,{value:null,size:"xs",children:(0,o.jsxs)(nI.ProgressCircle.Circle,{children:[(0,o.jsx)(nI.ProgressCircle.Track,{}),(0,o.jsx)(nI.ProgressCircle.Range,{})]})});let{error:a,run_id:s,progress:l}=r;if("running"===n)if(l?.percentage===void 0)return(0,o.jsx)(nI.ProgressCircle.Root,{value:null,size:"xs",children:(0,o.jsxs)(nI.ProgressCircle.Circle,{children:[(0,o.jsx)(nI.ProgressCircle.Track,{}),(0,o.jsx)(nI.ProgressCircle.Range,{})]})});else return(0,o.jsx)(nI.ProgressCircle.Root,{value:100*l.percentage,size:"xs",children:(0,o.jsxs)(nI.ProgressCircle.Circle,{children:[(0,o.jsx)(nI.ProgressCircle.Track,{}),(0,o.jsx)(nI.ProgressCircle.Range,{})]})});if(a)return(0,o.jsxs)(t6.Flex,{sx:{fontSize:"10pt",color:"gray"},children:[(0,o.jsx)(t1.Box,{children:"Error"}),i&&(0,o.jsx)(t7.Tooltip,{content:a,children:(0,o.jsx)(nd.PiWarning,{})})]});if((0,nM.isValueDiffRun)(r)&&r.result){let e=r.result,t=0;for(let n of e.data.data)n[2]<1&&t++;return(0,o.jsx)(nb.Tag.Root,{backgroundColor:t>0?"error.light":"success.light",children:(0,o.jsx)(nb.Tag.Label,{children:(0,o.jsx)(t6.Flex,{sx:{fontSize:"10pt",color:t>0?"error.main":"success.main",alignItems:"center",gap:"3px"},children:t>0?`${t} columns mismatched`:"All columns match"})})})}if((0,nM.isRowCountDiffRun)(r)&&r.result){let t=r.result;return(0,o.jsx)(nB,{rowCount:t[e.data.name],node:e})}if((0,nM.isRowCountRun)(r)&&r.result){let t=r.result;return(0,o.jsx)(nF,{rowCount:t[e.data.name],node:e})}return(0,o.jsx)(o.Fragment,{children:s})};function n$({rowCount:e}){let t,n,i=e.base,r=e.curr,a=null===e.base?"N/A":`${e.base} Rows`,s=null===e.curr?"N/A":`${e.curr} Rows`;return null===i&&null===r?(t="Failed to load",n="gray"):null===i||null===r?(t=`${a} -> ${s}`,n=null===i?"green":"red"):i===r?(t="=",n="gray"):i!==r&&(t=`${(0,nE.deltaPercentageString)(i,r)} Rows`,n=i<r?"green":"red"),(0,o.jsx)(nb.Tag.Root,{colorPalette:n,children:(0,o.jsxs)(t6.Flex,{gap:1,alignItems:"center",children:[(0,o.jsx)(t8.Icon,{as:(0,nR.findByRunType)("row_count_diff").icon}),(0,o.jsx)(nb.Tag.Label,{children:t})]})})}let nH={breaking:"Breaking",non_breaking:"Non Breaking",partial_breaking:"Partial Breaking",unknown:"Unknown"},nG=({id:e,inverted:t})=>{let n,i,{lineageGraph:r,runsAggregated:a}=(0,nf.useLineageGraphContext)(),s=a?.[e],l=r?.nodes[e];if(!s&&!l)return(0,o.jsx)(o.Fragment,{});if(l?.data.data.base&&l.data.data.current&&(n=nN(l.data.data.base.columns,l.data.data.current.columns)),s?.row_count_diff){let e=s.row_count_diff.result;i=e.curr!==e.base}let d=t?"white":na("modified").color;return(0,o.jsxs)(t6.Flex,{flex:"1",children:[void 0!==n&&(0,o.jsx)(t7.Tooltip,{content:`Schema (${n?"changed":"no change"})`,openDelay:500,children:(0,o.jsx)(t1.Box,{height:"16px",children:(0,o.jsx)(t8.Icon,{as:(0,nR.findByRunType)("schema_diff").icon,color:n?d:t?"gray":"gray.100"})})}),(0,o.jsx)(ny.Spacer,{}),s?.row_count_diff&&void 0!==i&&(0,o.jsx)(t7.Tooltip,{content:`Row count (${i?"changed":"="})`,openDelay:500,children:(0,o.jsx)(t1.Box,{children:(0,o.jsx)(n$,{rowCount:s.row_count_diff.result})})})]})},nU=({checked:e,onClick:t})=>(0,o.jsx)(t6.Flex,{onClick:t,alignSelf:"center",alignItems:"center",cursor:"pointer",children:e?(0,o.jsx)(t8.Icon,{boxSize:"20px",as:t9.FaCheckSquare}):(0,o.jsx)(t8.Icon,{boxSize:"20px",as:t9.FaRegSquare})}),nX=({name:e,color:t,resourceType:n})=>(0,o.jsx)(t1.Box,{flex:"1",color:t,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:(0,o.jsx)(t7.Tooltip,{content:"model"===n?e:`${e} (${n})`,positioning:{placement:"top"},children:(0,o.jsx)("span",{children:e})})});function nW(e){let{data:t}=e,{id:n,resourceType:r,changeStatus:s}=t,l=b(e=>e.transform[2]>.3),{icon:d}=ns(r),[c,u]=(0,i.useState)(!1),{interactive:g,selectNode:h,selectMode:p,focusedNode:f,getNodeAction:m,getNodeColumnSet:x,isNodeHighlighted:y,isNodeSelected:w,isNodeShowingChangeAnalysis:C,showContextMenu:v,viewOptions:S,cll:j,showColumnLevelLineage:_}=(0,t5.useLineageViewContextSafe)(),k=j?.current.nodes[n]?.change_category,E=y(n),R=w(n),N=S.column_level_lineage?.node_id===n&&void 0===S.column_level_lineage.column,I=f?.id===n||N,M=C(n),{icon:T,color:D,backgroundColor:L}=s?na(s):{icon:void 0,color:"gray.400",backgroundColor:"gray.100"},P=t.name,O=x(t.id),A=O.size>0,z="action_result"===p?m(t.id):void 0,B=l?"selecting"===p?R?D:"white":"action_result"!==p?I||R||c?L:"white":z?I||R||c?L:D:"white":I||R||c?D:L,F="selecting"===p?R?"white":"inherit":"action_result"===p&&z&&!R?"white":"inherit",V="selecting"===p?R?"white":"inherit":"action_result"===p&&z&&!R?"white":"inherit",$="selecting"===p?R?"white":D:"action_result"===p?z&&!R?"white":"inherit":D;return(0,o.jsxs)(t6.Flex,{cursor:"selecting"===p?"pointer":"inherit",direction:"column",width:"300px",transition:"box-shadow 0.2s ease-in-out",padding:0,filter:"action_result"===p?z?"none":"opacity(0.2) grayscale(50%)":E||I||R||c?"none":"opacity(0.2) grayscale(50%)",onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1)},children:[(0,o.jsxs)(t6.Flex,{borderColor:D,borderWidth:"2px",borderTopRadius:8,borderBottomRadius:8*!A,backgroundColor:B,height:"60px",children:[(0,o.jsx)(t6.Flex,{bg:D,padding:g?"8px":"2px",borderRightWidth:"2px",borderColor:"selecting"===p?"#00000020":D,alignItems:"top",visibility:l?"inherit":"hidden",children:g&&(0,o.jsx)(nU,{checked:"selecting"===p&&R||"action_result"===p&&!!z,onClick:e=>{"action_result"!==p&&(e.stopPropagation(),h(t.id))}})}),(0,o.jsxs)(t6.Flex,{flex:"1 0 auto",mx:"1",width:"100px",direction:"column",children:[(0,o.jsxs)(t6.Flex,{width:"100%",textAlign:"left",fontWeight:"600",flex:"1",p:1,gap:"5px",alignItems:"center",visibility:l?"inherit":"hidden",children:[(0,o.jsx)(nX,{name:P,color:F,resourceType:r}),c?(0,o.jsxs)(o.Fragment,{children:["modified"===s&&(0,o.jsx)(t7.Tooltip,{content:"Show Impact Radius",positioning:{placement:"top"},openDelay:500,children:(0,o.jsx)(nk.Center,{children:(0,o.jsx)(t8.Icon,{boxSize:"14px",as:t9.FaRegDotCircle,color:"gray",cursor:"pointer",_hover:{color:"black"},onClick:e=>{e.preventDefault(),e.stopPropagation(),_({node_id:n,change_analysis:!0,no_upstream:!0})}})})}),(0,o.jsx)(t8.Icon,{as:nt.VscKebabVertical,color:"gray",cursor:"pointer",_hover:{color:"black"},onClick:t=>{t.preventDefault(),t.stopPropagation(),v(t,e)}})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t8.Icon,{boxSize:"16px",color:V,as:d}),s&&(0,o.jsx)(t8.Icon,{color:$,as:T})]})]}),(0,o.jsx)(t6.Flex,{flex:"1 0 auto",mx:"1",direction:"column",paddingBottom:"1",visibility:l?"inherit":"hidden",children:(0,o.jsx)(t3.HStack,{gap:"8px",children:z?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ny.Spacer,{}),(0,o.jsx)(nV,{node:t,action:z})]}):M?(0,o.jsx)(t1.Box,{height:"20px",color:"gray",fontSize:"9pt",margin:0,fontWeight:600,children:k?nH[k]:""}):"action_result"!==p&&"model"===t.resourceType?(0,o.jsx)(nG,{id:t.id,inverted:"selecting"===p&&R}):(0,o.jsx)(o.Fragment,{})})})]})]}),A&&(0,o.jsx)(t1.Box,{p:"10px 10px",borderColor:D,borderWidth:"2px",borderTopWidth:0,borderBottomRadius:8,children:(0,o.jsx)(t1.Box,{height:`${O.size*nw.COLUMN_HEIGHT}px`,overflow:"auto"})}),Object.keys(t.parents).length>0&&(0,o.jsx)(ej,{type:"target",position:a.Position.Left,isConnectable:!1}),Object.keys(t.children).length>0&&(0,o.jsx)(ej,{type:"source",position:a.Position.Right,isConnectable:!1})]})}e.s(["GraphNode",()=>nW],592355);var nK=e.i(955343);function nZ(e){return(0,nK.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6 18h12v2H6zm6-14.414-6.707 6.707 1.414 1.414L11 7.414V16h2V7.414l4.293 4.293 1.414-1.414z"},child:[]}]})(e)}function nQ(e){return(0,nK.GenIcon)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6 18h12v2H6zm5-14v8.586L6.707 8.293 5.293 9.707 12 16.414l6.707-6.707-1.414-1.414L13 12.586V4z"},child:[]}]})(e)}var nq=e.i(601272),nY=e.i(453929),nJ=e.i(203158),n0=e.i(675155);function n1(e,t){let n=(0,n0.mergeKeys)(e,t);if(0===n.length)return[];if(0===e.length||0===t.length)return n.map((e,t)=>t===n.length-1?e:e+",");let o="";return n.forEach(n=>{e.includes(n)&&t.includes(n)&&(o=n)}),n.map((i,r)=>{let a;return(a=e.includes(i)?t.includes(i)?i:`--- ${i} (Removed)`:`--- ${i} (Added)`,i===o||r===n.length-1)?a:a+","})}e.s(["formatSelectColumns",()=>n1],832421);var n2=e.i(29134),n3=e.i(475119),n5=e.i(505251),n4=e.i(400905),n6=e.i(645364);let n8=({menuItems:e,open:t,onClose:n,x:i,y:r})=>{let{featureToggles:a}=(0,nO.useRecceInstanceContext)();return(0,o.jsx)(nq.Menu.Root,{open:t,onOpenChange:n,children:(0,o.jsx)(ng.Portal,{children:(0,o.jsx)(nq.Menu.Positioner,{children:(0,o.jsx)(nq.Menu.Content,{fontSize:"0.85rem",position:"absolute",width:"250px",style:{left:`${i}px`,top:`${r}px`},children:0===e.length?(0,o.jsx)(nq.Menu.Item,{value:"no-action",disabled:!0,children:"No action available"},"no action"):e.map(({isSeparator:e,label:t,isDisabled:i,action:r,itemIcon:s})=>{if(e)return(0,o.jsx)(nq.Menu.Separator,{},t);{let e=(0,o.jsxs)(nq.Menu.Item,{value:String(t),disabled:i,onClick:()=>{r&&r(),n()},children:[s," ",t]},t);return i?(0,o.jsx)(nL.default,{display:"metadata only"===a.mode,children:e},t):e}})})})})})},n7=({isOpen:e,onClose:t,x:n,y:i,node:r})=>{let a=[],{selectParentNodes:s,selectChildNodes:l,getNodeColumnSet:d,selectMode:c,cll:u,showColumnLevelLineage:g}=(0,t5.useLineageViewContextSafe)(),{runAction:h}=(0,n2.useRecceActionContext)(),{featureToggles:p}=(0,nO.useRecceInstanceContext)(),{isActionAvailable:f}=(0,nf.useLineageGraphContext)(),{data:m}=(0,nm.useRecceServerFlag)(),{lineageGraph:x}=(0,nf.useLineageGraphContext)(),y=!x?.catalogMetadata.current,b=m?.single_env_onboarding??!1,w=p.disableDatabaseQuery,{primaryKey:C}=(0,n4.default)(r?.data?.data.name),{setSqlQuery:v,setPrimaryKeys:S}=(0,n3.useRecceQueryContext)(),[,j]=(0,n5.useAppLocation)();if(!r?.data)return(0,o.jsx)(o.Fragment,{});let _=r.data,k=_.resourceType,E=Array.from(d(r.id)),R={source:"lineage_model_node"};if("modified"===_.changeStatus&&a.push({label:"Show Impact Radius",itemIcon:(0,o.jsx)(t9.FaRegDotCircle,{}),isDisabled:y,action:()=>{g({node_id:r.id,change_analysis:!0,no_upstream:!0})}}),!c&&k&&["model","seed","snapshot"].includes(k)){a.length>0&&a.push({label:"select group one",isSeparator:!0});let e=(0,nR.findByRunType)(b?"query":"query_diff"),t=n1(Object.keys(_.data.base?.columns??{}),Object.keys(_.data.current?.columns??{})),n=`select * from {{ ref("${_.name}") }}`;if(t.length&&(n=`select 
  ${t.join("\n  ")}
from {{ ref("${_.name}") }}`),a.push({label:"Query",itemIcon:(0,o.jsx)(t8.Icon,{as:e.icon}),isDisabled:w,action:()=>{v(n),f("query_diff_with_primary_key")&&S(void 0!==C?[C]:void 0),j("/query")}}),E.length>0)if(void 0!==u){let t=new Set;C&&t.add(C),E.forEach(e=>{t.add(e)}),a.push({label:"Query Related Columns",itemIcon:(0,o.jsx)(t8.Icon,{as:e.icon}),isDisabled:w,action:()=>{v(`select 
  ${Array.from(t).join(",\n  ")}
from {{ ref("${_.name}") }}`),f("query_diff_with_primary_key")&&S(void 0!==C?[C]:void 0),j("/query")}})}else{let t=Object.entries(_.change?.columns??{}).filter(([,e])=>"modified"===e).map(([e])=>e);if(t.length>0){let n=new Set;C&&n.add(C),t.forEach(e=>{n.add(e)}),a.push({label:"Query Modified Columns",itemIcon:(0,o.jsx)(t8.Icon,{as:e.icon}),isDisabled:w,action:()=>{v(`select 
  ${Array.from(n).join(",\n  ")}
from {{ ref("${_.name}") }}`),f("query_diff_with_primary_key")&&S(void 0!==C?[C]:void 0),j("/query")}})}}let i=(0,nR.findByRunType)(b?"row_count":"row_count_diff");a.push({label:i.title,itemIcon:(0,o.jsx)(t8.Icon,{as:i.icon}),isDisabled:w,action:()=>{(0,nJ.trackExploreAction)({action:b?nJ.EXPLORE_ACTION.ROW_COUNT:nJ.EXPLORE_ACTION.ROW_COUNT_DIFF,source:nJ.EXPLORE_SOURCE.LINEAGE_VIEW_CONTEXT_MENU,node_count:1}),h(b?"row_count":"row_count_diff",{node_names:[_.name]},{showForm:!1,trackProps:R})}});let s=(0,nR.findByRunType)(b?"profile":"profile_diff");if(a.push({label:s.title,itemIcon:(0,o.jsx)(t8.Icon,{as:s.icon}),isDisabled:w,action:()=>{let e=Array.from(d(r.id));(0,nJ.trackExploreAction)({action:b?nJ.EXPLORE_ACTION.PROFILE:nJ.EXPLORE_ACTION.PROFILE_DIFF,source:nJ.EXPLORE_SOURCE.LINEAGE_VIEW_CONTEXT_MENU,node_count:1}),h(b?"profile":"profile_diff",{model:_.name,columns:e},{showForm:!0,trackProps:R})}}),!b){let e=(0,nR.findByRunType)("value_diff");a.push({label:e.title,itemIcon:(0,o.jsx)(t8.Icon,{as:e.icon}),isDisabled:w,action:()=>{let e=Array.from(d(r.id));(0,nJ.trackExploreAction)({action:nJ.EXPLORE_ACTION.VALUE_DIFF,source:nJ.EXPLORE_SOURCE.LINEAGE_VIEW_CONTEXT_MENU,node_count:1}),h("value_diff",{model:_.name,columns:e},{showForm:!0,trackProps:R})}})}}return b||(a.length>0&&a.push({label:"select group two",isSeparator:!0}),a.push({label:"Select Parent Nodes",itemIcon:(0,o.jsx)(nZ,{}),action:()=>{(0,nJ.trackLineageSelection)({action:nJ.LINEAGE_SELECTION_ACTION.SELECT_PARENT_NODES}),s(r.id,1)}}),a.push({label:"Select Child Nodes",itemIcon:(0,o.jsx)(nQ,{}),action:()=>{(0,nJ.trackLineageSelection)({action:nJ.LINEAGE_SELECTION_ACTION.SELECT_CHILD_NODES}),l(r.id,1)}}),a.push({label:"Select All Upstream Nodes",itemIcon:(0,o.jsx)(nZ,{}),action:()=>{(0,nJ.trackLineageSelection)({action:nJ.LINEAGE_SELECTION_ACTION.SELECT_ALL_UPSTREAM}),s(r.id)}}),a.push({label:"Select All Downstream Nodes",itemIcon:(0,o.jsx)(nQ,{}),action:()=>{(0,nJ.trackLineageSelection)({action:nJ.LINEAGE_SELECTION_ACTION.SELECT_ALL_DOWNSTREAM}),l(r.id)}})),(0,o.jsx)(n8,{x:n,y:i,menuItems:a,open:e,onClose:t})},n9=({isOpen:e,onClose:t,x:n,y:i,node:r})=>{let a=[],{runAction:s}=(0,n2.useRecceActionContext)(),{isActionAvailable:l}=(0,nf.useLineageGraphContext)(),{featureToggles:d}=(0,nO.useRecceInstanceContext)(),{data:c}=(0,nm.useRecceServerFlag)(),u=c?.single_env_onboarding??!1,g=d.disableDatabaseQuery;if(r?.data===void 0)return(0,o.jsx)(o.Fragment,{});let h=r.data,p=h.node,f=h.column,m=h.type,x={source:"lineage_column_node"},y=p.data.base?.columns?.[f]===void 0||p.data.current?.columns?.[f]===void 0,b=(0,nR.findByRunType)(u?"profile":"profile_diff");if(a.push({label:b.title,itemIcon:(0,o.jsx)(t8.Icon,{as:b.icon}),action:()=>{(0,nJ.trackExploreAction)({action:nJ.EXPLORE_ACTION.PROFILE_DIFF,source:nJ.EXPLORE_SOURCE.LINEAGE_VIEW_CONTEXT_MENU,node_count:1}),s("profile_diff",{model:p.name,columns:[f]},{showForm:!1,trackProps:x})},isDisabled:y||!l("profile_diff")||g}),!u){let e=(0,nR.findByRunType)("histogram_diff");a.push({label:e.title,itemIcon:(0,o.jsx)(t8.Icon,{as:e.icon}),action:()=>{(0,nJ.trackExploreAction)({action:nJ.EXPLORE_ACTION.HISTOGRAM_DIFF,source:nJ.EXPLORE_SOURCE.LINEAGE_VIEW_CONTEXT_MENU,node_count:1}),s("histogram_diff",{model:p.name,column_name:f,column_type:m},{showForm:!1,trackProps:x})},isDisabled:y||!m||!(0,n6.supportsHistogramDiff)(m)||g});let t=(0,nR.findByRunType)("top_k_diff");a.push({label:t.title,itemIcon:(0,o.jsx)(t8.Icon,{as:t.icon}),action:()=>{(0,nJ.trackExploreAction)({action:nJ.EXPLORE_ACTION.TOP_K_DIFF,source:nJ.EXPLORE_SOURCE.LINEAGE_VIEW_CONTEXT_MENU,node_count:1}),s("top_k_diff",{model:p.name,column_name:f,k:50},{showForm:!1,trackProps:x})},isDisabled:y||g});let n=(0,nR.findByRunType)("value_diff");a.push({label:n.title,itemIcon:(0,o.jsx)(t8.Icon,{as:n.icon}),action:()=>{(0,nJ.trackExploreAction)({action:nJ.EXPLORE_ACTION.VALUE_DIFF,source:nJ.EXPLORE_SOURCE.LINEAGE_VIEW_CONTEXT_MENU,node_count:1}),s("value_diff",{model:p.name,columns:[f]},{showForm:!0,trackProps:x})},isDisabled:y||g})}return(0,o.jsx)(n8,{x:n,y:i,menuItems:a,open:e,onClose:t})};e.s(["LineageViewContextMenu",0,({isOpen:e,onClose:t,x:n,y:i,node:r})=>{let{featureToggles:a}=(0,nO.useRecceInstanceContext)();return a.disableViewActionDropdown?(0,o.jsx)(n8,{menuItems:[],open:e,onClose:t,x:n,y:i}):r&&(0,nw.isLineageGraphNode)(r)?(0,o.jsx)(n7,{x:n,y:i,isOpen:e,onClose:t,node:r}):r&&(0,nw.isLineageGraphColumnNode)(r)?(0,o.jsx)(n9,{x:n,y:i,isOpen:e,onClose:t,node:r}):void 0},"useLineageViewContextMenu",0,()=>{let{open:e,onClose:t,onOpen:n}=(0,nY.useDisclosure)(),[o,r]=(0,i.useState)({x:0,y:0}),[a,s]=(0,i.useState)();return{props:{x:o.x,y:o.y,node:a,isOpen:e,onClose:t},showContextMenu:(e,t,o)=>{r({x:e,y:t}),s(o),n()},closeContextMenu:()=>{r({x:0,y:0}),s(void 0),t()}}}],739145);var oe=e.i(891728);let ot="recce",on={recommendationIgnored:`${ot}-recommendation-ignored`,recommendationShowed:`${ot}-recommendation-showed`,prevRefreshTimeStamp:`${ot}-prev-refresh-timestamp`,lineageNotificationDismissed:`${ot}-lineage-notification-dismissed`};function oo({notification:e,type:t}){let n=on.lineageNotificationDismissed,[r,a]=(0,i.useState)(()=>"true"!==sessionStorage.getItem(n));return null!==e&&r?(0,o.jsxs)(t6.Flex,{w:"100%",direction:"row",p:"5px 10px",gap:"5px",alignItems:"flex-start",borderRadius:"md",boxShadow:"md",border:"1px solid",borderColor:"gray.200",bg:{info:"blue.50",success:"green.50",warning:"yellow.50",error:"red.50"}[t],children:[e,(0,o.jsx)(ny.Spacer,{}),(0,o.jsx)(oe.CloseButton,{onClick:()=>{sessionStorage.setItem(n,"true"),a(!1)}})]}):null}e.s(["LineageViewNotification",()=>oo],428537);var oi=e.i(2936),or=e.i(389448),oa=e.i(455952),os=e.i(885411);let ol=()=>(0,o.jsxs)(t3.VStack,{align:"start",gap:0,children:[(0,o.jsx)(np.Text,{fontSize:"10pt",color:"gray.500",pb:1,children:"Select nodes by dbt node selector syntax"}),(0,o.jsxs)(np.Text,{fontSize:"8pt",children:[(0,o.jsx)(nc.Code,{fontSize:"8pt",children:"model_name"})," Select a node"]}),(0,o.jsxs)(np.Text,{fontSize:"8pt",children:[(0,o.jsx)(nc.Code,{fontSize:"8pt",children:"model_name+"})," Select downstream nodes"]}),(0,o.jsxs)(np.Text,{fontSize:"8pt",children:[(0,o.jsx)(nc.Code,{fontSize:"8pt",children:"+model_name"})," Select upstream nodes"]}),(0,o.jsxs)(np.Text,{fontSize:"8pt",children:[(0,o.jsx)(nc.Code,{fontSize:"8pt",children:"model*"})," Select by wildcard"]})]}),od=({isDisabled:e})=>{let{viewOptions:t,onViewOptionsChanged:n}=(0,t5.useLineageViewContextSafe)(),i=t.view_mode??"changed_models";return(0,o.jsxs)(nq.Menu.Root,{children:[(0,o.jsx)(nq.Menu.Trigger,{asChild:!0,children:(0,o.jsxs)(t2.Button,{minWidth:"100px",size:"2xs",variant:"outline",disabled:e,children:[(0,o.jsx)(t8.Icon,{as:ns("model").icon})," ","changed_models"===i?"Changed Models":"All"," ",(0,o.jsx)(nd.PiCaretDown,{})]})}),(0,o.jsx)(ng.Portal,{children:(0,o.jsx)(nq.Menu.Positioner,{children:(0,o.jsx)(nq.Menu.Content,{children:(0,o.jsxs)(nq.Menu.RadioItemGroup,{value:i,onValueChange:e=>{var o;o=e.value,n({...t,view_mode:o})},children:[(0,o.jsx)(nq.Menu.ItemGroupLabel,{children:"mode"}),(0,o.jsxs)(nq.Menu.RadioItem,{value:"changed_models",children:["Changed Models",(0,o.jsx)(nq.Menu.ItemIndicator,{})]}),(0,o.jsxs)(nq.Menu.RadioItem,{value:"all",children:["All",(0,o.jsx)(nq.Menu.ItemIndicator,{})]})]})})})})]})},oc=({isDisabled:e})=>{let{lineageGraph:t}=(0,nf.useLineageGraphContext)(),{viewOptions:n,onViewOptionsChanged:i}=(0,t5.useLineageViewContextSafe)(),r=new Set;for(let e of Object.values(t?.nodes??{}))e.data.packageName&&r.add(e.data.packageName);let a=t?.manifestMetadata.current?.project_name,s=n.packages?new Set(n.packages):a?new Set([a]):r,l=s.size===r.size,d=0===s.size,c=1===s.size?Array.from(s)[0]:l?"All Packages":d?"No Package":`${s.size} Packages`;return(0,o.jsxs)(nq.Menu.Root,{closeOnSelect:!1,children:[(0,o.jsx)(nq.Menu.Trigger,{asChild:!0,children:(0,o.jsxs)(t2.Button,{minWidth:"100px",size:"2xs",variant:"outline",disabled:e,children:[(0,o.jsx)(t8.Icon,{as:nT.FiPackage})," ",c," ",(0,o.jsx)(nd.PiCaretDown,{})]})}),(0,o.jsx)(ng.Portal,{children:(0,o.jsx)(nq.Menu.Positioner,{children:(0,o.jsx)(nq.Menu.Content,{children:(0,o.jsxs)(nq.Menu.ItemGroup,{children:[(0,o.jsx)(nq.Menu.ItemGroupLabel,{children:"Select Packages"}),(0,o.jsx)(nq.Menu.Item,{value:"",asChild:!0,children:(0,o.jsxs)(oa.Checkbox.Root,{checked:l||d?l:"indeterminate",onCheckedChange:()=>{l?i({...n,packages:[]}):i({...n,packages:Array.from(r)})},children:[(0,o.jsx)(oa.Checkbox.HiddenInput,{}),(0,o.jsx)(oa.Checkbox.Control,{}),(0,o.jsx)(oa.Checkbox.Label,{children:"Select All"})]})}),(0,o.jsx)(nq.Menu.Separator,{}),Array.from(r).map(e=>(0,o.jsx)(nq.Menu.Item,{value:e,children:(0,o.jsxs)(oa.Checkbox.Root,{checked:s.has(e),onCheckedChange:()=>{let t;(t=new Set(s)).has(e)?t.delete(e):t.add(e),i({...n,packages:Array.from(t)})},children:[(0,o.jsx)(oa.Checkbox.HiddenInput,{}),(0,o.jsx)(oa.Checkbox.Control,{}),(0,o.jsx)(oa.Checkbox.Label,{className:"no-track-pii-safe",children:e})]})},e))]})})})})]})},ou=e=>{let[t,n]=(0,i.useState)(e.value),{data:r}=(0,nm.useRecceServerFlag)(),a=(0,i.useRef)(null);return(0,i.useEffect)(()=>{a.current&&(a.current.value=e.value)},[e.value]),(0,o.jsx)(t7.Tooltip,{contentProps:{width:"300px",padding:2,shadow:"md",borderWidth:1,rounded:"md",color:"black",backgroundColor:"white"},content:e.tooltipComponent,positioning:{placement:"bottom-start"},closeOnClick:!1,disabled:!r?.single_env_onboarding,children:(0,o.jsx)(os.Input,{ref:a,height:"24px",fontSize:"10pt",placeholder:"with selectors",disabled:e.isDisabled,value:t,onChange:e=>{n(e.target.value)},onKeyUp:o=>{"Enter"===o.key?e.onChange(t):"Escape"===o.key&&(o.preventDefault(),n(e.value),a.current&&a.current.blur())},onBlur:()=>{n(e.value)}})})},og=({isDisabled:e})=>{let{viewOptions:t,onViewOptionsChanged:n}=(0,t5.useLineageViewContextSafe)();return(0,o.jsx)(ou,{isDisabled:e,value:t.select??"",onChange:e=>{n({...t,select:e||void 0})},tooltipComponent:(0,o.jsx)(ol,{})})},oh=({isDisabled:e})=>{let{viewOptions:t,onViewOptionsChanged:n}=(0,t5.useLineageViewContextSafe)();return(0,o.jsx)(ou,{isDisabled:e,value:t.exclude??"",onChange:e=>{n({...t,exclude:e||void 0})}})},op=e=>(0,o.jsxs)(t1.Box,{style:e.style,maxWidth:"300px",children:[(0,o.jsx)(t1.Box,{fontSize:"8pt",children:(e.label??"").trim()||(0,o.jsx)(o.Fragment,{children:""})}),e.children]});e.s(["LineageViewTopBar",0,()=>{let{deselect:e,focusedNode:t,selectedNodes:n,...i}=(0,t5.useLineageViewContextSafe)(),{featureToggles:r}=(0,nO.useRecceInstanceContext)(),{data:a}=(0,nm.useRecceServerFlag)(),s=a?.single_env_onboarding,l=n.length>0,d=!t&&!l;return(0,o.jsx)(t3.HStack,{width:"100%",padding:"4pt 8pt",children:(0,o.jsxs)(t3.HStack,{flex:"1",children:[(0,o.jsx)(oi.default,{}),(0,o.jsx)(op,{label:"Mode",style:{flexShrink:"1"},children:(0,o.jsx)(od,{isDisabled:l})}),(0,o.jsx)(op,{label:"Package",style:{flexShrink:"1"},children:(0,o.jsx)(oc,{isDisabled:l})}),(0,o.jsx)(op,{label:"Select",style:{flex:"100 1 auto"},children:(0,o.jsx)(og,{isDisabled:l})}),(0,o.jsx)(op,{label:"Exclude",style:{flex:"100 1 auto"},children:(0,o.jsx)(oh,{isDisabled:l})}),(0,o.jsx)(ny.Spacer,{}),l&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(op,{label:"",style:{flexShrink:"0"},children:(0,o.jsx)(np.Text,{fontSize:"9pt",color:"gray.500",children:n.length>1?`${n.length} nodes selected`:`${n.length} node selected`})}),(0,o.jsx)(op,{label:"",children:(0,o.jsx)(t2.Button,{variant:"outline",size:"2xs",fontSize:"9pt",onClick:()=>{e()},children:"Deselect"})}),s&&(0,o.jsx)(op,{label:"Explore",children:(0,o.jsx)(or.ButtonGroup,{attached:!0,variant:"outline",children:(0,o.jsxs)(nq.Menu.Root,{positioning:{placement:"bottom-end"},children:[(0,o.jsx)(nq.Menu.Trigger,{asChild:!0,children:(0,o.jsxs)(t2.Button,{size:"2xs",children:["Actions ",(0,o.jsx)(nd.PiCaretDown,{})]})}),(0,o.jsx)(ng.Portal,{children:(0,o.jsx)(nq.Menu.Positioner,{children:(0,o.jsx)(nq.Menu.Content,{children:(0,o.jsx)(nq.Menu.Item,{value:"row-count",disabled:r.disableDatabaseQuery,onClick:async()=>{await i.runRowCount()},children:(0,o.jsxs)(np.Text,{textStyle:"sm",children:[(0,o.jsx)(t8.Icon,{as:(0,nR.findByRunType)("row_count_diff").icon})," ","Row Count"]})})})})})]})})})]}),!s&&(0,o.jsx)(op,{label:"Explore",children:(0,o.jsx)(or.ButtonGroup,{attached:!0,variant:"outline",children:(0,o.jsxs)(nq.Menu.Root,{positioning:{placement:"bottom-end"},children:[(0,o.jsx)(nq.Menu.Trigger,{asChild:!0,children:(0,o.jsxs)(t2.Button,{size:"2xs",disabled:r.disableViewActionDropdown,children:["Actions ",(0,o.jsx)(nd.PiCaretDown,{})]})}),(0,o.jsx)(ng.Portal,{children:(0,o.jsx)(nq.Menu.Positioner,{children:(0,o.jsxs)(nq.Menu.Content,{children:[(0,o.jsxs)(nq.Menu.ItemGroup,{m:"0",p:"4px 12px",children:[(0,o.jsx)(nq.Menu.ItemGroupLabel,{children:"Diff"}),(0,o.jsx)(nL.default,{display:"metadata only"===r.mode,children:(0,o.jsx)(nq.Menu.Item,{value:"row-count-diff",disabled:r.disableDatabaseQuery,onClick:async()=>{await i.runRowCountDiff()},children:(0,o.jsxs)(np.Text,{textStyle:"sm",children:[(0,o.jsx)(t8.Icon,{as:(0,nR.findByRunType)("row_count_diff").icon})," ","Row Count Diff"]})})}),(0,o.jsx)(nL.default,{display:"metadata only"===r.mode,children:(0,o.jsx)(nq.Menu.Item,{value:"value-diff",disabled:r.disableDatabaseQuery,onClick:async()=>{await i.runValueDiff()},children:(0,o.jsxs)(np.Text,{textStyle:"sm",children:[(0,o.jsx)(t8.Icon,{as:(0,nR.findByRunType)("value_diff").icon})," ","Value Diff"]})})})]}),(0,o.jsx)(nq.Menu.Separator,{}),(0,o.jsxs)(nq.Menu.ItemGroup,{m:"0",px:"12px",children:[(0,o.jsx)(nq.Menu.ItemGroupLabel,{children:"Add to Checklist"}),(0,o.jsx)(nq.Menu.Item,{value:"lineage-diff",disabled:!(d||l&&n.length>1),onClick:()=>{i.addLineageDiffCheck(i.viewOptions.view_mode)},children:(0,o.jsxs)(np.Text,{textStyle:"sm",children:[(0,o.jsx)(t8.Icon,{as:(0,nR.findByRunType)("lineage_diff").icon})," ","Lineage Diff"]})}),(0,o.jsx)(nq.Menu.Item,{value:"schema-diff",disabled:!1,onClick:()=>{i.addSchemaDiffCheck()},children:(0,o.jsxs)(np.Text,{textStyle:"sm",children:[(0,o.jsx)(t8.Icon,{as:(0,nR.findByRunType)("schema_diff").icon})," ","Schema Diff"]})})]})]})})})]})})})]})})}],224779),e.s(["DisableTooltipMessages",0,{add_or_remove:"Unavailable for added or removed resources."}],765996);var of=e.i(542883);e.i(49931);var om=e.i(716396),ox=e.i(162234);let oy=(0,i.forwardRef)(function({base:e,current:t,enableScreenshot:n=!1,showMenu:r=!0},a){let s,l,d=(0,t5.useLineageViewContext)(),[c,u]=(0,i.useState)(new Map),{columns:g,rows:h}=(0,i.useMemo)(()=>{let n=t?.resource_type??e?.resource_type,o=n&&["model","seed","snapshot","source"].includes(n)?t??e:void 0;return(0,om.createDataGridFromData)({type:"schema_diff",base:e?.columns,current:t?.columns},{node:o,cllRunningMap:c,showMenu:r})},[e,t,c,r]),{lineageGraph:p}=(0,nf.useLineageGraphContext)(),f=!p?.catalogMetadata.base,m=!p?.catalogMetadata.current;f&&m?s="catalog.json not found on both environments. Run `recce debug` to troubleshoot.":f?s="catalog.json not found on base environment. Run `recce debug` to troubleshoot.":m&&(s="catalog.json not found on current environment. Run `recce debug` to troubleshoot.");let x=e&&void 0===e.columns,y=t&&void 0===t.columns;x&&y?l="catalog.json is outdated on both environments. Update catalog.json to get schema information.":x?l="catalog.json is outdated on base environment. Update catalog.json to get schema information.":y&&(l="catalog.json is outdated on current environment. Update catalog.json to get schema information.");let b=async n=>{(0,nJ.trackColumnLevelLineage)({action:"view",source:"schema_column"}),u(e=>new Map(e).set(n,!0));let o=t?.id??e?.id;o&&await d?.showColumnLevelLineage({node_id:o,column:n}),u(e=>new Map(e).set(n,!1))},w=d?.viewOptions.column_level_lineage,C=w?new Set([`${w.node_id}-${w.column}`]):new Set;return(0,o.jsxs)(t6.Flex,{direction:"column",children:[s?(0,o.jsxs)(of.Alert.Root,{status:"warning",fontSize:"12px",p:"8px",children:[(0,o.jsx)(of.Alert.Indicator,{}),(0,o.jsx)(of.Alert.Description,{children:s})]}):l?(0,o.jsxs)(of.Alert.Root,{status:"warning",fontSize:"12px",p:"8px",children:[(0,o.jsx)(of.Alert.Indicator,{}),(0,o.jsx)(of.Alert.Description,{children:l})]}):(0,o.jsx)(o.Fragment,{}),h.length>0&&(0,o.jsx)(ox.ScreenshotDataGrid,{style:{blockSize:"auto",maxHeight:"100%",overflow:"auto",fontSize:"0.8rem",borderWidth:1},columns:g,rows:h,rowHeight:35,renderers:{noRowsFallback:(0,o.jsx)(ox.EmptyRowsRenderer,{})},className:"rdg-light no-track-pii-safe",ref:a,rowKeyGetter:n=>{let o=t?.id??e?.id;return`${o}-${n.name}`},selectedRows:C,onSelectedRowsChange:()=>{},onCellClick:async e=>{(void 0===e.row.baseIndex||void 0!==e.row.currentIndex)&&await b(e.row.name)},rowClass:e=>{let t;if(void 0===e.baseIndex)t="row-added";else{if(void 0===e.currentIndex)return"row-removed";t="row-normal"}return void 0!==d&&(t+=" row-selectable"),t}})]})}),ob=(0,i.forwardRef)(function({current:e,showMenu:t=!0},n){let r,a,s=(0,t5.useLineageViewContext)(),[l,d]=(0,i.useState)(new Map),{columns:c,rows:u}=(0,i.useMemo)(()=>(0,om.createDataGridFromData)({type:"schema_single",columns:e?.columns},{node:e,cllRunningMap:l,showMenu:t}),[e,l,t]),{lineageGraph:g}=(0,nf.useLineageGraphContext)();g?.catalogMetadata.current||(r="catalog.json not found. Run `recce debug` to troubleshoot."),e&&void 0===e.columns&&(a="catalog.json is outdated. Update catalog.json to get schema information.");let h=async t=>{(0,nJ.trackColumnLevelLineage)({action:"view",source:"schema_column"}),d(e=>new Map(e).set(t,!0));let n=e?.id;n&&await s?.showColumnLevelLineage({node_id:n,column:t}),d(e=>new Map(e).set(t,!1))},p=s?.viewOptions.column_level_lineage,f=p?new Set([`${p.node_id}-${p.column}`]):new Set;return(0,o.jsxs)(t6.Flex,{direction:"column",children:[r?(0,o.jsxs)(of.Alert.Root,{status:"warning",fontSize:"12px",p:"8px",children:[(0,o.jsx)(of.Alert.Indicator,{}),(0,o.jsx)(of.Alert.Description,{children:r})]}):a?(0,o.jsxs)(of.Alert.Root,{status:"warning",fontSize:"12px",p:"8px",children:[(0,o.jsx)(of.Alert.Indicator,{}),(0,o.jsx)(of.Alert.Description,{children:a})]}):(0,o.jsx)(o.Fragment,{}),u.length>0&&(0,o.jsx)(ox.ScreenshotDataGrid,{style:{blockSize:"auto",maxHeight:"100%",overflow:"auto",fontSize:"10pt",borderWidth:1},columns:c,rows:u,renderers:{noRowsFallback:(0,o.jsx)(ox.EmptyRowsRenderer,{})},className:"rdg-light",ref:n,rowKeyGetter:t=>{let n=e?.id;return`${n}-${t.name}`},selectedRows:f,onSelectedRowsChange:()=>{},onCellClick:async e=>{await h(e.row.name)},rowClass:()=>void 0!==s?"row-normal row-selectable":"row-normal"})]})});e.s(["SchemaView",0,oy,"SingleEnvSchemaView",0,ob],637418),e.i(909139);var ow=e.i(750060),oC=e.i(113145),ov=e.i(234651);e.s(["NodeSqlView",0,({node:e})=>{let{open:t,onOpen:n,onClose:r}=(0,nY.useDisclosure)(),[a,s]=(0,i.useState)(!1),{data:l,isLoading:d}=(0,nm.useRecceServerFlag)(),c=l?.single_env_onboarding;if(d)return(0,o.jsx)(o.Fragment,{});if("model"!==e.data.resourceType&&"snapshot"!==e.data.resourceType)return"Not available";let u=e.data.data.base?.raw_code,g=e.data.data.current?.raw_code,h=e.data.data.base?.name??e.data.data.current?.name??"";return(0,o.jsxs)(t1.Box,{className:"no-track-pii-safe",style:{position:"relative"},height:"100%",onMouseEnter:()=>{s(!0)},onMouseLeave:()=>{s(!1)},children:[c?(0,o.jsx)(ow.CodeEditor,{language:"sql",value:u??"",readOnly:!0,lineNumbers:!0,wordWrap:!1}):(0,o.jsx)(oC.DiffEditor,{original:u??"",modified:g??"",language:"sql",readOnly:!0,lineNumbers:!0,sideBySide:!1,height:"100%"}),(0,o.jsx)(nu.IconButton,{onClick:n,size:"md","aria-label":"Expand",variant:"ghost",style:{position:"absolute",top:"5px",right:"20px",opacity:a?.5:.1,transition:"opacity 0.3s ease-in-out"},children:(0,o.jsx)(t9.FaExpandArrowsAlt,{})}),(0,o.jsx)(ov.Dialog.Root,{open:t,onOpenChange:r,size:"xl",children:(0,o.jsxs)(ng.Portal,{children:[(0,o.jsx)(ov.Dialog.Backdrop,{}),(0,o.jsx)(ov.Dialog.Positioner,{children:(0,o.jsxs)(ov.Dialog.Content,{overflowY:"auto",height:"75%",children:[(0,o.jsxs)(ov.Dialog.Header,{children:[c?(0,o.jsxs)(ov.Dialog.Title,{children:[(0,o.jsx)("code",{children:h})," Model Code"]}):(0,o.jsxs)(ov.Dialog.Title,{children:[(0,o.jsx)("code",{children:h})," Model Code Diff"]}),(0,o.jsx)(ov.Dialog.CloseTrigger,{asChild:!0,children:(0,o.jsx)(oe.CloseButton,{size:"sm"})})]}),(0,o.jsx)(ov.Dialog.Body,{children:c?(0,o.jsx)(ow.CodeEditor,{language:"sql",value:u??"",fontSize:16,readOnly:!0,lineNumbers:!0,wordWrap:!1}):(0,o.jsx)(oC.DiffEditor,{original:u??"",modified:g??"",language:"sql",className:"text-base"})})]})})]})})]})}],634513)},302061,e=>{"use strict";var t=e.i(19483),n=e.i(918132),o=e.i(292002),i=e.i(187725);e.i(715841);var r=e.i(667828),a=e.i(415790),s=e.i(138920),l=e.i(625961),d=e.i(731645),c=e.i(336567),u=e.i(539579),g=e.i(255677),h=e.i(523043),p=e.i(130209),f=e.i(838208),m=e.i(84723),x=e.i(377855),y=e.i(953131),b=e.i(323194),w=e.i(987923),C=e.i(2216),v=e.i(203158),S=e.i(862754),j=e.i(916955),_=e.i(29134),k=e.i(912007),E=e.i(224882),R=e.i(505251),N=e.i(453330),I=e.i(269324),M=e.i(435843),T=e.i(525519),D=e.i(88515),L=e.i(166598),P=e.i(632951),O=e.i(904451),A=e.i(676502),z=e.i(592355),B=e.i(81167),F=e.i(187726),V=e.i(739145),$=e.i(428537),H=e.i(224779),G=e.i(388797),U=e.i(913369),X=e.i(891728),W=e.i(610186),K=e.i(218031),Z=e.i(601272),Q=e.i(911288),q=e.i(56606),Y=e.i(81551),J=e.i(453929);e.i(134115);var ee=e.i(940999),et=e.i(765996),en=e.i(832421),eo=e.i(475119),ei=e.i(400905),er=e.i(727653),ea=e.i(372230),es=e.i(637418),el=e.i(634513),ed=e.i(636819),ec=e.i(581435),eu=e.i(955343);function eg(e){return(0,eu.GenIcon)({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 472a40 40 0 1 0 80 0 40 40 0 1 0-80 0zm367 352.9L696.3 352V178H768v-68H256v68h71.7v174L145 824.9c-2.8 7.4-4.3 15.2-4.3 23.1 0 35.3 28.7 64 64 64h614.6c7.9 0 15.7-1.5 23.1-4.3 33-12.7 49.4-49.8 36.6-82.8zM395.7 364.7V180h232.6v184.7L719.2 600c-20.7-5.3-42.1-8-63.9-8-61.2 0-119.2 21.5-165.3 60a188.78 188.78 0 0 1-121.3 43.9c-32.7 0-64.1-8.3-91.8-23.7l118.8-307.5zM210.5 844l41.7-107.8c35.7 18.1 75.4 27.8 116.6 27.8 61.2 0 119.2-21.5 165.3-60 33.9-28.2 76.3-43.9 121.3-43.9 35 0 68.4 9.5 97.6 27.1L813.5 844h-603z"},child:[]}]})(e)}var eh=e.i(224378);e.i(909139);var ep=e.i(113145),ef=e.i(100377),em=e.i(234651),ex=e.i(653491),ey=e.i(437356),eb=e.i(507524),ew=e.i(638337),eC=e.i(461566),ev=e.i(901407),eS=e.i(489622);function ej({description:e,onLike:n,onDislike:o,onClickLink:i,externalLink:r,externalLinkText:a}){return(0,t.jsxs)(l.Flex,{gap:4,justifyContent:"center",alignContent:"center",alignItems:"center",children:[e,(0,t.jsx)(ex.IconButton,{"aria-label":"thumbs up",variant:"ghost",width:"32px",height:"32px",onClick:n,children:(0,t.jsx)(ey.Image,{src:"/imgs/feedback/thumbs-up.png",alt:"like"})}),(0,t.jsx)(ex.IconButton,{"aria-label":"thumbs down",variant:"ghost",width:"32px",height:"32px",onClick:o,children:(0,t.jsx)(ey.Image,{src:"/imgs/feedback/thumbs-down.png",alt:"dislike"})}),r&&a&&(0,t.jsxs)(eS.Link,{href:r,target:"_blank",textDecoration:"underline",onClick:i,children:[a," ",(0,t.jsx)(ev.LuExternalLink,{})]})]})}var e_=e.i(286568),ek=e.i(65089),eE=e.i(182809),eR=e.i(170660);function eN({current:e,primaryKeys:n,setPrimaryKeys:o,onRunResultOpen:i,runQuery:s,isPending:c}){return(0,t.jsxs)(l.Flex,{justifyContent:"right",alignItems:"center",padding:"4pt 8pt",gap:"5px",height:"54px",borderBottom:"1px solid lightgray",flex:"0 0 54px",children:[(0,t.jsxs)(r.Box,{children:[(0,t.jsxs)(K.Heading,{as:"h2",size:"md",display:"flex",alignItems:"center",gap:"5px",children:[(0,t.jsx)(d.Icon,{as:eg,boxSize:"1.2em"}),"Sandbox"]}),(0,t.jsxs)(g.Text,{fontSize:"xs",color:"gray.500",children:["Compare the run results based on the modified SQL code of model"," ",(0,t.jsx)("b",{children:e?.name})]})]}),(0,t.jsx)(q.Spacer,{}),(0,t.jsx)(eE.QueryForm,{defaultPrimaryKeys:n,onPrimaryKeysChange:o}),(0,t.jsx)(ee.Tooltip,{content:"Run diff to see the changes",children:(0,t.jsx)(a.Button,{size:"xs",marginTop:"16px",fontSize:"14px",onClick:()=>{i(),s()},colorPalette:"blue",loading:c,children:"Run Diff"})})]})}function eI({currentModelID:e,height:n="32px",flex:o="0 0 auto"}){let{lineageGraph:i,envInfo:r}=(0,j.useLineageGraphContext)(),a="0 16px",s=(0,ek.formatTimestamp)(r?.dbt?.current?.generated_at??""),d=(0,ec.formatDistanceToNow)(s,{addSuffix:!0}),c="N/A";if(i?.nodes[e]){let t=i.nodes[e];t.data.data.current?.schema&&(c=t.data.data.current.schema)}return(0,t.jsxs)(l.Flex,{gap:0,height:n,flex:o,fontSize:"14px",align:"center",margin:"0",backgroundColor:"#EDF2F880",children:[(0,t.jsx)(u.Stack,{width:"50%",children:(0,t.jsxs)(g.Text,{as:"b",margin:a,children:["ORIGINAL (Schema: ",c,", Last Updated: ",d,")"]})}),(0,t.jsx)(u.Stack,{width:"50%",children:(0,t.jsx)(g.Text,{as:"b",margin:a,children:"SANDBOX EDITOR"})})]})}function eM({current:e,onChange:n}){return(0,t.jsx)(ep.DiffEditor,{original:e?.raw_code??"",modified:e?.raw_code??"",language:"sql",readOnly:!1,lineNumbers:!0,sideBySide:!0,height:"100%",onModifiedChange:n})}function eT({isOpen:e,onClose:n,current:o}){let{open:a,onClose:s,onOpen:d}=(0,J.useDisclosure)(),[c,g]=(0,i.useState)(o?.raw_code??""),[h,f]=(0,i.useState)(e),{showRunId:m,clearRunResult:y}=(0,_.useRecceActionContext)(),{primaryKeys:b,setPrimaryKeys:w}=(0,eo.useRecceQueryContext)(),{data:C,isLoading:S}=(0,e_.useRecceServerFlag)(),j=async()=>{let e=eb.submitQueryDiff,t={current_model:o?.name??"",primary_keys:b,sql_template:c},{run_id:n}=await e(t,{nowait:!0});return m(n),await (0,eC.waitRun)(n)},{mutate:k,isPending:E}=(0,p.useMutation)({mutationFn:j,onSuccess(e){e.error?(0,v.trackPreviewChange)({action:"run",node:o?.name,status:"failure"}):((0,v.trackPreviewChange)({action:"run",node:o?.name,status:"success"}),setTimeout(()=>{R()},1e3),!S&&C?.single_env_onboarding&&setTimeout(()=>{I()},2e3))}}),{feedbackToast:R,closeToast:N}=function(e){let{feedbackId:n,description:o,onFeedbackSubmit:r,externalLink:a,externalLinkText:s}=e,[l,d]=(0,i.useState)(void 0);return{feedbackToast:function(e=!1){let i=localStorage.getItem(n);null!=l||("true"!==i||e)&&d(x.toaster.create({id:n,duration:void 0,type:"success",description:(0,t.jsx)(u.HStack,{children:(0,t.jsx)(ej,{description:o,onLike:()=>{r("like"),x.toaster.dismiss(n),localStorage.setItem(n,"true")},onDislike:()=>{r("dislike"),x.toaster.dismiss(n),localStorage.setItem(n,"true")},externalLink:a,externalLinkText:s,onClickLink:()=>{r("link")}})})}))},closeToast:()=>{l&&x.toaster.dismiss(l)}}}({feedbackId:ew.localStorageKeys.previewChangeFeedbackID,description:"Enjoy preview change?",onFeedbackSubmit:e=>{switch(e){case"like":(0,v.trackPreviewChangeFeedback)({feedback:"like",node:o?.name});break;case"dislike":(0,v.trackPreviewChangeFeedback)({feedback:"dislike",node:o?.name});break;case"link":(0,v.trackPreviewChangeFeedback)({feedback:"form",node:o?.name});break;default:console.log("Not support feedback type")}},externalLink:"https://docs.google.com/forms/d/e/1FAIpQLSd7Lei7Ijwo7MinWaI0K6rzZi_21gV1BKetmiNEX254kDziDA/viewform?usp=header",externalLinkText:"Give us feedback"}),{guideToast:I,closeGuideToast:T}=function(e){let[t,n]=(0,i.useState)(void 0),{guideId:o,description:r,externalLinkText:a,onExternalLinkClick:s}=e;return{guideToast:function(){null==t&&n(x.toaster.create({id:o,duration:3e3,type:"success",description:r,action:{label:a??"link",onClick:()=>{s&&s()}}}))},closeGuideToast:()=>{t&&x.toaster.dismiss(t)}}}({guideId:ew.localStorageKeys.prepareEnvGuideID,description:"Want to compare data changes with production data?",externalLink:"https://docs.datarecce.io/get-started/#prepare-dbt-artifacts",externalLinkText:"Learn how.",onExternalLinkClick:()=>{(0,v.trackSingleEnvironment)({action:"external_link",from:"preview_changes",node:o?.name})}});return e!==h&&(f(e),e&&g(o?.raw_code??"")),(0,t.jsx)(em.Dialog.Root,{open:e,size:"cover",onOpenChange:()=>{n(),s(),y(),N(),T(),(0,v.trackPreviewChange)({action:"close",node:o?.name})},children:(0,t.jsxs)(Q.Portal,{children:[(0,t.jsx)(em.Dialog.Backdrop,{}),(0,t.jsx)(em.Dialog.Positioner,{children:(0,t.jsxs)(em.Dialog.Content,{height:"100%",children:[(0,t.jsxs)(em.Dialog.Header,{height:"40px",bg:"rgb(77, 209, 176)",px:0,py:4,children:[(0,t.jsxs)(l.Flex,{alignItems:"center",height:"100%",gap:"10px",children:[(0,t.jsx)(ey.Image,{boxSize:"20px",ml:"18px",src:"/logo/recce-logo-white.png",alt:"recce-logo-white"}),(0,t.jsx)(em.Dialog.Title,{as:"h1",fontFamily:'"Montserrat", sans-serif',fontSize:"lg",color:"white",children:"RECCE"}),(0,t.jsx)(ef.Badge,{fontSize:"sm",color:"white/80",variant:"outline",children:"Experiment"})]}),(0,t.jsx)(em.Dialog.CloseTrigger,{asChild:!0,children:(0,t.jsx)(X.CloseButton,{size:"sm"})})]}),(0,t.jsx)(em.Dialog.Body,{p:0,children:(0,t.jsxs)(M.VSplit,{sizes:a?[50,50]:[100,0],minSize:100*!!a,gutterSize:5*!!a,style:{flex:"1",contain:"size",height:"100%"},children:[(0,t.jsxs)(l.Flex,{direction:"column",height:"100%",m:0,p:0,children:[(0,t.jsx)(eN,{current:o,primaryKeys:b??[],setPrimaryKeys:w,onRunResultOpen:d,runQuery:k,isPending:E}),(0,t.jsx)(eI,{height:"32pxs",flex:"0 0 auto",currentModelID:o?.id??""}),(0,t.jsx)(eM,{current:o,onChange:g})]}),a?(0,t.jsx)(eR.RunResultPane,{onClose:s,disableAddToChecklist:!0}):(0,t.jsx)(r.Box,{})]})}),(0,t.jsx)(r.Box,{position:"fixed",bottom:"4",right:"4",opacity:.5,children:(0,t.jsx)(ee.Tooltip,{content:"Give us feedback",children:(0,t.jsx)(ex.IconButton,{"aria-label":"feedback",variant:"ghost",size:"md",onClick:()=>{R(!0)},children:(0,t.jsx)(eh.VscFeedback,{})})})})]})})]})})}function eD({node:e,onCloseNode:n}){let o="model"===e.data.resourceType||"seed"===e.data.resourceType||"source"===e.data.resourceType||"snapshot"===e.data.resourceType,{open:i,onOpen:a,onClose:s}=(0,J.useDisclosure)(),{open:l,onClose:d}=(0,J.useDisclosure)({defaultOpen:!0}),{runAction:c}=(0,_.useRecceActionContext)(),{isActionAvailable:h}=(0,j.useLineageGraphContext)(),p=()=>{(0,v.trackExploreAction)({action:v.EXPLORE_ACTION.ROW_COUNT,source:v.EXPLORE_SOURCE.SCHEMA_ROW_COUNT_BUTTON,node_count:1}),c("row_count",{node_names:[e.data.name]},{showForm:!1,showLast:!1})},f=()=>{(0,v.trackExploreAction)({action:v.EXPLORE_ACTION.ROW_COUNT_DIFF,source:v.EXPLORE_SOURCE.SCHEMA_ROW_COUNT_BUTTON,node_count:1}),c("row_count_diff",{node_names:[e.data.name]},{showForm:!1,showLast:!1})},{singleEnv:m}=(0,k.useRecceInstanceContext)(),x=(e,t)=>e?et.DisableTooltipMessages.add_or_remove:h(t)?"":"This action is not supported yet.",y=Object.keys(e.data.data.base?.columns??{}),b=Object.keys(e.data.data.current?.columns??{});return(0,t.jsxs)(W.Grid,{height:"100%",templateRows:"auto auto 1fr",children:[(0,t.jsxs)(u.HStack,{children:[(0,t.jsx)(r.Box,{flex:"0 1 20%",p:"16px",children:(0,t.jsx)(K.Heading,{size:"sm",className:"no-track-pii-safe",children:e.data.name})}),(0,t.jsx)(q.Spacer,{}),m?(0,t.jsx)(eL,{node:e,baseColumns:y,currentColumns:b,refetchRowCount:p,disableReason:x}):(0,t.jsx)(eP,{node:e,baseColumns:y,currentColumns:b,disableReason:x,refetchRowCountDiff:f,onSandboxOpen:a}),(0,t.jsx)(r.Box,{flex:"0 1 1%",children:(0,t.jsx)(X.CloseButton,{size:"2xs",onClick:n})})]}),(0,t.jsx)(r.Box,{color:"gray",paddingLeft:"16px",children:(0,t.jsxs)(u.HStack,{gap:"8px",children:[(0,t.jsx)(ed.ResourceTypeTag,{node:e}),("model"===e.data.resourceType||"snapshot"===e.data.resourceType||"seed"===e.data.resourceType)&&(m?(0,t.jsx)(ed.RowCountTag,{node:e,onRefresh:p}):(0,t.jsx)(ed.RowCountDiffTag,{node:e,onRefresh:f}))]})}),o&&(0,t.jsxs)(Y.Tabs.Root,{defaultValue:"columns",overflow:"auto",children:[m&&l&&(0,t.jsx)(r.Box,{p:"12px",children:(0,t.jsx)(er.RecceNotification,{onClose:d,align:"flex-start",children:(0,t.jsxs)(g.Text,{children:["Enable the Recce Checklist and start adding checks for better data validation and review.",(0,t.jsx)("br",{}),(0,t.jsx)(er.LearnHowLink,{})]})})}),(0,t.jsxs)(Y.Tabs.List,{children:[(0,t.jsx)(Y.Tabs.Trigger,{value:"columns",children:"Columns"}),(0,t.jsx)(Y.Tabs.Trigger,{value:"code",children:"Code"})]}),(0,t.jsxs)(Y.Tabs.ContentGroup,{overflow:"auto",height:"calc(100% - 42px)",children:[(0,t.jsx)(Y.Tabs.Content,{value:"columns",p:0,overflowY:"auto",height:"100%",children:m?(0,t.jsx)(es.SingleEnvSchemaView,{current:e.data.data.current}):(0,t.jsx)(es.SchemaView,{base:e.data.data.base,current:e.data.data.current})}),(0,t.jsx)(Y.Tabs.Content,{value:"code",height:"100%",p:0,children:(0,t.jsx)(el.NodeSqlView,{node:e})})]})]}),(0,t.jsx)(eT,{isOpen:i,onClose:s,current:e.data.data.current})]})}function eL({node:e,baseColumns:n,currentColumns:o,refetchRowCount:i,disableReason:r}){let[,s]=(0,R.useAppLocation)(),{setSqlQuery:l}=(0,eo.useRecceQueryContext)(),{runAction:c}=(0,_.useRecceActionContext)(),{envInfo:u}=(0,j.useLineageGraphContext)(),g="added"===e.data.changeStatus||"removed"===e.data.changeStatus,h=(0,en.formatSelectColumns)(n,o),p=`select * from {{ ref("${e.data.name}") }}`;return(h.length&&(p=`select 
  ${h.join("\n  ")}
from {{ ref("${e.data.name}") }}`),"model"===e.data.resourceType||"seed"===e.data.resourceType||"snapshot"===e.data.resourceType)?(0,t.jsxs)(Z.Menu.Root,{children:[(0,t.jsx)(Z.Menu.Trigger,{asChild:!0,children:(0,t.jsxs)(a.Button,{size:"xs",variant:"outline",children:["Explore ",(0,t.jsx)(G.PiCaretDown,{})]})}),(0,t.jsx)(Q.Portal,{children:(0,t.jsx)(Z.Menu.Positioner,{children:(0,t.jsxs)(Z.Menu.Content,{children:[(0,t.jsxs)(Z.Menu.Item,{value:"label",fontSize:"14px",onClick:()=>{u?.adapterType==="dbt"?l(p):u?.adapterType==="sqlmesh"&&l(`select * from ${e.data.name}`),s("/query")},children:[(0,t.jsx)(d.Icon,{as:(0,ea.findByRunType)("query").icon})," Query"]}),(0,t.jsxs)(Z.Menu.Item,{value:"row-count",fontSize:"14px",onClick:()=>{i()},children:[(0,t.jsx)(d.Icon,{as:(0,ea.findByRunType)("row_count").icon})," Row Count"]}),(0,t.jsx)(ee.Tooltip,{content:r(g,"profile"),positioning:{placement:"left"},children:(0,t.jsxs)(Z.Menu.Item,{value:"profile",fontSize:"14px",disabled:g,onClick:()=>{(0,v.trackExploreAction)({action:v.EXPLORE_ACTION.PROFILE,source:v.EXPLORE_SOURCE.NODE_SIDEBAR_SINGLE_ENV,node_count:1}),c("profile",{model:e.data.name},{showForm:!0,showLast:!1})},children:[(0,t.jsx)(d.Icon,{as:(0,ea.findByRunType)("profile").icon})," Profile"]})})]})})})]}):(0,t.jsx)(t.Fragment,{})}function eP({node:e,baseColumns:n,currentColumns:o,disableReason:r,onSandboxOpen:s,refetchRowCountDiff:l}){let[,c]=(0,R.useAppLocation)(),{runAction:u}=(0,_.useRecceActionContext)(),{setSqlQuery:g,setPrimaryKeys:h}=(0,eo.useRecceQueryContext)(),{envInfo:p,isActionAvailable:f}=(0,j.useLineageGraphContext)(),{featureToggles:m}=(0,k.useRecceInstanceContext)(),{primaryKey:x}=(0,ei.default)(e.data.name),y="metadata only"===m.mode,b="added"===e.data.changeStatus||"removed"===e.data.changeStatus,C=(0,i.useCallback)(async()=>{let t=e.id,n=await (0,w.createSchemaDiffCheck)({node_id:t});c(`/checks/?id=${n.check_id}`)},[e,c]),S=(0,en.formatSelectColumns)(n,o),E=`select * from {{ ref("${e.data.name}") }}`;S.length&&(E=`select 
  ${S.join("\n  ")}
from {{ ref("${e.data.name}") }}`);let N=(e,n)=>{if(y)return(0,t.jsx)(U.default,{display:!0,children:e});let o=r(b,n);return(0,t.jsx)(ee.Tooltip,{disabled:""===o,content:o,positioning:{placement:"left"},children:e})};return"model"===e.data.resourceType||"seed"===e.data.resourceType||"snapshot"===e.data.resourceType?(0,t.jsxs)(Z.Menu.Root,{children:[(0,t.jsx)(Z.Menu.Trigger,{asChild:!0,children:(0,t.jsxs)(a.Button,{size:"2xs",variant:"outline",disabled:m.disableNodeActionDropdown,children:["Explore ",(0,t.jsx)(G.PiCaretDown,{})]})}),(0,t.jsx)(Q.Portal,{children:(0,t.jsx)(Z.Menu.Positioner,{children:(0,t.jsxs)(Z.Menu.Content,{children:[(0,t.jsx)(U.default,{display:y,children:(0,t.jsxs)(Z.Menu.Item,{value:"query",fontSize:"14px",disabled:m.disableDatabaseQuery,onClick:()=>{p?.adapterType==="dbt"?g(E):p?.adapterType==="sqlmesh"&&g(`select * from ${e.data.name}`),f("query_diff_with_primary_key")&&h(void 0!==x?[x]:void 0),c("/query")},children:[(0,t.jsx)(d.Icon,{as:(0,ea.findByRunType)("query_diff").icon})," Query"]})}),(0,t.jsx)(U.default,{display:y,children:(0,t.jsxs)(Z.Menu.Item,{value:"sandbox",fontSize:"14px",disabled:m.disableDatabaseQuery,onClick:()=>{f("query_diff_with_primary_key")&&h(void 0!==x?[x]:void 0),s(),(0,v.trackPreviewChange)({action:"explore",node:e.data.name})},children:[(0,t.jsx)(d.Icon,{as:(0,ea.findByRunType)("sandbox").icon})," Sandbox (Experiment)"]})}),(0,t.jsx)(Z.Menu.Separator,{}),(0,t.jsxs)(Z.Menu.ItemGroup,{m:"0",p:"0",children:[(0,t.jsx)(Z.Menu.ItemGroupLabel,{children:"Diff"}),(0,t.jsx)(U.default,{display:y,children:(0,t.jsxs)(Z.Menu.Item,{value:"row-count-diff",fontSize:"14px",disabled:m.disableDatabaseQuery,onClick:()=>{l()},children:[(0,t.jsx)(d.Icon,{as:(0,ea.findByRunType)("row_count_diff").icon})," Row Count Diff"]})}),N((0,t.jsxs)(Z.Menu.Item,{value:"profile-diff",fontSize:"14px",disabled:b||m.disableDatabaseQuery,onClick:()=>{(0,v.trackExploreAction)({action:v.EXPLORE_ACTION.PROFILE_DIFF,source:v.EXPLORE_SOURCE.NODE_SIDEBAR_MULTI_ENV,node_count:1}),u("profile_diff",{model:e.data.name},{showForm:!0,showLast:!1})},children:[(0,t.jsx)(d.Icon,{as:(0,ea.findByRunType)("profile_diff").icon})," Profile Diff"]}),"profile_diff"),N((0,t.jsxs)(Z.Menu.Item,{value:"value-diff",fontSize:"14px",disabled:b||m.disableDatabaseQuery,onClick:()=>{(0,v.trackExploreAction)({action:v.EXPLORE_ACTION.VALUE_DIFF,source:v.EXPLORE_SOURCE.NODE_SIDEBAR_MULTI_ENV,node_count:1}),u("value_diff",{model:e.data.name},{showForm:!0,showLast:!1})},children:[(0,t.jsx)(d.Icon,{as:(0,ea.findByRunType)("value_diff").icon})," Value Diff"]}),"value_diff"),N((0,t.jsxs)(Z.Menu.Item,{value:"top-k-diff",fontSize:"14px",disabled:b||m.disableDatabaseQuery,onClick:()=>{(0,v.trackExploreAction)({action:v.EXPLORE_ACTION.TOP_K_DIFF,source:v.EXPLORE_SOURCE.NODE_SIDEBAR_MULTI_ENV,node_count:1}),u("top_k_diff",{model:e.data.name,column_name:"",k:50},{showForm:!0})},children:[(0,t.jsx)(d.Icon,{as:(0,ea.findByRunType)("top_k_diff").icon})," Top-K Diff"]}),"top_k_diff"),N((0,t.jsxs)(Z.Menu.Item,{value:"histogram-diff",fontSize:"14px",disabled:b||m.disableDatabaseQuery,onClick:()=>{(0,v.trackExploreAction)({action:v.EXPLORE_ACTION.HISTOGRAM_DIFF,source:v.EXPLORE_SOURCE.NODE_SIDEBAR_MULTI_ENV,node_count:1}),u("histogram_diff",{model:e.data.name,column_name:"",column_type:""},{showForm:!0})},children:[(0,t.jsx)(d.Icon,{as:(0,ea.findByRunType)("histogram_diff").icon})," Histogram Diff"]}),"histogram_diff")]}),(0,t.jsx)(Z.Menu.Separator,{}),(0,t.jsxs)(Z.Menu.ItemGroup,{m:"0",p:"4px 12px",children:[(0,t.jsx)(Z.Menu.ItemGroupLabel,{children:"Add to Checklist"}),(0,t.jsxs)(Z.Menu.Item,{value:"schema-diff",fontSize:"14px",onClick:()=>{C()},children:[(0,t.jsx)(d.Icon,{as:(0,ea.findByRunType)("schema_diff").icon})," Schema Diff"]})]})]})})})]}):(0,t.jsx)(t.Fragment,{})}var eO=e.i(333207),eA=e.i(407101),ez=e.i(109624),eB=e.i(373921);function eF(){let{featureToggles:e}=(0,k.useRecceInstanceContext)(),{data:n}=(0,eO.useQuery)({queryKey:eA.cacheKeys.instanceInfo(),queryFn:ez.getRecceInstanceInfo});return"metadata only"!==e.mode?null:(0,t.jsx)("div",{className:"flex items-center w-full px-2 py-0.5 bg-cyan-50",children:(0,t.jsxs)(u.HStack,{flex:"1",fontSize:"sm",color:"cyan.600",children:[(0,t.jsx)(G.PiInfo,{}),(0,t.jsx)(g.Text,{children:"Query functions disabled without a data warehouse connection."}),(0,t.jsx)(a.Button,{bgColor:"iochmara.400",size:"2xs",onClick:()=>{window.open((0,eB.getSettingsUrl)(n),"_blank")},children:"Connect to Data Warehouse"})]})})}var eV=e.i(783586),e$=e.i(248859);let eH={mode:"per_node",status:"pending",completed:0,total:0,actions:{}},eG=function(){let{open:e,onOpen:n,onClose:o}=(0,J.useDisclosure)(),[s,d]=(0,i.useState)(0),[c,u]=(0,i.useState)(),g=(0,i.useRef)(null),h=(0,i.useCallback)(e=>(d(e),new Promise(e=>{u(()=>e),n()})),[n]),p=()=>{(0,v.trackExploreActionForm)({action:v.EXPLORE_ACTION.VALUE_DIFF,event:v.EXPLORE_FORM_EVENT.CANCEL}),c?.(!1),o()};return{confirm:h,AlertDialog:(0,t.jsx)(em.Dialog.Root,{size:"xl",open:e,role:"alertdialog",initialFocusEl:()=>g.current,onOpenChange:p,children:(0,t.jsxs)(Q.Portal,{children:[(0,t.jsx)(em.Dialog.Backdrop,{}),(0,t.jsx)(em.Dialog.Positioner,{children:(0,t.jsxs)(em.Dialog.Content,{children:[(0,t.jsx)(em.Dialog.Header,{fontSize:"lg",fontWeight:"bold",children:(0,t.jsxs)(em.Dialog.Title,{children:["Value Diff on ",s," nodes"]})}),(0,t.jsx)(em.Dialog.Body,{gap:"20px",as:l.Flex,direction:"column",children:(0,t.jsxs)(r.Box,{children:["Value diff will be executed on ",s," nodes in the Lineage, which can add extra costs to your bill."]})}),(0,t.jsxs)(em.Dialog.Footer,{gap:1,children:[(0,t.jsx)(a.Button,{ref:g,onClick:p,variant:"outline",colorPalette:"gray",children:"Cancel"}),(0,t.jsx)(a.Button,{colorPalette:"iochmara",onClick:()=>{(0,v.trackExploreActionForm)({action:v.EXPLORE_ACTION.VALUE_DIFF,event:v.EXPLORE_FORM_EVENT.EXECUTE}),c?.(!0),o()},ml:3,children:"Execute"})]}),(0,t.jsx)(em.Dialog.CloseTrigger,{asChild:!0,children:(0,t.jsx)(X.CloseButton,{size:"sm"})})]})})]})})}},eU={lineageGraphNode:z.GraphNode,lineageGraphColumnNode:O.GraphColumnNode},eX=[],eW={lineageGraphEdge:A.default},eK=e=>e.data.changeStatus?(0,e$.getIconForChangeStatus)(e.data.changeStatus).hexColor:"lightgray",eZ=(0,i.forwardRef)(function({interactive:e=!1,...O},A){var z;let G,U=(0,n.useReactFlow)(),X=(0,i.useRef)(null),{successToast:W,failToast:K}=(0,N.useClipBoardToast)(),{copyToClipboard:Z,ImageDownloadModal:Q,ref:q}=(0,E.useCopyToClipboard)({renderLibrary:"html-to-image",imageType:"png",shadowEffect:!0,backgroundColor:"white",ignoreElements:e=>{try{return e.classList.contains(E.IGNORE_SCREENSHOT_CLASS)}catch{if(e.className)return e.className.includes(E.IGNORE_SCREENSHOT_CLASS);return!1}},onSuccess:()=>{W("Copied the Lineage View as an image to clipboard")},onError:e=>{console.error("Error taking screenshot",e),K("Failed to copy image to clipboard",e)}}),[Y,J,ee]=(0,n.useNodesState)(eX),[et,en,eo]=(0,n.useEdgesState)([]),{lineageGraph:ei,retchLineageGraph:er,isLoading:ea,error:es,refetchRunsAggregated:el}=(0,j.useLineageGraphContext)(),{featureToggles:ed,singleEnv:ec}=(0,k.useRecceInstanceContext)(),{runId:eu,showRunId:eg,closeRunResult:eh,runAction:ep,isRunResultOpen:ef}=(0,_.useRecceActionContext)(),{run:em}=(0,I.useRun)(eu),[ex,ey]=(0,i.useState)({...O.viewOptions}),eb=(0,i.useCallback)((e,t,n,o,i)=>{let r=e.filter(h.isLineageGraphNode),a=Object.fromEntries(Object.entries(Object.groupBy(r,e=>e.data.changeStatus??"unchanged")).map(([e,t])=>[`nodes_${e}`,t?.length??0])),s={node_count:r.length,view_mode:t,impact_radius_enabled:n,right_sidebar_open:i,...a};o&&(s.cll_column_active=!0),(0,v.trackLineageViewRender)(s)},[]),ew=(0,i.useRef)([]).current,[ev,eS]=(0,i.useState)(void 0),ej=(0,p.useMutation)({mutationFn:y.getCll}),[e_,ek]=(0,i.useState)({}),eE=(0,i.useCallback)(e=>Y.filter(h.isLineageGraphNode).find(t=>t.data.name===e),[Y]);(0,i.useImperativeHandle)(A,()=>({copyToClipboard:Z}));let eR=(0,i.useMemo)(()=>!!(ei&&ei.modifiedSet.length>0),[ei]),eN=ex.view_mode??"changed_models",eI=(0,i.useMemo)(()=>Y.filter(e=>"lineageGraphNode"===e.type).map(e=>e.id),[Y]),eM=(0,i.useMemo)(()=>ei?eI.map(e=>ei.nodes[e]):[],[ei,eI]),[eT,eL]=(0,i.useState)(),eP=eT?ei?.nodes[eT]:void 0,[eO,eA]=(0,i.useState)(),[ez,eB]=(0,i.useState)(new Set),e$=(0,i.useMemo)(()=>ei?Array.from(ez).map(e=>ei.nodes[e]):[],[ei,ez]),eZ=((e,{onActionStarted:t,onActionNodeUpdated:n,onActionCompleted:o})=>{let r=(0,i.useRef)({...eH}).current,{showRunId:a}=(0,_.useRecceActionContext)(),s=async(i,s,l)=>{r.mode="multi_nodes",r.actions={};let d=r.mode,c=r.actions;t(),r.status="running";let u=[];for(let t of e){let e=s(t);e?(c[t.id]={mode:d,status:"skipped",skipReason:e},n(t)):(c[t.id]={mode:d,status:"pending"},u.push(t))}let g=l(u);try{let{run_id:e}=await (0,eC.submitRun)(i,g,{nowait:!0});for(a(e),r.currentRun={run_id:e},r.total=1;;){let t=await (0,eC.waitRun)(e,2);r.currentRun=t;let o=t.error?"failure":t.result?"success":"running";for(let e of u)c[e.id]={mode:d,status:o,run:t},n(e);if(t.error||t.result)break}}catch(e){}if(r.completed=1,"canceling"===r.status){r.status="canceled",o();return}r.status="completed",o()},l=async(i,a)=>{r.mode="per_node",r.actions={};let s=r.mode,l=r.actions;for(let o of(t(),r.status="running",e))l[o.id]={mode:s,status:"pending"},n(o);for(let t of(r.completed=0,r.total=e.length,e)){let{params:e,skipReason:d}=a(t);if(d)l[t.id]={mode:s,status:"skipped",skipReason:d},n(t);else try{let{run_id:o}=await (0,eC.submitRun)(i,e,{nowait:!0});for(r.currentRun={run_id:o},l[t.id]={mode:s,status:"running"},n(t);;){let e=await (0,eC.waitRun)(o,2);r.currentRun=e;let i=e.error?"failure":e.result?"success":"running";if(l[t.id]={mode:s,status:i,run:e},n(t),e.error||e.result)break}}catch(e){}finally{r.currentRun=void 0}if(r.completed++,"canceling"===r.status){r.status="canceled",o();return}}r.status="completed",o()},d=async()=>{(0,v.trackExploreAction)({action:v.EXPLORE_ACTION.ROW_COUNT,source:v.EXPLORE_SOURCE.LINEAGE_VIEW_TOP_BAR,node_count:e.length});let t=[];for(let o of e)"model"!==o.data.resourceType?(r.actions[o.id]={mode:"multi_nodes",status:"skipped",skipReason:"Not a model"},n(o)):t.push(o.data.name);await s("row_count",e=>{if("model"!==e.data.resourceType)return"Not a model"},e=>({node_names:e.map(e=>e.data.name)}))},c=async()=>{(0,v.trackExploreAction)({action:v.EXPLORE_ACTION.ROW_COUNT_DIFF,source:v.EXPLORE_SOURCE.LINEAGE_VIEW_TOP_BAR,node_count:e.length});let t=[];for(let o of e)"model"!==o.data.resourceType?(r.actions[o.id]={mode:"multi_nodes",status:"skipped",skipReason:"Not a model"},n(o)):t.push(o.data.name);await s("row_count_diff",e=>{if("model"!==e.data.resourceType)return"Not a model"},e=>({node_names:e.map(e=>e.data.name)}))},u=async()=>{r.status="canceling",r.currentRun?.run_id&&await (0,eC.cancelRun)(r.currentRun.run_id)};return{actionState:r,runRowCount:d,runRowCountDiff:c,runValueDiff:async()=>{(0,v.trackExploreAction)({action:v.EXPLORE_ACTION.VALUE_DIFF,source:v.EXPLORE_SOURCE.LINEAGE_VIEW_TOP_BAR,node_count:e.length}),await l("value_diff",e=>{let t=e.data.data.current?.primary_key;return t?{params:{model:e.data.name,primary_key:t}}:{skipReason:"No primary key found. The first unique column is used as primary key."}})},addLineageDiffCheck:async()=>{let t=e.map(e=>e.id);return await (0,b.createLineageDiffCheck)({node_ids:t})},addSchemaDiffCheck:async()=>{let t;if(1===e.length)t=await (0,w.createSchemaDiffCheck)({node_id:e[0].id});else{let n=e.map(e=>e.id);t=await (0,w.createSchemaDiffCheck)({node_id:n})}return t},cancel:u,reset:()=>{Object.assign(r,eH)}}})(e$.length>0?e$:eM,{onActionStarted:()=>{eA("action_result")},onActionNodeUpdated:e=>{J(t=>t.map(t=>t.id===e.id?{...t}:t))},onActionCompleted:()=>{}}),eQ=(0,i.useMemo)(()=>{if(!ei)return new Set;let e=new Set;if(ev){for(let[t,n]of Object.entries(ev.current.nodes))!1!==n.impacted&&e.add(t);for(let t of Object.keys(ev.current.columns))e.add(t)}else e="action_result"===eO?new Set(Object.keys(eZ.actionState.actions)):eP?(0,B.union)((0,h.selectUpstream)(ei,[eP.id]),(0,h.selectDownstream)(ei,[eP.id])):eR?(0,h.selectDownstream)(ei,ei.modifiedSet):new Set(eI);return new Set(e)},[ei,ev,eO,eP,eR,eZ.actionState.actions,eI]),eq=(0,V.useLineageViewContextMenu)(),eY=()=>{eq.closeContextMenu()};(0,i.useLayoutEffect)(()=>{(async()=>{let e,t;if(!ei)return;if(ex.node_ids)t=ex.node_ids;else{let e=ei.manifestMetadata.current?.project_name,n={view_mode:ex.view_mode??(eR?"changed_models":"all"),packages:e?[e]:void 0,...O.viewOptions};try{t=(await (0,C.select)({select:n.select,exclude:n.exclude,packages:n.packages,view_mode:n.view_mode})).nodes}catch(e){n.view_mode="all",t=(await (0,C.select)({select:n.select,exclude:n.exclude,packages:n.packages,view_mode:n.view_mode})).nodes}ey(n)}if(ex.column_level_lineage)try{e=await ej.mutateAsync(ex.column_level_lineage)}catch(e){if(e instanceof f.AxiosError)return void x.toaster.create({title:"Column Level Lineage error",description:e.response?.data.detail??e.message,type:"error",closable:!0})}let[n,o,i]=(0,h.toReactFlow)(ei,{selectedNodes:t,cll:e});(0,h.layout)(n,o),J(n),en(o),ek(i),eS(e),eb(n,ex.view_mode??"changed_models",ex.column_level_lineage?.change_analysis??!1,!!ex.column_level_lineage?.column,!!eT||!!em)})()},[ei]);let eJ=()=>{eL(void 0)},e0=async e=>{let t=Y.find(t=>t.id===e);if(t){if(t.parentId){let e=t.parentId;t=Y.find(t=>t.id===e)??t}if(null!=t.measured){let{width:e,height:n}=t.measured;if(e&&n){let o=t.position.x+e/2,i=t.position.y+n/2,r=U.getZoom();await U.setCenter(o,i,{zoom:r,duration:200})}}}},e1=(()=>{let[,e]=(0,R.useAppLocation)();return(0,i.useCallback)(t=>{t.check_id&&e(`/checks/?id=${t.check_id}`)},[e])})();z=async()=>{"selecting"!==eO&&(eT?await e0(eT):await U.fitView({nodes:Y,duration:200}))},G=(0,i.useRef)({width:0,height:0}),(0,i.useEffect)(()=>{let e=X.current,t=new ResizeObserver(e=>{for(let t of e){let e=t.contentRect.width,n=t.contentRect.height;(Math.abs(n-G.current.height)>10||Math.abs(e-G.current.width)>10)&&G.current.height>0&&n>0&&G.current.width>0&&e>0&&z(),G.current={width:e,height:n}}});return e&&t.observe(e),()=>{e&&t.unobserve(e)}},[z,X]);let e2=async(e,t=!1)=>{let n=ex.column_level_lineage;await e6({...ex,column_level_lineage:e},!1),t||ew.push(n),e?.node_id?eL(e.node_id):eL(void 0)},e3=async e=>{if(e){if(0===ew.length)return;let e=ew.pop();e?await e2(e,!0):await e2(void 0,!0)}else await e2(void 0,!0)},e5=(t,n)=>{if(e&&ei){if((0,h.isLineageGraphColumnNode)(n))return void(!eO&&e2({node_id:n.data.node.id,column:n.data.column}));if(eY(),eO)if("action_result"===eO){let e=eZ.actionState.actions[n.id];e.run?.run_id&&eg(e.run.run_id),eL(n.id)}else{let e=new Set(ez);ez.has(n.id)?e.delete(n.id):e.add(n.id),eB(e),0===e.size&&eA(void 0)}else eL(n.id)}},e4=async e=>{let t,n,{viewOptions:o=ex}=e,{fitView:i}=e;if(!ei)return;if(ex.select!==o.select||ex.exclude!==o.exclude||ex.packages!==o.packages||ex.view_mode!==o.view_mode){try{let e=await (0,C.select)({select:o.select,exclude:o.exclude,packages:o.packages,view_mode:o.view_mode});o={...o,column_level_lineage:void 0},t=e.nodes}catch(e){e instanceof f.AxiosError&&x.toaster.create({title:"Select node error",description:e.response?.data.detail??e.message,type:"error",closable:!0});return}eL(void 0)}else t=Y.map(e=>e.id);if(o.column_level_lineage)try{n=await ej.mutateAsync(o.column_level_lineage)}catch(e){if(e instanceof f.AxiosError)return void x.toaster.create({title:"Column Level Lineage error",description:e.response?.data.detail??e.message,type:"error",closable:!0})}let[r,a,s]=(0,h.toReactFlow)(ei,{selectedNodes:t,cll:n});J(r),en(a),ek(s),eS(n),eb(r,o.view_mode??"changed_models",o.column_level_lineage?.change_analysis??!1,!!o.column_level_lineage?.column,!!eT||!!em),em&&((0,S.isTopKDiffRun)(em)||(0,S.isProfileDiffRun)(em)||(0,S.isHistogramDiffRun)(em)||(0,S.isValueDiffRun)(em)||(0,S.isValueDiffDetailRun)(em))&&em.params?.model&&!eE(em.params.model)&&eh(),i&&(await new Promise(e=>setTimeout(e,1)),U.fitView({nodes:r,duration:200}))},e6=async(e,t=!0)=>{ey(e),await e4({viewOptions:e,fitView:t})},e8=eG();(0,i.useEffect)(()=>{let t=em?.type;if(e&&ef&&!(!t||["query_diff","query","row_count"].includes(t))&&!eO){let e;((0,S.isTopKDiffRun)(em)||(0,S.isProfileDiffRun)(em)||(0,S.isHistogramDiffRun)(em)||(0,S.isValueDiffRun)(em)||(0,S.isValueDiffDetailRun)(em))&&(e=em.params?.model);let t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});if(e){let n=eE(e);n?(0,h.isLineageGraphNode)(n)&&eP!==n.data.data&&e5(t,n):e6({...ex,view_mode:"all"})}else eJ()}},[em,ex,ef,eO,eE,eP,e]);let e7=(t,n)=>{if(!e||"action_result"===eO)return;t.preventDefault();let o=q.current,i=o.getBoundingClientRect(),r=t.clientX-i.left,a=t.clientY-i.top+o.offsetTop;eq.showContextMenu(r,a,n)},e9=()=>{eA(void 0),eB(new Set),eL(void 0),eh(),el?.()},te={interactive:e,nodes:Y,focusedNode:eP,selectedNodes:e$,viewOptions:ex,showContextMenu:e7,onViewOptionsChanged:e6,selectMode:eO,selectNode:e=>{if(eO){if("selecting"===eO){let t=new Set(ez);ez.has(e)?t.delete(e):t.add(e),eB(t),0===t.size&&eA(void 0)}}else ei&&(eB(new Set([e])),eA("selecting"),eL(void 0),eZ.reset())},selectParentNodes:(e,t=1e3)=>{if("action_result"===eO||void 0===ei)return;!eO&&(eA("selecting"),eZ.reset(),ex.column_level_lineage&&e6({...ex,column_level_lineage:void 0}));let n=(0,h.selectUpstream)(ei,[e],t);eB((0,B.union)(ez,n))},selectChildNodes:(e,t=1e3)=>{if("action_result"===eO||void 0===ei)return;!eO&&(eA("selecting"),eZ.reset(),ex.column_level_lineage&&e6({...ex,column_level_lineage:void 0}));let n=(0,h.selectDownstream)(ei,[e],t);eB((0,B.union)(ez,n))},deselect:e9,isNodeHighlighted:e=>eQ.has(e),isNodeSelected:e=>ez.has(e),isEdgeHighlighted:(e,t)=>ev?e in ev.current.parent_map&&t in ev.current.parent_map[e]:eQ.has(e)&&eQ.has(t),isNodeShowingChangeAnalysis:e=>{if(!ei)return!1;let t=e in ei.nodes?ei.nodes[e]:void 0;if(ex.column_level_lineage?.change_analysis){let n=ex.column_level_lineage;return n.node_id&&!n.column?n.node_id===e&&!!t?.data.changeStatus:!!t?.data.changeStatus}return!1},getNodeAction:e=>eZ.actionState.actions[e],getNodeColumnSet:e=>e in e_?new Set(e_[e]):new Set,runRowCount:async()=>{"selecting"===eO?(await eZ.runRowCount(),(0,v.trackMultiNodesAction)({type:"row_count",selected:"multi"})):eP?(ep("row_count",{node_names:[eP.data.name]},{showForm:!1,showLast:!1}),(0,v.trackMultiNodesAction)({type:"row_count",selected:"single"})):(ep("row_count",{select:ex.select,exclude:ex.exclude,packages:ex.packages,view_mode:ex.view_mode}),(0,v.trackMultiNodesAction)({type:"row_count",selected:"none"}))},runRowCountDiff:async()=>{"selecting"===eO?(await eZ.runRowCountDiff(),(0,v.trackMultiNodesAction)({type:"row_count_diff",selected:"multi"})):eP?(ep("row_count_diff",{node_names:[eP.data.name]},{showForm:!1,showLast:!1}),(0,v.trackMultiNodesAction)({type:"row_count_diff",selected:"single"})):(ep("row_count_diff",{select:ex.select,exclude:ex.exclude,packages:ex.packages,view_mode:ex.view_mode}),(0,v.trackMultiNodesAction)({type:"row_count_diff",selected:"none"}))},runValueDiff:async()=>{if(eP)ep("value_diff",{model:eP.data.name},{showForm:!0,showLast:!1}),(0,v.trackMultiNodesAction)({type:"value_diff",selected:"single"});else{let e="selecting"===eO?e$.length:eI.length;await e8.confirm(e)&&(await eZ.runValueDiff(),(0,v.trackMultiNodesAction)({type:"value_diff",selected:"selecting"===eO?"multi":"none"}))}},addLineageDiffCheck:async()=>{let e;"selecting"===eO?(e=await eZ.addLineageDiffCheck(),e9(),(0,v.trackMultiNodesAction)({type:"lineage_diff",selected:"multi"})):eP||(e=await (0,b.createLineageDiffCheck)(ex),(0,v.trackMultiNodesAction)({type:"lineage_diff",selected:"none"})),e&&e1(e)},addSchemaDiffCheck:async()=>{let e;"selecting"===eO?e$.length>0&&(e=await eZ.addSchemaDiffCheck(),e9(),(0,v.trackMultiNodesAction)({type:"schema_diff",selected:"multi"})):eP?(e=await (0,w.createSchemaDiffCheck)({node_id:eP.id}),(0,v.trackMultiNodesAction)({type:"schema_diff",selected:"single"})):(e=await (0,w.createSchemaDiffCheck)({select:ex.select,exclude:ex.exclude,packages:ex.packages,view_mode:ex.view_mode}),(0,v.trackMultiNodesAction)({type:"schema_diff",selected:"none"})),e&&e1(e)},cancel:eZ.cancel,actionState:eZ.actionState,centerNode:e0,cll:ev,showColumnLevelLineage:e2,resetColumnLevelLineage:e3};return ea?(0,t.jsx)(l.Flex,{width:"100%",height:"100%",alignItems:"center",justifyContent:"center",children:(0,t.jsx)(c.Spinner,{size:"xl"})}):es?(0,t.jsx)(s.Center,{h:"100%",children:(0,t.jsxs)(u.VStack,{children:[(0,t.jsx)(r.Box,{children:"Failed to load lineage data. This could be because the server has been terminated or there is a network error."}),(0,t.jsxs)(r.Box,{children:["[Reason: ",es,"]"]}),(0,t.jsx)(a.Button,{colorPalette:"blue",onClick:()=>{er&&er()},children:"Retry"})]})}):ei&&Y!=eX?"changed_models"!==eN||ei.modifiedSet.length?(0,t.jsxs)(F.LineageViewContext.Provider,{value:te,children:[(0,t.jsxs)(M.HSplit,{sizes:eP?[70,30]:[100,0],minSize:400*!!eP,gutterSize:5*!!eP,style:{height:"100%",width:"100%"},children:[(0,t.jsxs)(u.VStack,{ref:X,separator:(0,t.jsx)(u.StackSeparator,{borderColor:"gray.200"}),gap:0,style:{contain:"strict"},position:"relative",children:[e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(H.LineageViewTopBar,{}),"metadata only"===ed.mode&&(0,t.jsx)(eF,{})]}),(0,t.jsxs)(n.ReactFlow,{proOptions:{hideAttribution:!0},nodeTypes:eU,edgeTypes:eW,nodes:Y,edges:et,onNodesChange:ee,onEdgesChange:eo,onNodeClick:e5,onNodeContextMenu:e7,onClick:eY,onInit:async()=>{if(eR)await U.fitView();else{let e=(0,o.getNodesBounds)(Y,{});await U.setCenter(e.x+e.width/2,e.y+e.height/2,{zoom:1})}},maxZoom:1,minZoom:.1,nodesDraggable:e,ref:q,children:[(0,t.jsx)(n.Background,{color:"#ccc"}),(0,t.jsx)(n.Controls,{showInteractive:!1,position:"top-right",className:E.IGNORE_SCREENSHOT_CLASS,children:(0,t.jsx)(n.ControlButton,{title:"copy image",onClick:async()=>{await Z(),(0,v.trackCopyToClipboard)({type:eN,from:"lineage_view"})},children:(0,t.jsx)(d.Icon,{as:m.FiCopy})})}),(0,t.jsx)(Q,{}),(0,t.jsx)(n.Panel,{position:"bottom-left",children:(0,t.jsxs)(l.Flex,{direction:"column",gap:"5px",children:[eR&&(0,t.jsx)(D.ChangeStatusLegend,{}),ex.column_level_lineage&&(0,t.jsx)(P.ColumnLevelLineageLegend,{})]})}),(0,t.jsx)(n.Panel,{position:"top-center",children:(0,t.jsx)($.LineageViewNotification,{notification:ec?(0,t.jsx)(eV.BaseEnvironmentSetupNotification,{}):null,type:"info"})}),(0,t.jsx)(n.Panel,{position:"top-left",children:(0,t.jsxs)(l.Flex,{direction:"column",gap:"5px",children:[(0,t.jsx)(L.ColumnLevelLineageControl,{action:ej}),0==Y.length&&(0,t.jsx)(g.Text,{fontSize:"xl",color:"grey",opacity:.5,children:"No nodes"})]})}),(0,t.jsx)(n.MiniMap,{nodeColor:eK,nodeStrokeWidth:3,zoomable:!0,pannable:!0}),"action_result"===eO&&(0,t.jsx)(n.Panel,{position:"bottom-center",className:E.IGNORE_SCREENSHOT_CLASS,children:(0,t.jsx)(T.ActionControl,{onClose:()=>{e9()}})})]}),(0,t.jsx)(V.LineageViewContextMenu,{...eq.props})]}),eP?(0,t.jsx)(r.Box,{borderLeft:"solid 1px lightgray",height:"100%",children:(0,t.jsx)(eD,{node:eP,onCloseNode:eJ})}):(0,t.jsx)(r.Box,{})]}),e8.AlertDialog]}):(0,t.jsx)(s.Center,{h:"100%",children:(0,t.jsxs)(u.VStack,{children:[(0,t.jsx)(t.Fragment,{children:"No change detected"}),(0,t.jsx)(a.Button,{colorPalette:"blue",onClick:async()=>{await e6({...ex,view_mode:"all"})},children:"Show all nodes"})]})}):(0,t.jsx)(t.Fragment,{})});e.s(["LineageView",0,eZ],302061)}]);